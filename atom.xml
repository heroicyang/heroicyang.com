<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[HeroicYang's Blog]]></title>
  <subtitle><![CDATA[Pseudo fullstack developer.]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://heroicyang.com/"/>
  <updated>2015-04-20T12:50:16.000Z</updated>
  <id>http://heroicyang.com/</id>
  
  <author>
    <name><![CDATA[Heroic Yang]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[å‰ç«¯å¼€å‘è€…çš„ Mac é…ç½®æ‰‹å†Œï¼ˆäºŒï¼‰]]></title>
    <link href="http://heroicyang.com/2015/04/21/fe-dev-setup-2/"/>
    <id>http://heroicyang.com/2015/04/21/fe-dev-setup-2/</id>
    <published>2015-04-21T03:40:59.000Z</published>
    <updated>2015-04-20T12:50:16.000Z</updated>
    <content type="html"><![CDATA[<h3 id="å†™åœ¨å¼€å§‹">å†™åœ¨å¼€å§‹</h3><p><a href="http://heroicyang.com/2015/04/20/fe-dev-setup-1/" target="_blank" rel="external">ä¸Šç¯‡æ–‡ç« </a>ä»‹ç»çš„æ˜¯ç³»ç»Ÿç¯å¢ƒçš„é…ç½®ï¼Œåœ¨è¿™ä¸€ç¯‡ä¸­å°†ä¼šä»‹ç»ä»£ç ç¼–è¾‘å™¨ Sublime Text 3 çš„ç®€å•é…ç½®å’Œå®ç”¨æ’ä»¶ã€‚</p>
<p>Sublime Text æ˜¯ä¸€æ¬¾è·¨å¹³å°ä»£ç ç¼–è¾‘å™¨ï¼ˆNot IDEï¼‰ï¼Œæ‹¥æœ‰éå¸¸ä¸°å¯Œæˆç†Ÿçš„æ’ä»¶ï¼Œè¾…ä»¥å¤§é‡çš„å¿«æ·é”®ï¼Œè¶³ä½¿å¼€å‘æ•ˆç‡æˆå€æå‡ã€‚</p>
<p>å¦å¤–ï¼ŒGitHub åœ¨å»å¹´å¼€æºäº†ä¸€æ¬¾å« <a href="https://atom.io/" target="_blank" rel="external">Atom</a> çš„ä»£ç ç¼–è¾‘å™¨ï¼ŒåŸºæœ¬å’Œ Sublime Text æ— å¼‚ã€‚ä¸è¿‡æ˜¯åŸºäº Node.js å’Œ Chromiumï¼Œè¿™ä¸ªä¼šåœ¨ä¸‹ä¸€ç¯‡è¿›è¡Œä»‹ç»ã€‚Atom ä¹Ÿæ˜¯æˆ‘ç›®å‰çš„ä¸»åŠ›ç¼–è¾‘å™¨ã€‚</p>
<a id="more"></a>
<h3 id="å®‰è£…">å®‰è£…</h3><p>ç›®å‰æœ€æ–°ç‰ˆæœ¬ä¸º Sublime Text 3ï¼Œåœ¨<a href="http://www.sublimetext.com/3" target="_blank" rel="external">å®˜æ–¹ç½‘ç«™</a>æä¾›äº†å„ä¸ªå¹³å°çš„ä¸‹è½½ã€‚æ¨èä½¿ç”¨æ­¤ç‰ˆæœ¬ï¼Œæœ‰éƒ¨åˆ†æ’ä»¶åªæ”¯æŒ Sublime Text 3ã€‚</p>
<h4 id="Package_Control">Package Control</h4><p>å®‰è£…å¥½ Sublime ä¹‹åï¼Œé€šè¿‡å®‰è£… <a href="https://packagecontrol.io/" target="_blank" rel="external">Package Control</a> æ¥ç®¡ç†å…¶å¤§é‡çš„æ’ä»¶ã€‚</p>
<ul>
<li>æ‰“å¼€ Sublime Text ç„¶åæŒ‰ <code>ctrl + `</code> æ‰“å¼€æ§åˆ¶å°</li>
<li>ç²˜è´´ä¸‹é¢çš„ä»£ç åˆ°æ§åˆ¶å°ï¼Œç„¶åå›è½¦</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request,os,hashlib; h = <span class="string">'eb2297e1a458f27d836c04bb0cbaf282'</span> + <span class="string">'d0e7a3098092775ccb37ca9d6b2e4b7d'</span>; pf = <span class="string">'Package Control.sublime-package'</span>; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( <span class="string">'http://packagecontrol.io/'</span> + pf.replace(<span class="string">' '</span>, <span class="string">'%20'</span>)).read(); dh = hashlib.sha256(by).hexdigest(); print(<span class="string">'Error validating download (got %s instead of %s), please try manual install'</span> % (dh, h)) <span class="keyword">if</span> dh != h <span class="keyword">else</span> open(os.path.join( ipp, pf), <span class="string">'wb'</span> ).write(by)</span><br></pre></td></tr></table></figure>
<p>å¾… Package Control å®‰è£…å®Œæˆä¹‹åï¼Œç”¨ <code>cmd + shift + p</code> æ‰“å¼€å‘½ä»¤é¢æ¿è¾“å…¥ <code>PC</code> å³å¯çœ‹åˆ°å’Œ Package Control ç›¸å…³çš„é€‰é¡¹ã€‚ç´§æ¥ç€å°±å¯ä»¥å®‰è£…ï¼ˆç®¡ç†ï¼‰å„ç§æ’ä»¶äº†ã€‚</p>
<h3 id="é…ç½®">é…ç½®</h3><p>Sublime Text å¹¶ä¸æä¾›ä¸“é—¨çš„é…ç½®ç•Œé¢ï¼Œè€Œæ˜¯é€šè¿‡ JSON æ–‡ä»¶æ¥æ”¾ç½®å„ç§é…ç½®ä¿¡æ¯ã€‚è€Œæ¯ç§é…ç½®ä¿¡æ¯éƒ½åˆ†ä¸º <code>Default</code> å’Œ <code>User</code> ä¸¤ä¸ªç‰ˆæœ¬ï¼Œå³ <code>Default</code> ä¸ºé»˜è®¤é…ç½®ï¼Œå› æ­¤ä¸å»ºè®®ç›´æ¥ä¿®æ”¹ <code>Default</code> é…ç½®æ–‡ä»¶ï¼Œè€Œæ˜¯åœ¨ <code>User</code> æ–‡ä»¶ä¸­æ”¾ç½®è‡ªå·±çš„ä¸ªæ€§åŒ–é…ç½®ã€‚</p>
<p>æ¯”å¦‚æˆ‘çš„éƒ¨åˆ†é…ç½®ï¼š<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "<span class="attribute">font_size</span>": <span class="value"><span class="number">14</span></span>,</span><br><span class="line">  "<span class="attribute">font_face</span>": <span class="value"><span class="string">"Monaco"</span></span>,</span><br><span class="line">  "<span class="attribute">theme</span>": <span class="value"><span class="string">"Spacegray.sublime-theme"</span></span>,</span><br><span class="line">  "<span class="attribute">color_scheme</span>": <span class="value"><span class="string">"Packages/User/SublimeLinter/base16-ocean.dark (SL).tmTheme"</span></span>,</span><br><span class="line">  "<span class="attribute">tab_size</span>": <span class="value"><span class="number">2</span></span>,</span><br><span class="line">  "<span class="attribute">translate_tabs_to_spaces</span>": <span class="value"><span class="literal">true</span></span>,</span><br><span class="line">  "<span class="attribute">trim_automatic_white_space</span>": <span class="value"><span class="literal">true</span></span>,</span><br><span class="line">  "<span class="attribute">trim_trailing_white_space_on_save</span>": <span class="value"><span class="literal">true</span></span>,</span><br><span class="line">  "<span class="attribute">ensure_newline_at_eof_on_save</span>": <span class="value"><span class="literal">true</span></span><br><span class="line"></span>&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="æ’ä»¶æ¨è">æ’ä»¶æ¨è</h3><ul>
<li><a href="https://packagecontrol.io/packages/SideBarEnhancements" target="_blank" rel="external">SideBarEnhancements</a> : ä¾§è¾¹æ å¢å¼ºå·¥å…·ï¼ˆä»…æ”¯æŒ Sublime Text 3ï¼‰</li>
<li><a href="https://packagecontrol.io/packages/BracketHighlighter" target="_blank" rel="external">BracketHighlighter</a>: é«˜äº®æ˜¾ç¤ºåŒ¹é…æ‹¬å·åŠå½“å‰å…‰æ ‡æ‰€åœ¨åŒºåŸŸ</li>
<li><a href="https://packagecontrol.io/packages/TrailingSpaces" target="_blank" rel="external">Trailingâ€‹Spaces</a>: é«˜äº®ç©ºæ ¼å¹¶åœ¨ä¿å­˜æ—¶åˆ é™¤</li>
<li><a href="https://packagecontrol.io/packages/GitGutter" target="_blank" rel="external">Gitâ€‹Gutter</a>: åœ¨ä»£ç è¡Œçš„å‰é¢æ˜¾ç¤º Git çš„æ”¹åŠ¨å’Œå·®å¼‚</li>
<li><a href="https://packagecontrol.io/packages/Alignment" target="_blank" rel="external">Alignment</a>: ç”¨äºå¯¹é½ä»£ç çš„èµ‹å€¼è¯­å¥</li>
<li><a href="https://packagecontrol.io/packages/DocBlockr" target="_blank" rel="external">DocBlockr</a>: ç”Ÿæˆå—æ³¨é‡Š</li>
<li><a href="https://packagecontrol.io/packages/Emmet" target="_blank" rel="external">Emmet</a>: æ›´å¿«æ›´é«˜æ•ˆåœ°ç¼–å†™ HTML/CSS</li>
<li><a href="https://packagecontrol.io/packages/Tag" target="_blank" rel="external">Tag</a>: ç¼–å†™ HTML/XML æ—¶è‡ªåŠ¨å…³é—­æ‰“å¼€çš„æ ‡ç­¾</li>
<li><a href="https://packagecontrol.io/packages/HTML5" target="_blank" rel="external">HTML5</a>: HTML5 è¯­æ³•å¢å¼º</li>
<li><a href="https://packagecontrol.io/packages/JsFormat" target="_blank" rel="external">JsFormat</a>: JavaScript ä»£ç æ ¼å¼åŒ–</li>
<li><a href="https://packagecontrol.io/packages/SublimeLinter" target="_blank" rel="external">SublimeLinter</a>: è¯­æ³•æ£€æµ‹å·¥å…·</li>
<li><a href="https://packagecontrol.io/packages/SublimeLinter-jscs" target="_blank" rel="external">Sublimeâ€‹Linter-jscs</a>: æŒ‰ç…§ <a href="https://github.com/mdevils/node-jscs" target="_blank" rel="external">jscs</a> è§„åˆ™å¯¹ JavaScript è¯­æ³•è¿›è¡Œæ£€æµ‹ï¼Œéœ€è¦å…ˆå®‰è£… jscs åŒ… <code>sudo npm i -g jscs</code></li>
<li><a href="https://packagecontrol.io/packages/SublimeLinter-jshint" target="_blank" rel="external">Sublimeâ€‹Linter-jshint</a>: æŒ‰ç…§ <a href="http://www.jshint.com/docs/" target="_blank" rel="external">jshint</a> è§„åˆ™å¯¹ JavaScript è¯­æ³•è¿›è¡Œæ£€æµ‹ï¼Œéœ€è¦å…ˆå®‰è£… jshint åŒ… <code>sudo npm i -g jshint</code></li>
<li><a href="https://packagecontrol.io/packages/SublimeLinter-csslint" target="_blank" rel="external">SublimeLinter-csslint</a> CSS è¯­æ³•æ£€æµ‹å·¥å…·ï¼Œéœ€è¦å…ˆå®‰è£…  csslint åŒ… <code>sudo npm i -g csslint</code></li>
<li><a href="https://packagecontrol.io/packages/SublimeLinter-jsxhint" target="_blank" rel="external">Sublimeâ€‹Linter-jsxhint</a> (optional): å¯¹ JSX(React.js) è¯­æ³•è¿›è¡Œæ£€æµ‹ï¼Œéœ€è¦å…ˆå®‰è£… jsxhint åŒ… <code>sudo npm i -g jsxhint</code></li>
<li><a href="https://packagecontrol.io/packages/Handlebars" target="_blank" rel="external">Handlebars</a> (optional): Handlebars.js æ¨¡æ¿å¼•æ“è¯­æ³•å¢å¼º</li>
<li><a href="https://packagecontrol.io/packages/Stylus" target="_blank" rel="external">Stylus</a> (optional): CSS é¢„å¤„ç†å™¨ Stylus è¯­æ³•å¢å¼º</li>
<li><a href="https://packagecontrol.io/packages/GoSublime" target="_blank" rel="external">Goâ€‹Sublime</a> (optional): Golang å¢å¼º</li>
</ul>
<h3 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h3><ul>
<li><a href="http://zh.lucida.me/blog/sublime-text-complete-guide/" target="_blank" rel="external">Sublime Text å…¨ç¨‹æŒ‡å—</a>ï¼ˆæ¨èé˜…è¯»ï¼‰</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="å†™åœ¨å¼€å§‹">å†™åœ¨å¼€å§‹</h3><p><a href="http://heroicyang.com/2015/04/20/fe-dev-setup-1/">ä¸Šç¯‡æ–‡ç« </a>ä»‹ç»çš„æ˜¯ç³»ç»Ÿç¯å¢ƒçš„é…ç½®ï¼Œåœ¨è¿™ä¸€ç¯‡ä¸­å°†ä¼šä»‹ç»ä»£ç ç¼–è¾‘å™¨ Sublime Text 3 çš„ç®€å•é…ç½®å’Œå®ç”¨æ’ä»¶ã€‚</p>
<p>Sublime Text æ˜¯ä¸€æ¬¾è·¨å¹³å°ä»£ç ç¼–è¾‘å™¨ï¼ˆNot IDEï¼‰ï¼Œæ‹¥æœ‰éå¸¸ä¸°å¯Œæˆç†Ÿçš„æ’ä»¶ï¼Œè¾…ä»¥å¤§é‡çš„å¿«æ·é”®ï¼Œè¶³ä½¿å¼€å‘æ•ˆç‡æˆå€æå‡ã€‚</p>
<p>å¦å¤–ï¼ŒGitHub åœ¨å»å¹´å¼€æºäº†ä¸€æ¬¾å« <a href="https://atom.io/">Atom</a> çš„ä»£ç ç¼–è¾‘å™¨ï¼ŒåŸºæœ¬å’Œ Sublime Text æ— å¼‚ã€‚ä¸è¿‡æ˜¯åŸºäº Node.js å’Œ Chromiumï¼Œè¿™ä¸ªä¼šåœ¨ä¸‹ä¸€ç¯‡è¿›è¡Œä»‹ç»ã€‚Atom ä¹Ÿæ˜¯æˆ‘ç›®å‰çš„ä¸»åŠ›ç¼–è¾‘å™¨ã€‚</p>]]>
    
    </summary>
    
      <category term="mac" scheme="http://heroicyang.com/tags/mac/"/>
    
      <category term="sublime text" scheme="http://heroicyang.com/tags/sublime-text/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å‰ç«¯å¼€å‘è€…çš„ Mac é…ç½®æ‰‹å†Œï¼ˆä¸€ï¼‰]]></title>
    <link href="http://heroicyang.com/2015/04/20/fe-dev-setup-1/"/>
    <id>http://heroicyang.com/2015/04/20/fe-dev-setup-1/</id>
    <published>2015-04-20T06:12:33.000Z</published>
    <updated>2015-04-22T06:20:02.000Z</updated>
    <content type="html"><![CDATA[<h3 id="å‰è¨€">å‰è¨€</h3><blockquote class="blockquote-center">å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚</blockquote>

<p>ç›®å‰å¯ä¾›å¼€å‘äººå‘˜ä½¿ç”¨çš„å·¥å…·è¶Šæ¥è¶Šå¤šï¼Œåˆç†çš„ä½¿ç”¨å·¥å…·æœ‰åŠ©äºæå‡å¼€å‘æ•ˆç‡ï¼Œä½†ç§ç±»ç¹å¤šæ—¶é€‰æ‹©èµ·æ¥å´ä¼šè®©äººæ„Ÿè§‰çœ¼èŠ±ç¼­ä¹±ã€‚æ‰€ä»¥æˆ‘å‡†å¤‡åœ¨æ¥ä¸‹æ¥çš„å‡ ç¯‡æ–‡ç« ä¸­åˆ†äº«ä¸€äº›æˆ‘çš„ Mac å¼€å‘ç¯å¢ƒé…ç½®ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚</p>
<a id="more"></a>
<h3 id="XCode">XCode</h3><p>å¦‚æœæ˜¯ä¸€å°å…¨æ–°çš„ Mac ç”µè„‘ï¼Œé‚£ç¬¬ä¸€ä»¶äº‹æƒ…å°±æ˜¯å»å®‰è£… XCode å§ã€‚ç„¶ååœ¨ç»ˆç«¯ä¸­ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£… <code>Xcode command line tools</code>ï¼ŒæŒ‰ç…§æŒ‡å¼•å®‰è£…å³å¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ xcode-select --install</span><br></pre></td></tr></table></figure>
<p><em>å¦‚æœä½ ä¸åš Obj-C å¼€å‘ï¼Œå¯ä»¥è·³è¿‡ XCode çš„å®‰è£…ï¼Œç›´æ¥å»ä¸‹è½½ <code>Xcode command line tools</code> æ¥å®‰è£…å³å¯ã€‚</em></p>
<h3 id="Homebrew">Homebrew</h3><p>Homebrew æ˜¯ Mac ä¸Šæœ€å—æ¬¢è¿çš„<a href="https://en.wikipedia.org/wiki/Package_manager" target="_blank" rel="external">åŒ…ç®¡ç†å·¥å…·</a>ã€‚</p>
<h4 id="å®‰è£…">å®‰è£…</h4><p>åœ¨æ­¤ä¹‹å‰ï¼Œå¿…é¡»ä¿è¯ <code>Xcode command line tools</code>ã€‚ç„¶ååœ¨ç»ˆç«¯ä¸­ç”¨å¦‚ä¸‹å‘½ä»¤æŒ‰ç…§æŒ‡å¼•æ¥å®‰è£… Homebrew ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ruby <span class="operator">-e</span> <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></span><br></pre></td></tr></table></figure>
<p>å®‰è£…å®Œæˆä¹‹åå°† Homebrew çš„å¯æ‰§è¡Œå‘½ä»¤æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">'export PATH="/usr/local/bin:$PATH"'</span> &gt;&gt; ~/.bash_profile</span><br></pre></td></tr></table></figure></p>
<h4 id="ç®€å•ä½¿ç”¨">ç®€å•ä½¿ç”¨</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ brew install &lt;package_name&gt;  <span class="comment"># å®‰è£…åŒ…</span></span><br><span class="line">$ brew update                  <span class="comment"># æ›´æ–°åŒ…ç›®å½•</span></span><br><span class="line">$ brew outdated                <span class="comment"># æŸ¥çœ‹éœ€è¦æ›´æ–°çš„åŒ…</span></span><br><span class="line">$ brew upgrade &lt;package_name&gt;  <span class="comment"># æ›´æ–°åŒ…</span></span><br><span class="line">$ brew list                    <span class="comment"># æŸ¥çœ‹å·²å®‰è£…çš„åŒ…</span></span><br></pre></td></tr></table></figure>
<h4 id="Cakebrew">Cakebrew</h4><p>å¦‚æœä½ ä¸å–œæ¬¢å‘½ä»¤è¡Œæ–¹å¼æ¥ç®¡ç†ï¼Œé‚£ä¹ˆ Cakebrew æ˜¯æå¥½çš„é€‰æ‹©ã€‚Cakebrew App æä¾›äº†å¯è§†åŒ–çš„ç•Œé¢æ¥æ¥ç®¡ä¸€éƒ¨åˆ† brew å‘½ä»¤ï¼Œå¤§å¤šæ•°æ“ä½œéƒ½å¯ä»¥ç›´æ¥åœ¨ç•Œé¢ä¸Šç‚¹å‡ ä¸‹æ¥å®Œæˆã€‚</p>
<p><a href="https://www.cakebrew.com/" target="_blank" rel="external">ä¸‹è½½åœ°å€</a></p>
<h3 id="iTerm2">iTerm2</h3><p>æ›¿æ¢æ‰ OS X è‡ªå¸¦çš„ Terminalï¼Œä¸æ˜¯å› ä¸ºè‡ªå¸¦çš„å¾ˆå·®åŠ²ï¼Œè€Œæ˜¯ä¸€æ¬¾å¼ºåŠ²çš„ç»ˆç«¯ç¨‹åºå¯ä»¥æœ‰æ•ˆçš„æå‡æ•ˆç‡ï¼ˆå³ä¾¿æ˜¯å°‘æ•²ç‚¹å­—ç¬¦ä¹Ÿè¡Œï¼‰ã€‚</p>
<p><a href="http://iterm2.com/" target="_blank" rel="external">ä¸‹è½½åœ°å€</a></p>
<h4 id="Zsh">Zsh</h4><p><a href="http://zsh.sourceforge.net/" target="_blank" rel="external">Zsh</a> å·ç§°ç»ˆæ Shellï¼Œæ‰€ä»¥æ„‰å¿«çš„å¹²æ‰è‡ªå¸¦çš„ Bash å§ï¼ˆè‡ªå¸¦çš„åˆèººäº†ğŸ˜‚ï¼‰â€¦ Zsh æä¾›äº†å¼ºå¤§çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œèƒ½è‡ªåŠ¨è¡¥å…¨å‘½ä»¤ã€å‚æ•°ã€æ–‡ä»¶åã€è¿›ç¨‹ç­‰ã€‚</p>
<p>è€Œ <a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="external">oh-my-zsh</a> æ˜¯åŸºäº Zsh çš„åŠŸèƒ½åšäº†ä¸€ä¸ªæ‰©å±•ï¼Œæä¾›äº†æ–¹ä¾¿çš„æ’ä»¶ç®¡ç†ã€ä¸»é¢˜è‡ªå®šä¹‰ï¼Œä»¥åŠæ¼‚äº®çš„è‡ªåŠ¨å®Œæˆæ•ˆæœã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ curl -L https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh | sh</span><br><span class="line">$ <span class="comment"># å®‰è£…å®Œæˆåå°†å½“å‰çš„ç¯å¢ƒå˜é‡å¯¼å…¥ .zshrc ä¸­</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"export PATH=<span class="variable">$PATH</span>"</span> &gt;&gt; ~/.zshrc</span><br><span class="line">$ <span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>åœ¨ <code>~/.zshrc</code> ä¸­æŒ‰ç…§ä¸ªäººå–œå¥½é…ç½®ä¸»é¢˜ï¼ˆ<code>ZSH_THEME</code>ï¼‰ï¼Œä»¥åŠå„ç§æ’ä»¶(<code>plugins</code>)ã€‚<a href="https://github.com/robbyrussell/oh-my-zsh/wiki/themes" target="_blank" rel="external">ä¸»é¢˜å¤ªå¤šï¼Œä»»å›é€‰æ‹©</a>ã€‚å¦å¤–ï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„æ’ä»¶å¯ç”¨æƒ…å†µã€‚</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plugins=<span class="list">(<span class="keyword">git</span> github git-flow git-extras brew osx node npm copydir copyfile cp sublime zsh-syntax-highlighting)</span></span><br></pre></td></tr></table></figure>
<h3 id="Git">Git</h3><p>æˆ‘ä»¬æ˜¯å‰å«çš„å‰ç«¯å·¥ç¨‹å¸ˆï¼Œä¸ç”¨ Git æ€ä¹ˆå¥½æ„æ€å’Œåˆ«äººæ‰“æ‹›å‘¼å‘¢ã€‚ã€‚ã€‚ğŸ˜‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git --version     <span class="comment"># å¦‚æœæç¤ºå‘½ä»¤ä¸å­˜åœ¨ï¼Œé‚£ç”¨ Homebrew æ¥å®‰è£…å§</span></span><br><span class="line">$ brew install git</span><br></pre></td></tr></table></figure>
<p>ç„¶åé…ç½®ä¸€äº›å…¨å±€çš„ä¿¡æ¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name <span class="string">"Your Name"</span></span><br><span class="line">$ git config --global user.email <span class="string">"your_email@youremail.com"</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½¿ç”¨ SSH æ–¹å¼æ¥æ‹‰å–/æ¨é€ä»£ç ï¼Œè¯·å‚è€ƒ<a href="https://help.github.com/articles/generating-ssh-keys" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚è€Œ HTTPS æ–¹å¼å¦‚æœä¸æƒ³æ¯æ¬¡éƒ½è¾“å…¥ä½ çš„ Git ç”¨æˆ·åå’Œå¯†ç çš„è¯ï¼Œè¯·ç»§ç»­æŒ‰ç…§ä»¥ä¸‹é…ç½®ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global credential.helper osxkeychain</span><br></pre></td></tr></table></figure>
<h3 id="Node-js">Node.js</h3><p>æˆ‘ä»¬æ˜¯å‰å«çš„å‰ç«¯å·¥ç¨‹å¸ˆï¼Œæ²¡ç”¨è¿‡ Node.js è‚¯å®šä¹Ÿå¬è¿‡ Node.js å§ï¼Œå¦åˆ™çœŸçš„æ˜¯ä¸å¥½æ„æ€å’Œåˆ«äººæ‰“æ‹›å‘¼çš„ğŸ˜‚ã€‚ã€‚ã€‚å°‘å¹´ï¼Œèµ¶ç´§å»<a href="https://nodejs.org/" target="_blank" rel="external">å®˜ç½‘</a>ä¸‹è½½å®‰è£…å§~</p>
<h4 id="NPM">NPM</h4><p>Node çš„<a href="https://www.npmjs.com/" target="_blank" rel="external">åŒ…ç®¡ç†ç³»ç»Ÿ</a>ã€‚å®‰è£…å¥½ Node ä¹‹åè‡ªå¸¦ï¼Œä¸è¿‡åœ¨æŸäº› Node ç‰ˆæœ¬ä¸­è‡ªå¸¦çš„ NPM ç‰ˆæœ¬è¾ƒä½ï¼Œä½ éœ€è¦æ‰§è¡Œä¸‹é¢å‘½ä»¤æ¥å‡çº§ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo npm up npm -g        <span class="comment"># ç”¨ NPM å‡çº§ NPMï¼Œæ„Ÿè§‰å¾ˆé…·å¯¹å§ï¼Ÿ</span></span><br></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œæ¨èå®‰è£…ä»¥ä¸‹åŒ…ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo npm i gulp -g        <span class="comment"># å‰ç«¯æ„å»ºå·¥å…·</span></span><br><span class="line">$ sudo npm i grunt-cli -g   <span class="comment"># å¦ä¸€ä¸ªå‰ç«¯æ„å»ºå·¥å…·</span></span><br><span class="line">$ sudo npm i bower -g       <span class="comment"># å‰ç«¯åŒ…ç®¡ç†å·¥å…·ï¼ˆä¸ºæ¯›åˆä¸€ä¸ªåŒ…ç®¡ç†å·¥å…·ï¼Ÿä¸è¦åœ¨æ„è¿™äº›ç»†èŠ‚ï¼‰</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Golang_(optional)">Golang (optional)</h3><p>è¿™ä¸€å°èŠ‚ç®—æ˜¯èµ é€å•¦ï¼Œåæ­£ä½ éƒ½çœ‹åˆ°è¿™é‡Œäº†ã€‚ã€‚ã€‚</p>
<p>Golang æ˜¯è°·æ­Œå¼€å‘çš„ä¸€é—¨ç°ä»£ç¼–ç¨‹è¯­è¨€ï¼Œå¼ºç±»å‹ã€å¹¶å‘ã€é«˜æ€§èƒ½ã€è¯­è¨€ç‰¹æ€§ç®€æ´é«˜æ•ˆâ€¦ æ©ï¼Œå¦å¤–ï¼ŒNode ç¤¾åŒºçš„ <a href="https://github.com/tj" target="_blank" rel="external">TJ</a> å¤§ç¥ç›®å‰å·²è½¬æŠ•æ­¤é˜µè¥â€¦</p>
<p>å®‰è£…å°±ä¸ç”¨è¯´äº†ï¼Œä¸Š<a href="http://golang.org/" target="_blank" rel="external">å®˜ç½‘</a>ä¸‹è½½å³å¯ã€‚å¦‚æœä½ æ²¡åŠæ³•è¶Šè¿‡ GFWï¼Œé‚£å»<a href="http://www.golangtc.com/download" target="_blank" rel="external">è¿™é‡Œ</a>ä¸‹è½½å§ã€‚</p>
<h4 id="é…ç½®">é…ç½®</h4><p>æˆ‘ä¸€èˆ¬ä¼šä¸º Go é…ç½®ä¸¤ä¸ª <code>GOPATH</code>ï¼Œ<code>/usr/local/share/go</code> ç”¨äºå®‰è£…ç¬¬ä¸‰æ–¹åŒ…ï¼Œ<code>~/codes/go</code> ç”¨äºæ”¾ç½®è‡ªå·±é¡¹ç›®ä»£ç ï¼ˆå·¥ä½œç›®å½•ï¼‰ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">"export GOROOT=/usr/local/go"</span> &gt;&gt; ~/.zshrc</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"export GOPATH=/usr/local/share/go:<span class="variable">$HOME</span>/codes/go"</span> &gt;&gt; ~/.zshrc</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"export PATH=<span class="variable">$PATH</span>:/usr/local/share/go/bin"</span> &gt;&gt; ~/.zshrc</span><br><span class="line">$ <span class="built_in">source</span> ~/.zshrc</span><br><span class="line">$ mkdir <span class="variable">$HOME</span>/codes/go    <span class="comment"># åˆ›å»ºè‡ªå·±çš„å·¥ä½œç›®å½•</span></span><br></pre></td></tr></table></figure>
<h3 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h3><ul>
<li><a href="https://www.gitbook.com/book/aaaaaashu/mac-dev-setup/details" target="_blank" rel="external">Mac å¼€å‘é…ç½®æ‰‹å†Œ</a></li>
<li><a href="https://github.com/robbyrussell/oh-my-zsh#basic-installation" target="_blank" rel="external">oh-my-zsh Installation</a></li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="å‰è¨€">å‰è¨€</h3><blockquote class="blockquote-center">å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚</blockquote>

<p>ç›®å‰å¯ä¾›å¼€å‘äººå‘˜ä½¿ç”¨çš„å·¥å…·è¶Šæ¥è¶Šå¤šï¼Œåˆç†çš„ä½¿ç”¨å·¥å…·æœ‰åŠ©äºæå‡å¼€å‘æ•ˆç‡ï¼Œä½†ç§ç±»ç¹å¤šæ—¶é€‰æ‹©èµ·æ¥å´ä¼šè®©äººæ„Ÿè§‰çœ¼èŠ±ç¼­ä¹±ã€‚æ‰€ä»¥æˆ‘å‡†å¤‡åœ¨æ¥ä¸‹æ¥çš„å‡ ç¯‡æ–‡ç« ä¸­åˆ†äº«ä¸€äº›æˆ‘çš„ Mac å¼€å‘ç¯å¢ƒé…ç½®ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚</p>]]>
    
    </summary>
    
      <category term="mac" scheme="http://heroicyang.com/tags/mac/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ç¼–å†™å¯ç»´æŠ¤çš„ Gruntfile.js]]></title>
    <link href="http://heroicyang.com/2013/11/24/maintainable-gruntjs/"/>
    <id>http://heroicyang.com/2013/11/24/maintainable-gruntjs/</id>
    <published>2013-11-24T12:19:27.000Z</published>
    <updated>2014-05-01T02:15:55.000Z</updated>
    <content type="html"><![CDATA[<p>ä½¿ç”¨<a href="http://gruntjs.com/" target="_blank" rel="external">Grunt</a>å·²ç»æœ‰å¾ˆé•¿ä¸€æ®µæ—¶é—´äº†ï¼Œä¸å¾—ä¸æ„Ÿå¹å…¶ç¤¾åŒºçš„å£®å¤§ï¼Œå„ç§æ’ä»¶å±‚å‡ºä¸ç©·ã€‚è€Œåœ¨è¿™æœŸé—´æˆ‘ä¹Ÿæ¢è¿‡å‡ ç§æ–¹å¼æ¥ç»„ç»‡<code>Gruntfile.js</code>ï¼Œä½†éƒ½ä¸æ˜¯å¾ˆç†æƒ³ï¼Œç›´åˆ°å‰æ®µæ—¶é—´çœ‹åˆ°<a href="https://npmjs.org/package/load-grunt-tasks" target="_blank" rel="external">load-grunt-tasks</a>è¿™ä¸ªæ’ä»¶ä»¥åŠ<a href="http://www.thomasboyt.com/2013/09/01/maintainable-grunt.html" target="_blank" rel="external">More maintainable Gruntfiles</a>è¿™ç¯‡æ–‡ç« åï¼Œæˆ‘å°±æŠŠé¡¹ç›®ä¸­çš„<code>Gruntfile.js</code>éƒ½æŒ‰ç…§è¯¥æ–‡ç« ä½œè€…æ‰€è¿°çš„æ–¹å¼é‡æ–°ç»„ç»‡äº†ä¸€éã€‚</p>
<p>æˆ‘å°±æš‚ä¸”æŠŠè¿™ç§æ–¹å¼ç”¨è‡ªå·±çš„æ–‡å­—è®°å½•ä¸€ä¸‹å¹¶åˆ†äº«ç»™æ­£åœ¨ä½¿ç”¨<code>Grunt</code>çš„åŒå­¦ä»¬å§ï¼Œä¸è¿‡æœ¬æ–‡ä¹Ÿä¸ç®—æ˜¯å¯¹ã€ŠMore maintainable Gruntfilesã€‹çš„ç¿»è¯‘å‘ï¼Œæ¯•ç«Ÿæˆ‘Eæ–‡å¤ªå·®~</p>
<a id="more"></a>
<h3 id="load-grunt-tasks_æ’ä»¶">load-grunt-tasks æ’ä»¶</h3><p>é¦–å…ˆä»‹ç»ä¸‹<code>load-grunt-tasks</code>è¿™ä¸ªæ’ä»¶ã€‚</p>
<p>æˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šæŠŠæ‰€æœ‰ç”¨åˆ°çš„æ’ä»¶ä»¥åŠæ’ä»¶çš„é…ç½®å†™åˆ°<code>Gruntfile.js</code>é‡Œé¢ï¼Œå¯¹äºå°é¡¹ç›®æ¥è¯´è¿™ä¸ªæ–‡ä»¶æœ€ç»ˆæˆ–è®¸ä¸æ˜¯å¾ˆå¤§ï¼Œä½†æ˜¯å¯¹äºå¤§é¡¹ç›®ã€æœ‰å¾ˆå¤šé…ç½®æˆ–è€…å¾ˆå¤šè‡ªå®šä¹‰ä»»åŠ¡çš„é¡¹ç›®æ¥è¯´ï¼Œæœ€åè¿™ä¸ªæ–‡ä»¶éƒ½ä¼šå˜å¾—è¶Šæ¥è¶Šé•¿ï¼Œç»´æŠ¤èµ·æ¥å°±æˆäº†éº»çƒ¦ã€‚æ¯”å¦‚ä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span><span class="params">(grunt)</span> </span>&#123;</span><br><span class="line">  grunt.initConfig(&#123;</span><br><span class="line">    pkg: grunt.file.readJSON(<span class="string">'package.json'</span>),</span><br><span class="line">    concat: &#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        separator: <span class="string">';'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      dist: &#123;</span><br><span class="line">        src: [<span class="string">'src/\*\*/\*.js'</span>],</span><br><span class="line">        dest: <span class="string">'dist/&lt;%= pkg.name %&gt;.js'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    uglify: &#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        banner: <span class="string">'/\*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today("dd-mm-yyyy") %&gt; \*/\n'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      dist: &#123;</span><br><span class="line">        files: &#123;</span><br><span class="line">          <span class="string">'dist/&lt;%= pkg.name %&gt;.min.js'</span>: [<span class="string">'&lt;%= concat.dist.dest %&gt;'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    qunit: &#123;</span><br><span class="line">      files: [<span class="string">'test/\*\*/\*.html'</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    jshint: &#123;</span><br><span class="line">      files: [<span class="string">'gruntfile.js'</span>, <span class="string">'src/\*\*/\*.js'</span>, <span class="string">'test/\*\*/\*.js'</span>],</span><br><span class="line">      options: &#123;</span><br><span class="line">        globals: &#123;</span><br><span class="line">          jQuery: <span class="literal">true</span>,</span><br><span class="line">          <span class="built_in">console</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="built_in">module</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="built_in">document</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">      files: [<span class="string">'&lt;%= jshint.files %&gt;'</span>],</span><br><span class="line">      tasks: [<span class="string">'jshint'</span>, <span class="string">'qunit'</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-uglify'</span>);</span><br><span class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-jshint'</span>);</span><br><span class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-qunit'</span>);</span><br><span class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-watch'</span>);</span><br><span class="line">  grunt.loadNpmTasks(<span class="string">'grunt-contrib-concat'</span>);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'test'</span>, [<span class="string">'jshint'</span>, <span class="string">'qunit'</span>]);</span><br><span class="line">  grunt.registerTask(<span class="string">'default'</span>, [<span class="string">'jshint'</span>, <span class="string">'qunit'</span>, <span class="string">'concat'</span>, <span class="string">'uglify'</span>]);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯ä¸€ä¸ªå¾ˆæ ‡å‡†çš„<code>Gruntfile.js</code>ï¼Œæ˜¾ç„¶ä¹Ÿç®—æ˜¯å¾ˆç®€çŸ­çš„äº†ï¼Œä½†æ˜¯çœ‹èµ·æ¥ä¹Ÿæœ‰ç‚¹ç´¯è§‰ä¸çˆ±ã€‚äºæ˜¯<code>load-grunt-tasks</code>å‡ºæ¥å¸®æˆ‘ä»¬è§£å†³äº†ä¸€éƒ¨åˆ†é—®é¢˜ã€‚</p>
<p>å®ƒä¼šè‡ªåŠ¨è¯»å–å¹¶åŠ è½½é¡¹ç›®<code>packge.json</code>æ–‡ä»¶ä¸­<code>devDependencies</code>é…ç½®ä¸‹ä»¥<code>grunt-*</code>å¼€å¤´çš„ä¾èµ–åº“ã€‚äºæ˜¯ä¹æˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸€è¡Œä»£ç æ¥æå®šä¸Šé¢ä»£ç ä¸­å¾ˆå¤šè¡Œçš„<code>loadNpmTasks</code>äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'load-grunt-tasks'</span>)(grunt);</span><br><span class="line"><span class="comment">// å°±ä»£æ›¿äº†ä»¥ä¸‹å…¨éƒ¨</span></span><br><span class="line">grunt.loadNpmTasks(<span class="string">'grunt-contrib-uglify'</span>);</span><br><span class="line">grunt.loadNpmTasks(<span class="string">'grunt-contrib-jshint'</span>);</span><br><span class="line">grunt.loadNpmTasks(<span class="string">'grunt-contrib-qunit'</span>);</span><br><span class="line">grunt.loadNpmTasks(<span class="string">'grunt-contrib-watch'</span>);</span><br><span class="line">grunt.loadNpmTasks(<span class="string">'grunt-contrib-concat'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Gruntfile-js_ç»§ç»­å»‹èº«">Gruntfile.js ç»§ç»­å»‹èº«</h3><p><code>load-grunt-tasks</code>æ’ä»¶æ›¿<code>Gruntfile.js</code>çœå»äº†é‚£äº›åå¤ä¹¦å†™çš„æ–¹æ³•è°ƒç”¨ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å°†æ•´ä¸ª<code>Gruntfile.js</code>å˜å¾—å¹²å‡€æ¸…çˆ½çš„æ­¥éª¤äº†ã€‚é‚£å°±æ˜¯æŠŠä¸Šé¢çš„å„ç§<code>config</code>åˆ†ç¦»å‡ºå»ï¼Œè®©å®ƒä»¬å„è‡ªä»£è¡¨è‡ªå·±æ˜¯å±äºå“ªä¸ªæ’ä»¶ï¼Œè€Œä¸æ˜¯ä¸€å£æ°”å…¨å†™åœ¨ä¸€èµ·ã€‚å½“ç„¶ï¼Œè¿˜æœ‰å„ç§ç”¨<code>registerTask</code>æ–¹æ³•å®šä¹‰çš„è‡ªå®šä¹‰ä»»åŠ¡ï¼Œä¹Ÿè¯¥å•ç‹¬æ”¾åˆ°ç›¸åº”çš„æ–‡ä»¶ä¸­ã€‚</p>
<h4 id="è‡ªå®šä¹‰ä»»åŠ¡è¿ç§»">è‡ªå®šä¹‰ä»»åŠ¡è¿ç§»</h4><p>é¦–å…ˆï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹å»ºä¸€ä¸ªåä¸º<code>tasks</code>çš„ç›®å½•ï¼Œåœ¨è¿™ä¸ªç›®å½•ä¸‹æ¥ç¼–å†™å„ç§è‡ªå®šä¹‰ä»»åŠ¡ã€‚å¯ä»¥ä¸€ä¸ªä»»åŠ¡ä¸€ä¸ª js æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥å¤šä¸ªç®€å•ä»»åŠ¡åœ¨ä¸€ä¸ª js æ–‡ä»¶ï¼Œçœ‹ä¸ªäººå–œå¥½å§ã€‚ç„¶ååœ¨<code>Gruntfile.js</code>ä¸­ç”¨ä¸€è¡Œä»£ç æ¥è½½å…¥è¿™äº›è‡ªå®šä¹‰ä»»åŠ¡ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grunt.loadTasks(<span class="string">'tasks'</span>);  <span class="comment">// å³åˆšåˆšæ–°å»ºç›®å½•çš„åç§°</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®é¡¹è¿ç§»">é…ç½®é¡¹è¿ç§»</h4><p>ç„¶åå†åœ¨è¿™ä¸ªç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªåä¸º<code>options</code>çš„å­ç›®å½•(tasks/options)ï¼Œæ¥å­˜æ”¾ä¹‹å‰è¯´çš„é‚£äº›<code>config</code>ä»¬ã€‚ä¸ºæ¯ä¸€ç±»<code>config</code>å»ºä¸€ä¸ª js æ–‡ä»¶ï¼Œå¹¶ä»¥é…ç½®é¡¹èŠ‚ç‚¹åä½œä¸ºæ–‡ä»¶åç§°ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tasks</span><br><span class="line">â””â”€â”€ options</span><br><span class="line">    â””â”€â”€ concat<span class="class">.js</span></span><br><span class="line">    â””â”€â”€ uglify<span class="class">.js</span></span><br><span class="line">    â””â”€â”€ qunit<span class="class">.js</span></span><br><span class="line">    â””â”€â”€ jshint.js</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨æ¯ä¸ªæ–‡ä»¶ä¸­å¯¼å‡ºå¯¹åº”çš„é…ç½®é¡¹ï¼Œæ‹¿<code>concat.js</code>æ¥è¯´ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = exports = &#123;</span><br><span class="line">  options: &#123;</span><br><span class="line">    separator: <span class="string">';'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  dist: &#123;</span><br><span class="line">    src: [<span class="string">'src/\*\*/\*.js'</span>],</span><br><span class="line">    dest: <span class="string">'dist/&lt;%= pkg.name %&gt;.js'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æœ€ååœ¨<code>Gruntfile.js</code>é‡Œç”¨<code>require</code>å°†é…ç½®é€ä¸ªå¼•å…¥å³å¯ï¼Œä¹Ÿå¯ä»¥å°è£…ä¸€ä¸ªå‡½æ•°æ¥åšè¿™ä»¶äº‹æƒ…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadConfig</span><span class="params">(configPath)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> config = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  glob.sync(<span class="string">'\*'</span>, &#123; cwd: configPath &#125;)</span><br><span class="line">    .forEach(<span class="function"><span class="keyword">function</span><span class="params">(configFile)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> prop = configFile.replace(<span class="regexp">/\.js$/</span>, <span class="string">''</span>);</span><br><span class="line">      config[prop] = <span class="built_in">require</span>(path.join(__dirname, configPath, configFile));</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> config;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å†æ”¹å†™<code>Gruntfile.js</code>ä¸­<code>initConfig</code>çš„è°ƒç”¨å³å¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _ = <span class="built_in">require</span>(<span class="string">'lodash'</span>);</span><br><span class="line"><span class="keyword">var</span> config = &#123;</span><br><span class="line">  pkg: grunt.file.readJSON(<span class="string">'package.json'</span>)</span><br><span class="line">&#125;;</span><br><span class="line">_.extend(config, loadConfig(<span class="string">'./tasks/options/'</span>));</span><br><span class="line">grunt.initConfig(config);</span><br></pre></td></tr></table></figure>
<h3 id="å†™åœ¨æœ€å">å†™åœ¨æœ€å</h3><p>äºæ˜¯ä¹åœ¨æ¯ä¸ªé¡¹ç›®ä¸­<code>Gruntfile.js</code>å‡ ä¹ä¸€è‡´ï¼Œè€Œä¸”ä¹Ÿå‡ ä¹ä¸ä¼šå†å˜æ›´ã€‚<code>Gruntfile.js</code>ã€è‡ªå®šä¹‰ä»»åŠ¡ã€ä»»åŠ¡é…ç½®é¡¹å„å¸å…¶èŒï¼Œéœ€è¦å˜åŒ–æ—¶åªéœ€å¯¹ç›¸åº”æ–‡ä»¶åšå‡ºè°ƒæ•´å³å¯ã€‚</p>
<p>å°±åœ¨å‰äº›å¤©ï¼Œåˆä¸€ä½ GitHuber å°†è¿™ä¸ªæ€è·¯å°è£…æˆäº†ä¸€ä¸ªåº“ï¼š<a href="https://github.com/firstandthird/load-grunt-config" target="_blank" rel="external">load-grunt-config</a>ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥çœ‹çœ‹ã€‚</p>
<p>æœ€ç»ˆçš„<code>Gruntfile.js</code>å¯ä»¥æŸ¥çœ‹è¿™ä¸ªä¾‹å­ï¼š<a href="https://github.com/heroicyang/cnodeclub/blob/master/Gruntfile.js" target="_blank" rel="external">https://github.com/heroicyang/cnodeclub/blob/master/Gruntfile.js</a></p>
<h3 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h3><p>load-grunt-tasks: <a href="https://npmjs.org/package/load-grunt-tasks" target="_blank" rel="external">https://npmjs.org/package/load-grunt-tasks</a><br>More maintainable Gruntfiles: <a href="http://www.thomasboyt.com/2013/09/01/maintainable-grunt.html" target="_blank" rel="external">http://www.thomasboyt.com/2013/09/01/maintainable-grunt.html</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ä½¿ç”¨<a href="http://gruntjs.com/">Grunt</a>å·²ç»æœ‰å¾ˆé•¿ä¸€æ®µæ—¶é—´äº†ï¼Œä¸å¾—ä¸æ„Ÿå¹å…¶ç¤¾åŒºçš„å£®å¤§ï¼Œå„ç§æ’ä»¶å±‚å‡ºä¸ç©·ã€‚è€Œåœ¨è¿™æœŸé—´æˆ‘ä¹Ÿæ¢è¿‡å‡ ç§æ–¹å¼æ¥ç»„ç»‡<code>Gruntfile.js</code>ï¼Œä½†éƒ½ä¸æ˜¯å¾ˆç†æƒ³ï¼Œç›´åˆ°å‰æ®µæ—¶é—´çœ‹åˆ°<a href="https://npmjs.org/package/load-grunt-tasks">load-grunt-tasks</a>è¿™ä¸ªæ’ä»¶ä»¥åŠ<a href="http://www.thomasboyt.com/2013/09/01/maintainable-grunt.html">More maintainable Gruntfiles</a>è¿™ç¯‡æ–‡ç« åï¼Œæˆ‘å°±æŠŠé¡¹ç›®ä¸­çš„<code>Gruntfile.js</code>éƒ½æŒ‰ç…§è¯¥æ–‡ç« ä½œè€…æ‰€è¿°çš„æ–¹å¼é‡æ–°ç»„ç»‡äº†ä¸€éã€‚</p>
<p>æˆ‘å°±æš‚ä¸”æŠŠè¿™ç§æ–¹å¼ç”¨è‡ªå·±çš„æ–‡å­—è®°å½•ä¸€ä¸‹å¹¶åˆ†äº«ç»™æ­£åœ¨ä½¿ç”¨<code>Grunt</code>çš„åŒå­¦ä»¬å§ï¼Œä¸è¿‡æœ¬æ–‡ä¹Ÿä¸ç®—æ˜¯å¯¹ã€ŠMore maintainable Gruntfilesã€‹çš„ç¿»è¯‘å‘ï¼Œæ¯•ç«Ÿæˆ‘Eæ–‡å¤ªå·®~</p>]]>
    
    </summary>
    
      <category term="grunt" scheme="http://heroicyang.com/tags/grunt/"/>
    
      <category term="gruntjs" scheme="http://heroicyang.com/tags/gruntjs/"/>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[JavaScripté—­åŒ…]]></title>
    <link href="http://heroicyang.com/2013/07/27/javascript-closure/"/>
    <id>http://heroicyang.com/2013/07/27/javascript-closure/</id>
    <published>2013-07-27T10:20:35.000Z</published>
    <updated>2014-05-01T01:57:33.000Z</updated>
    <content type="html"><![CDATA[<p>é—­åŒ…æ˜¯JavaScriptä¸­çš„é‡è¦ç‰¹æ€§ä¹‹ä¸€ï¼Œå¤§å¤šæ•°ç”¨è¿‡JavaScriptçš„ç¨‹åºå‘˜ä¹ŸåŸºæœ¬ä¸Šéƒ½æ¥è§¦è¿‡é—­åŒ…ï¼Œä¸ç®¡æ˜¯å¦çŸ¥é“æˆ–äº†è§£é—­åŒ…è¿™ä¸ªæ¦‚å¿µã€‚æ¯”å¦‚åœ¨ç”¨jQueryçš„æ—¶å€™ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line">$(<span class="string">'.btn'</span>).onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">  count += <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>é—­åŒ…ï¼Œ<a href="http://zh.wikipedia.org/wiki/%E9%97%AD%E5%8C%85_(%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6)" target="_blank" rel="external">ç»´åŸºç™¾ç§‘</a>çš„è§£é‡Šæ˜¯ï¼šæŒ‡å¼•ç”¨äº†è‡ªç”±å˜é‡çš„å‡½æ•°ã€‚è€Œæˆ‘ä¸ªäººè®¤ä¸ºå‰ç«¯å¤§ç‰›<a href="http://weibo.com/haxy" target="_blank" rel="external">johnhax</a>çš„è§£é‡Šæ›´åŠ å®¹æ˜“ç†è§£ï¼šé—­åŒ…å°±æ˜¯å†…éƒ¨å‡½æ•°èƒ½è®¿é—®å¤–éƒ¨çš„å˜é‡ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¦ç†è§£é—­åŒ…ï¼Œåªè¦ç†æ¸…æ¥š<strong>å˜é‡ä½œç”¨åŸŸ</strong>è¿™ä¸ªæ¦‚å¿µå°±å·®ä¸å¤šäº†ã€‚æˆ‘ä¹ŸæŠŠå¯¹<strong>å˜é‡ä½œç”¨åŸŸ</strong>çš„ä¸€äº›ä¸ªäººç†è§£è®°å½•åœ¨äº†å‰ä¸¤ç¯‡æ–‡ç« ä¸­ï¼Œæ•…è¿™é‡Œå°±åªç®€å•è¯´è¯´ä¸€ä¸ªå‡½æ•°å®ƒå¯ä»¥è®¿é—®å“ªäº›ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼š</p>
<ol>
<li>è¯¥å‡½æ•°è‡ªå·±å†…éƒ¨å£°æ˜çš„å˜é‡</li>
<li>globalä½œç”¨åŸŸä¸­çš„å…¨å±€å˜é‡</li>
<li>å¦‚æœè¯¥å‡½æ•°æ˜¯å†…éƒ¨å‡½æ•°ï¼Œé‚£å®ƒè¿˜å¯ä»¥è®¿é—®å…¶å¤–éƒ¨å‡½æ•°å†…å£°æ˜çš„å˜é‡</li>
</ol>
<p>è€Œå¯¹äºç¬¬ä¸‰ç‚¹ï¼Œå°±æ˜¯é—­åŒ…çš„è¡Œä¸ºäº†ï¼Œç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜ã€‚</p>
<a id="more"></a>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    i += <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> bar;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> test = foo();</span><br><span class="line">test(); <span class="comment">// 1</span></span><br><span class="line">test(); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<p>ç®€å•è§£è¯»ä¸‹è¿™æ®µä»£ç ï¼š</p>
<ol>
<li><code>bar</code>å‡½æ•°æ˜¯å†…éƒ¨å‡½æ•°ï¼Œå³å®šä¹‰åœ¨<code>foo</code>å‡½æ•°å†…éƒ¨</li>
<li><code>foo</code>å‡½æ•°è°ƒç”¨ä¹‹åä¼šå°†<code>bar</code>å‡½æ•°çš„å¼•ç”¨ä½œä¸ºè¿”å›å€¼</li>
<li>å…¨å±€ä½œç”¨åŸŸä¸­æœ‰å˜é‡å¼•ç”¨äº†<code>bar</code>å‡½æ•°ï¼Œå³<code>bar</code>å‡½æ•°è¿˜å¤„äºæ´»åŠ¨çŠ¶æ€</li>
</ol>
<p>äºæ˜¯åœ¨<code>foo</code>å‡½æ•°å·²ç»è¢«è°ƒç”¨ç»“æŸä¹‹åï¼Œå…¶å†…éƒ¨çš„<code>i</code>å˜é‡ä»ç„¶æ²¡è¢«é”€æ¯ï¼Œè€Œä¸”åœ¨æ¯æ¬¡è°ƒç”¨<code>bar</code>å‡½æ•°ä¹‹åï¼Œå…¶å€¼æ˜¯ä¸€ç›´åœ¨é€’å¢çš„ã€‚  </p>
<p>å¦‚æœç”¨ä½œç”¨åŸŸé“¾æ¥è§£é‡Šï¼Œé‚£å°±æ›´åŠ æ¸…æ™°æ˜äº†äº†ï¼š  </p>
<p>1.ä»£ç è½½å…¥å…¨å±€æ‰§è¡Œç¯å¢ƒï¼Œå¼€å§‹è¿è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">globalScopeChain = &#123;</span><br><span class="line">  test: <span class="literal">undefined</span>,</span><br><span class="line">  foo: [<span class="built_in">Function</span>]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">fooScopeChain = [globalScopeChain];</span><br></pre></td></tr></table></figure>
<p>2.è°ƒç”¨<code>foo</code>å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¦–å…ˆï¼Œ`foo`å‡½æ•°çš„ä½œç”¨åŸŸé“¾å˜ä¸ºï¼š</span></span><br><span class="line">fooScopeChain = [&#123;</span><br><span class="line">  <span class="built_in">arguments</span>: [],</span><br><span class="line">  i: <span class="number">0</span>,</span><br><span class="line">  bar: [<span class="built_in">Function</span>]</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  test: <span class="literal">undefined</span>,</span><br><span class="line">  foo: [<span class="built_in">Function</span>]</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜äº†`bar`å‡½æ•°ï¼Œå¹¶åˆå§‹åŒ–å…¶ä½œç”¨åŸŸé“¾ä¸ºï¼š</span></span><br><span class="line">barScopeChain = [fooScopeChain];</span><br></pre></td></tr></table></figure>
<p>3.<code>foo</code>å‡½æ•°è°ƒç”¨ç»“æŸï¼Œå¹¶å°†<code>test</code>å˜é‡æŒ‡å‘<code>foo</code>æ‰§è¡Œè¿”å›çš„<code>bar</code>å‡½æ•°çš„å¼•ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ­¤æ—¶å…¨å±€ä½œç”¨åŸŸé“¾å˜ä¸ºï¼š</span></span><br><span class="line">globalScopeChain = [&#123;</span><br><span class="line">  test: [<span class="built_in">Function</span>],</span><br><span class="line">  foo: [<span class="built_in">Function</span>]</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>4.ç¬¬ä¸€æ¬¡è°ƒç”¨<code>test</code>ï¼Œä¹Ÿå°±æ˜¯<code>bar</code>å‡½æ•°ã€‚<code>bar</code>å‡½æ•°ä½œç”¨åŸŸé“¾ä¸Šæœ‰å˜é‡<code>i</code>ï¼Œä¸”å€¼ä¸º<code>0</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½œç”¨åŸŸä¸Šè¿›è¡Œå˜é‡æŸ¥æ‰¾ï¼Œæ‰¾åˆ°ååšå¢é‡èµ‹å€¼æ“ä½œï¼Œæ‰€ä»¥`i = 1`</span></span><br><span class="line">barScopeChain = [&#123;</span><br><span class="line">  <span class="built_in">arguments</span>: []</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  i: <span class="number">0</span>,</span><br><span class="line">  bar: [<span class="built_in">Function</span>]</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  test: <span class="literal">undefined</span>,</span><br><span class="line">  foo: [<span class="built_in">Function</span>]</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>5.ç¬¬äºŒæ¬¡è°ƒç”¨<code>test</code>ï¼Œä¸ç¬¬4æ­¥ç›¸åŒã€‚åªæ˜¯æœ¬æ¬¡è°ƒç”¨æ—¶ï¼Œå…¶ä½œç”¨åŸŸé“¾ä¸Šçš„<code>i</code>å€¼å·²ç»åœ¨ä¸Šä¸€æ¬¡è°ƒç”¨åå˜æˆ<code>1</code>äº†ï¼Œæ‰€ä»¥å¢é‡èµ‹å€¼æ“ä½œä¹‹åï¼Œå¾—åˆ°ç»“æœä¸º<code>2</code>ã€‚  </p>
<p>å› æ­¤ï¼Œåªè¦ç†è§£äº†ä½œç”¨åŸŸé“¾ï¼Œå†æ¥çœ‹é—­åŒ…å°±å¾ˆæ¸…æ™°äº†ã€‚ä¸è¿‡å¯¹äºé—­åŒ…çš„è§£é‡Šï¼Œæˆ‘ä»ç„¶æ¨èå¼€ç¯‡æ‰€æåˆ°çš„ï¼š<strong>å†…éƒ¨å‡½æ•°èƒ½è®¿é—®å¤–éƒ¨çš„å˜é‡</strong>ï¼Œç®€å•æ˜“æ‡‚ã€‚  </p>
]]></content>
    <summary type="html">
    <![CDATA[<p>é—­åŒ…æ˜¯JavaScriptä¸­çš„é‡è¦ç‰¹æ€§ä¹‹ä¸€ï¼Œå¤§å¤šæ•°ç”¨è¿‡JavaScriptçš„ç¨‹åºå‘˜ä¹ŸåŸºæœ¬ä¸Šéƒ½æ¥è§¦è¿‡é—­åŒ…ï¼Œä¸ç®¡æ˜¯å¦çŸ¥é“æˆ–äº†è§£é—­åŒ…è¿™ä¸ªæ¦‚å¿µã€‚æ¯”å¦‚åœ¨ç”¨jQueryçš„æ—¶å€™ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line">$(<span class="string">'.btn'</span>).onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">  count += <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>é—­åŒ…ï¼Œ<a href="http://zh.wikipedia.org/wiki/%E9%97%AD%E5%8C%85_(%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6)">ç»´åŸºç™¾ç§‘</a>çš„è§£é‡Šæ˜¯ï¼šæŒ‡å¼•ç”¨äº†è‡ªç”±å˜é‡çš„å‡½æ•°ã€‚è€Œæˆ‘ä¸ªäººè®¤ä¸ºå‰ç«¯å¤§ç‰›<a href="http://weibo.com/haxy">johnhax</a>çš„è§£é‡Šæ›´åŠ å®¹æ˜“ç†è§£ï¼šé—­åŒ…å°±æ˜¯å†…éƒ¨å‡½æ•°èƒ½è®¿é—®å¤–éƒ¨çš„å˜é‡ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¦ç†è§£é—­åŒ…ï¼Œåªè¦ç†æ¸…æ¥š<strong>å˜é‡ä½œç”¨åŸŸ</strong>è¿™ä¸ªæ¦‚å¿µå°±å·®ä¸å¤šäº†ã€‚æˆ‘ä¹ŸæŠŠå¯¹<strong>å˜é‡ä½œç”¨åŸŸ</strong>çš„ä¸€äº›ä¸ªäººç†è§£è®°å½•åœ¨äº†å‰ä¸¤ç¯‡æ–‡ç« ä¸­ï¼Œæ•…è¿™é‡Œå°±åªç®€å•è¯´è¯´ä¸€ä¸ªå‡½æ•°å®ƒå¯ä»¥è®¿é—®å“ªäº›ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼š</p>
<ol>
<li>è¯¥å‡½æ•°è‡ªå·±å†…éƒ¨å£°æ˜çš„å˜é‡</li>
<li>globalä½œç”¨åŸŸä¸­çš„å…¨å±€å˜é‡</li>
<li>å¦‚æœè¯¥å‡½æ•°æ˜¯å†…éƒ¨å‡½æ•°ï¼Œé‚£å®ƒè¿˜å¯ä»¥è®¿é—®å…¶å¤–éƒ¨å‡½æ•°å†…å£°æ˜çš„å˜é‡</li>
</ol>
<p>è€Œå¯¹äºç¬¬ä¸‰ç‚¹ï¼Œå°±æ˜¯é—­åŒ…çš„è¡Œä¸ºäº†ï¼Œç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜ã€‚</p>]]>
    
    </summary>
    
      <category term="closure" scheme="http://heroicyang.com/tags/closure/"/>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[JavaScriptå˜é‡ä½œç”¨åŸŸï¼ˆç»­ï¼‰]]></title>
    <link href="http://heroicyang.com/2013/07/22/javascript-scope-sequel/"/>
    <id>http://heroicyang.com/2013/07/22/javascript-scope-sequel/</id>
    <published>2013-07-22T14:14:06.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>æ¥<a href="http://heroicyang.com/2013/07/14/javascript-variable-scope/" target="_blank" rel="external">ä¸Šç¯‡</a>ï¼Œå·²ç»å¤§è‡´æ˜ç¡®äº†ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li>JavaScriptæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œåªæœ‰å‡½æ•°(å±€éƒ¨)ä½œç”¨åŸŸå’Œå…¨å±€ä½œç”¨åŸŸ</li>
<li>å‡½æ•°ä¸­æœªä½¿ç”¨<code>var</code>å…³é”®å­—å£°æ˜çš„å˜é‡ä¼šæˆä¸ºå…¨å±€å˜é‡</li>
<li>åŒåæ—¶å±€éƒ¨å˜é‡è®¿é—®ä¼˜å…ˆçº§é«˜äºå…¨å±€å˜é‡ </li>
<li>JavaScriptå…·æœ‰å˜é‡å£°æ˜æå‰çš„ç‰¹æ€§</li>
</ol>
<p>æ¥ä¸‹æ¥æ ¹æ®ä¸Šç¯‡ç•™ä¸‹çš„æœ€åä¸€æ®µä»£ç ï¼Œç»§ç»­è°ˆè°ˆå˜é‡ä½œç”¨åŸŸã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'global'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'foo'</span>;</span><br><span class="line">  bar();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo();</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç æœ€ç»ˆä¼šåœ¨æ§åˆ¶å°æ‰“å°å‡º<code>&#39;global&#39;</code>ï¼Œè€Œå¹¶é<code>&#39;foo&#39;</code>ã€‚å¯ä»¥çœ‹å‡ºï¼Œå‡½æ•°è¿è¡Œæ—¶èƒ½è®¿é—®åˆ°çš„ä½œç”¨åŸŸæ˜¯å®ƒè¢«å®šä¹‰æ—¶çš„ä½œç”¨åŸŸï¼Œä¸æ˜¯è¢«è°ƒç”¨æ—¶çš„ä½œç”¨åŸŸã€‚</p>
<p>æ¯å½“è°ˆåŠJavaScriptä½œç”¨åŸŸçš„æ—¶å€™ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¼šæåˆ°â€œè¯æ³•ä½œç”¨åŸŸâ€ã€â€œæ‰§è¡Œç¯å¢ƒâ€ã€â€œæ´»åŠ¨å¯¹è±¡â€ã€â€œä½œç”¨åŸŸé“¾â€è¿™å‡ ä¸ªæ¦‚å¿µï¼Œè€Œäº†è§£è¿™äº›æ¦‚å¿µå°†æœ‰åŠ©äºç†è§£JavaScriptä¸­çš„é—­åŒ…ã€‚æˆ‘ä¹Ÿè°ˆè°ˆæˆ‘å¯¹æ­¤çš„ç†è§£ï¼Œå¦‚è¯¯æ¬¢è¿æŒ‡æ­£ï¼Œä¸èƒœæ„Ÿæ¿€ã€‚</p>
<a id="more"></a>
<h3 id="è¯æ³•ä½œç”¨åŸŸ">è¯æ³•ä½œç”¨åŸŸ</h3><p>è¯æ³•ä½œç”¨åŸŸï¼Œä¹Ÿç§°é™æ€ä½œç”¨åŸŸï¼Œä¹Ÿå³æ˜¯è¯´å‡½æ•°çš„ä½œç”¨åŸŸæ˜¯å®šä¹‰æ—¶å†³å®šçš„ï¼Œè€Œéè¿è¡Œæ—¶ã€‚æœ€å¼€å§‹çš„ä»£ç å°±é˜æ˜äº†è¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥åœ¨æºç æ—¶æœŸå°±å¯ä»¥é€šè¿‡åˆ†æå¾—å‡ºä¸€ä¸ªå‡½æ•°çš„ä½œç”¨åŸŸã€‚JavaScriptæ­£æ˜¯åŸºäºè¯æ³•ä½œç”¨åŸŸçš„è¯­è¨€ã€‚</p>
<h3 id="æ‰§è¡Œç¯å¢ƒ">æ‰§è¡Œç¯å¢ƒ</h3><p>JavaScriptéœ€è¦ä¸€ä¸ªç¯å¢ƒæ¥è¿è¡Œï¼Œæ¯”å¦‚å®¢æˆ·ç«¯çš„æµè§ˆå™¨å’ŒæœåŠ¡ç«¯çš„Node.jsã€‚è€Œæ‰§è¡Œç¯å¢ƒæœ‰åˆ†ä¸º<strong>å…¨å±€æ‰§è¡Œç¯å¢ƒ</strong>å’Œ<strong>å±€éƒ¨æ‰§è¡Œç¯å¢ƒ</strong>ã€‚</p>
<h4 id="å…¨å±€æ‰§è¡Œç¯å¢ƒ">å…¨å±€æ‰§è¡Œç¯å¢ƒ</h4><p>åœ¨æµè§ˆå™¨ä¸­ï¼Œå…¨å±€æ‰§è¡Œç¯å¢ƒä¸º<code>window</code>å¯¹è±¡ã€‚å› æ­¤å½“JavaScriptä»£ç è¿è¡Œæ—¶ï¼Œæ‰€æœ‰çš„å…¨å±€å˜é‡å’Œå‡½æ•°éƒ½ä½œä¸ºäº†<code>window</code>å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•åˆ›å»ºã€‚å…¨å±€æ‰§è¡Œç¯å¢ƒå…³è”äº†ä¸€ä¸ª<strong>ä½œç”¨åŸŸé“¾</strong>ï¼ŒåŒ…å«äº†å…¨å±€æ‰§è¡Œç¯å¢ƒä¸­çš„å˜é‡å¯¹è±¡ã€‚</p>
<h4 id="å±€éƒ¨æ‰§è¡Œç¯å¢ƒã€æ´»åŠ¨å¯¹è±¡">å±€éƒ¨æ‰§è¡Œç¯å¢ƒã€æ´»åŠ¨å¯¹è±¡</h4><p>æ¯ä¸ªå‡½æ•°åœ¨å®šä¹‰æ—¶ï¼Œéƒ½ä¼šå…³è”ä¸€ä¸ªåˆå§‹çš„<strong>ä½œç”¨åŸŸé“¾</strong>ï¼Œå°†å½“å‰æ‰§è¡Œç¯å¢ƒä½œç”¨åŸŸé“¾ä¸Šçš„å˜é‡å¯¹è±¡é™„åŠ åˆ°è¿™ä¸ªå…³è”çš„<strong>ä½œç”¨åŸŸé“¾</strong>ä¸Šã€‚æ¯ä¸ªå‡½æ•°éƒ½æ˜¯æœ‰è‡ªå·±çš„æ‰§è¡Œç¯å¢ƒçš„ï¼Œä¹Ÿå°±æ˜¯å±€éƒ¨æ‰§è¡Œç¯å¢ƒã€‚å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨ï¼Œè¿›å…¥å±€éƒ¨æ‰§è¡Œç¯å¢ƒã€‚éšä¹‹åˆ›å»ºäº†<strong>æ´»åŠ¨å¯¹è±¡</strong>ï¼ŒåŒ…å«<code>arguments</code>å’Œå±€éƒ¨å˜é‡ï¼Œç„¶åå°†å…¶é™„åŠ åˆ°ä½œç”¨åŸŸé“¾çš„å‰ç«¯ï¼ˆå³ä¸‹æ ‡ä¸º0ï¼‰ã€‚åœ¨å‡½æ•°æ‰§è¡Œä¹‹åï¼Œé€€å‡ºå±€éƒ¨æ‰§è¡Œç¯å¢ƒï¼ŒæŠŠæ§åˆ¶æƒäº¤ç»™ä¹‹å‰çš„æ‰§è¡Œç¯å¢ƒï¼ˆå¯èƒ½æ˜¯å…¨å±€æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å¦ä¸€ä¸ªå±€éƒ¨æ‰§è¡Œç¯å¢ƒï¼‰ã€‚</p>
<h3 id="ä½œç”¨åŸŸé“¾">ä½œç”¨åŸŸé“¾</h3><p>å‰é¢å·²ç»åå¤æåˆ°äº†ä½œç”¨åŸŸé“¾ï¼Œä¹ŸåŸºæœ¬è§£é‡Šäº†ä½œç”¨åŸŸé“¾ï¼Œå®ƒå·®ä¸å¤šç­‰åŒäºä¸€ä¸ªå¯¹è±¡åˆ—è¡¨æˆ–é“¾è¡¨ã€‚ä¸ºäº†æ›´å¥½çš„ç†è§£ä½œç”¨åŸŸé“¾ï¼Œè¿˜æ˜¯ç»“åˆæœ€å¼€å§‹çš„é‚£æ®µä»£ç æ¥è¿›è¡Œè§£é‡Šï¼Œä¸ç„¶æœ‰ç‚¹ä¸æ˜¯å¾ˆå¥½ç†æ¸…æ¥šã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'global'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'foo'</span>;</span><br><span class="line">  bar();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo();</span><br></pre></td></tr></table></figure>
<p><em>1.ä»£ç è¿è¡Œå¼€å§‹ï¼Œåœ¨å…¨å±€æ‰§è¡Œç¯å¢ƒä¸­ï¼Œå…¨å±€ç¯å¢ƒå…³è”äº†ä¸€ä¸ªä½œç”¨åŸŸé“¾ï¼Œå˜é‡å¯¹è±¡åŒ…å«<code>name</code>ã€<code>foo</code>ã€<code>bar</code>ã€‚ç„¶å<code>foo</code>å‡½æ•°å’Œ<code>bar</code>å‡½æ•°ä¹Ÿå„è‡ªå…³è”äº†è‡ªå·±ä½œç”¨åŸŸé“¾ã€‚</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">globalScopeChain = &#123;</span><br><span class="line">    name: <span class="string">'global'</span>,</span><br><span class="line">    foo: [<span class="built_in">Function</span>],</span><br><span class="line">    bar: [<span class="built_in">Function</span>]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">fooScopeChain = [globalScopeChain]</span><br><span class="line">barScopeChain = [globalScopeChain]</span><br></pre></td></tr></table></figure>
<p><em>2.è°ƒç”¨<code>foo</code>å‡½æ•°ï¼Œè¿›å…¥<code>foo</code>å‡½æ•°çš„å±€éƒ¨æ‰§è¡Œç¯å¢ƒï¼Œåˆ›å»ºæ´»åŠ¨å¯¹è±¡åŒ…å«<code>arguments</code>ã€<code>name</code>ï¼Œå¹¶å°†æ´»åŠ¨å¯¹è±¡æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾çš„å‰ç«¯ã€‚</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">fooScopeChain = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">arguments</span>: [],</span><br><span class="line">    name: <span class="string">'foo'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">'global'</span>,</span><br><span class="line">    foo: [<span class="built_in">Function</span>],</span><br><span class="line">    bar: [<span class="built_in">Function</span>]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><em>3.è°ƒç”¨<code>bar</code>å‡½æ•°ï¼Œè¿›å…¥<code>bar</code>å‡½æ•°çš„å±€éƒ¨æ‰§è¡Œç¯å¢ƒï¼Œåˆ›å»ºæ´»åŠ¨å¯¹è±¡åŒ…å«<code>arguments</code>ï¼Œç„¶åä¹Ÿå°†æ´»åŠ¨å¯¹è±¡æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾çš„å‰ç«¯ã€‚</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">barScopeChain = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">arguments</span>: []</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">'global'</span>,</span><br><span class="line">    foo: [<span class="built_in">Function</span>],</span><br><span class="line">    bar: [<span class="built_in">Function</span>]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>è€Œå˜é‡çš„æŸ¥æ‰¾ï¼Œå°±æ˜¯åœ¨æ•´ä¸ªä½œç”¨åŸŸé“¾ä¸Šè¿›è¡Œï¼Œä»ç¬¬ä¸€ä¸ªå¯¹è±¡å¼€å§‹ï¼Œç›´åˆ°ä½œç”¨åŸŸé“¾çš„é¡¶ç«¯ï¼ˆå³å…¨å±€ï¼‰ã€‚è¿™ä¹Ÿå°±æ˜¯å®ä¾‹ä»£ç ä¸­æ‰“å°å‡º<code>&#39;global&#39;</code>çš„åŸå› ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æ¥<a href="http://heroicyang.com/2013/07/14/javascript-variable-scope/">ä¸Šç¯‡</a>ï¼Œå·²ç»å¤§è‡´æ˜ç¡®äº†ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li>JavaScriptæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œåªæœ‰å‡½æ•°(å±€éƒ¨)ä½œç”¨åŸŸå’Œå…¨å±€ä½œç”¨åŸŸ</li>
<li>å‡½æ•°ä¸­æœªä½¿ç”¨<code>var</code>å…³é”®å­—å£°æ˜çš„å˜é‡ä¼šæˆä¸ºå…¨å±€å˜é‡</li>
<li>åŒåæ—¶å±€éƒ¨å˜é‡è®¿é—®ä¼˜å…ˆçº§é«˜äºå…¨å±€å˜é‡ </li>
<li>JavaScriptå…·æœ‰å˜é‡å£°æ˜æå‰çš„ç‰¹æ€§</li>
</ol>
<p>æ¥ä¸‹æ¥æ ¹æ®ä¸Šç¯‡ç•™ä¸‹çš„æœ€åä¸€æ®µä»£ç ï¼Œç»§ç»­è°ˆè°ˆå˜é‡ä½œç”¨åŸŸã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'global'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'foo'</span>;</span><br><span class="line">  bar();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo();</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç æœ€ç»ˆä¼šåœ¨æ§åˆ¶å°æ‰“å°å‡º<code>&#39;global&#39;</code>ï¼Œè€Œå¹¶é<code>&#39;foo&#39;</code>ã€‚å¯ä»¥çœ‹å‡ºï¼Œå‡½æ•°è¿è¡Œæ—¶èƒ½è®¿é—®åˆ°çš„ä½œç”¨åŸŸæ˜¯å®ƒè¢«å®šä¹‰æ—¶çš„ä½œç”¨åŸŸï¼Œä¸æ˜¯è¢«è°ƒç”¨æ—¶çš„ä½œç”¨åŸŸã€‚</p>
<p>æ¯å½“è°ˆåŠJavaScriptä½œç”¨åŸŸçš„æ—¶å€™ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¼šæåˆ°â€œè¯æ³•ä½œç”¨åŸŸâ€ã€â€œæ‰§è¡Œç¯å¢ƒâ€ã€â€œæ´»åŠ¨å¯¹è±¡â€ã€â€œä½œç”¨åŸŸé“¾â€è¿™å‡ ä¸ªæ¦‚å¿µï¼Œè€Œäº†è§£è¿™äº›æ¦‚å¿µå°†æœ‰åŠ©äºç†è§£JavaScriptä¸­çš„é—­åŒ…ã€‚æˆ‘ä¹Ÿè°ˆè°ˆæˆ‘å¯¹æ­¤çš„ç†è§£ï¼Œå¦‚è¯¯æ¬¢è¿æŒ‡æ­£ï¼Œä¸èƒœæ„Ÿæ¿€ã€‚</p>]]>
    
    </summary>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
      <category term="scope" scheme="http://heroicyang.com/tags/scope/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[JavaScriptå˜é‡ä½œç”¨åŸŸ]]></title>
    <link href="http://heroicyang.com/2013/07/14/javascript-variable-scope/"/>
    <id>http://heroicyang.com/2013/07/14/javascript-variable-scope/</id>
    <published>2013-07-14T14:11:36.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>æ‰€è°“ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯å˜é‡å’Œå‡½æ•°èµ·ä½œç”¨çš„åŒºåŸŸï¼Œä¸åŒçš„è¯­è¨€æœ‰ç€ä¸åŒçš„å®ç°ã€‚è€Œåœ¨JavaScriptä¸­ï¼Œè¿™ä¹Ÿæ˜¯å¾€å¾€è®©äººè¿·ç³Šçš„åœ°æ–¹ï¼Œä¹Ÿæ˜¯JavaScriptä¸­å¿…é¡»ç†è§£çš„ç‰¹æ€§ä¹‹ä¸€ã€‚  </p>
<p>é¦–å…ˆæ¥çœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> foo = <span class="string">'bar'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i); <span class="comment">// 10</span></span><br><span class="line">  <span class="built_in">console</span>.log(foo); <span class="comment">// 'bar'</span></span><br><span class="line">&#125;</span><br><span class="line">test();</span><br></pre></td></tr></table></figure>
<p>ä»è¿è¡Œç»“æœä¸éš¾çœ‹å‡ºï¼Œå˜é‡<code>i</code>åœ¨å¾ªç¯ä½“ç»“æŸä¹‹åä»ç„¶å¯ä»¥è®¿é—®ã€‚è€Œè¯¸å¦‚Javaã€C#ç­‰è¯­è¨€ä¸­ï¼Œå¾ªç¯ç»“æŸä¹‹åä¾¿ä¸èƒ½å†è®¿é—®åˆ°å¾ªç¯ä½“ä¸­çš„å˜é‡äº†ã€‚ç»§ç»­çœ‹ä¸‹é¢ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'heroic'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'foo'</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(name); <span class="comment">// 'foo'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo();</span><br><span class="line"><span class="built_in">console</span>.log(name); <span class="comment">// 'heroic'</span></span><br></pre></td></tr></table></figure>
<p><strong>ç»“åˆä¸¤æ®µä»£ç å¯ä»¥çŸ¥é“ï¼Œåœ¨JavaScriptä¸­æ˜¯ä¸å­˜åœ¨å—çº§ä½œç”¨åŸŸçš„ï¼Œåªå­˜åœ¨å‡½æ•°ä½œç”¨åŸŸï¼ˆä¹Ÿç§°â€œæœ¬åœ°ä½œç”¨åŸŸâ€ï¼‰å’Œå…¨å±€ä½œç”¨åŸŸã€‚</strong>è€Œä½œç”¨åŸŸä¸­çš„å˜é‡æˆ‘ä»¬åˆ†åˆ«ç§°å…¶ä¸ºï¼šå±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡ã€‚  </p>
<p>å‰è¾ˆä»¬ï¼ˆå‰ç«¯çš„é•¿è¾ˆä»¬ï¼Œåš¯åš¯ï¼‰å¸¸å¸¸åå¤åœ¨è¯´ï¼Œå…¨å±€å˜é‡æ˜¯é­”é¬¼å•Šï¼Œé­”é¬¼å•Šã€‚ã€‚ã€‚ï¼ˆå›å£°ï¼‰é‚£åˆ°åº•æ˜¯å˜›åŸå› å‘¢ï¼Ÿå’±æ¥ç€å¾€ä¸‹è¯´ã€‚</p>
<a id="more"></a>
<ul>
<li>JavaScriptä¸­å¦‚æœä¸ä½¿ç”¨<code>var</code>å…³é”®å­—æ¥å£°æ˜å˜é‡ï¼Œåˆ™è¯¥å˜é‡ä¼šæˆä¸ºå…¨å±€å˜é‡ã€‚  </li>
<li>åœ¨æ•´ä¸ªä½œç”¨åŸŸä¸­ï¼Œéƒ½å¯ä»¥è®¿é—®å¹¶ä¿®æ”¹è¿™äº›å…¨å±€å˜é‡ï¼Œä¸å¯æ§ï¼ŒBUGéšä¹‹è€Œæ¥ã€‚  </li>
<li>å±€éƒ¨å˜é‡çš„è®¿é—®ä¼˜å…ˆçº§é«˜äºå…¨å±€å˜é‡ï¼Œæ‰€ä»¥åœ¨æŸç§ç‰¹æ®Šæƒ…å†µä¸‹ï¼ˆJavaScriptå˜é‡å£°æ˜æå‰ç‰¹æ€§ï¼‰ï¼Œå¯èƒ½å¾—ä¸åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  name = <span class="string">'foo'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(name); <span class="comment">// 'foo'</span></span><br><span class="line">  name = <span class="string">'bar'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo();</span><br><span class="line">bar();</span><br><span class="line"><span class="built_in">console</span>.log(name); <span class="comment">// 'bar'</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ä¸ªä¾‹å­å¾ˆå¥½ç†è§£ï¼Œç”±äºåœ¨<code>foo</code>ä¸­æ²¡æœ‰ä½¿ç”¨<code>var</code>å…³é”®å­—æ¥å£°æ˜<code>name</code>å˜é‡ï¼Œæ‰€ä»¥å¯ä»¥åœ¨æ•´ä¸ªå…¨å±€ä½œç”¨åŸŸä¸­è®¿é—®å¹¶ä¿®æ”¹è¯¥å˜é‡çš„å€¼ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­å¿…ç„¶ä¼šæ··ä¹±ä¸å ªï¼Œå¼•å…¥ä¸å¯æ§çš„BUGç­‰ç­‰ã€‚æ¥ä¸‹æ¥çœ‹çœ‹è¿™ä¸ªå¯èƒ½å¯¹äºåˆå­¦è€…æ¥è¯´æœ‰ç‚¹è¿·ç³Šçš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'heroic'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(name);</span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'foo'</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo();</span><br><span class="line"><span class="comment">// undefined</span></span><br><span class="line"><span class="comment">// 'foo'</span></span><br></pre></td></tr></table></figure>
<p>è¿™å°±æ˜¯å‰é¢æåˆ°çš„<strong>å£°æ˜æå‰</strong>ï¼ŒJavaScriptä¸­å˜é‡å’Œå‡½æ•°ä»¥åŠå‡½æ•°çš„å‚æ•°çš„ç”³æ˜éƒ½æ˜¯åœ¨ä¸€ä¸ªç±»ä¼¼äºé¢„ç¼–è¯‘çš„æ—¶æœŸå°±åšäº†ï¼Œè€Œåœ¨è¿è¡Œæ—¶æœŸæ‰æ˜¯åˆ›å»ºå˜é‡èµ‹å€¼è¡¨è¾¾å¼å’Œå‡½æ•°è¡¨è¾¾å¼ç­‰ã€‚æ‰€ä»¥ä¸Šé¢çš„ä»£ç ç­‰åŒäºï¼š</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var <span class="keyword">name</span> = <span class="string">'heroic'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span></span> foo() &#123;</span><br><span class="line">  var <span class="keyword">name</span>;</span><br><span class="line">  console.<span class="built_in">log</span>(<span class="keyword">name</span>);</span><br><span class="line">  <span class="keyword">name</span> = <span class="string">'foo'</span>;</span><br><span class="line">  console.<span class="built_in">log</span>(<span class="keyword">name</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo();</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>æ‰€è°“ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯å˜é‡å’Œå‡½æ•°èµ·ä½œç”¨çš„åŒºåŸŸï¼Œä¸åŒçš„è¯­è¨€æœ‰ç€ä¸åŒçš„å®ç°ã€‚è€Œåœ¨JavaScriptä¸­ï¼Œè¿™ä¹Ÿæ˜¯å¾€å¾€è®©äººè¿·ç³Šçš„åœ°æ–¹ï¼Œä¹Ÿæ˜¯JavaScriptä¸­å¿…é¡»ç†è§£çš„ç‰¹æ€§ä¹‹ä¸€ã€‚  </p>
<p>é¦–å…ˆæ¥çœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> foo = <span class="string">'bar'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i); <span class="comment">// 10</span></span><br><span class="line">  <span class="built_in">console</span>.log(foo); <span class="comment">// 'bar'</span></span><br><span class="line">&#125;</span><br><span class="line">test();</span><br></pre></td></tr></table></figure>
<p>ä»è¿è¡Œç»“æœä¸éš¾çœ‹å‡ºï¼Œå˜é‡<code>i</code>åœ¨å¾ªç¯ä½“ç»“æŸä¹‹åä»ç„¶å¯ä»¥è®¿é—®ã€‚è€Œè¯¸å¦‚Javaã€C#ç­‰è¯­è¨€ä¸­ï¼Œå¾ªç¯ç»“æŸä¹‹åä¾¿ä¸èƒ½å†è®¿é—®åˆ°å¾ªç¯ä½“ä¸­çš„å˜é‡äº†ã€‚ç»§ç»­çœ‹ä¸‹é¢ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'heroic'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'foo'</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(name); <span class="comment">// 'foo'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo();</span><br><span class="line"><span class="built_in">console</span>.log(name); <span class="comment">// 'heroic'</span></span><br></pre></td></tr></table></figure>
<p><strong>ç»“åˆä¸¤æ®µä»£ç å¯ä»¥çŸ¥é“ï¼Œåœ¨JavaScriptä¸­æ˜¯ä¸å­˜åœ¨å—çº§ä½œç”¨åŸŸçš„ï¼Œåªå­˜åœ¨å‡½æ•°ä½œç”¨åŸŸï¼ˆä¹Ÿç§°â€œæœ¬åœ°ä½œç”¨åŸŸâ€ï¼‰å’Œå…¨å±€ä½œç”¨åŸŸã€‚</strong>è€Œä½œç”¨åŸŸä¸­çš„å˜é‡æˆ‘ä»¬åˆ†åˆ«ç§°å…¶ä¸ºï¼šå±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡ã€‚  </p>
<p>å‰è¾ˆä»¬ï¼ˆå‰ç«¯çš„é•¿è¾ˆä»¬ï¼Œåš¯åš¯ï¼‰å¸¸å¸¸åå¤åœ¨è¯´ï¼Œå…¨å±€å˜é‡æ˜¯é­”é¬¼å•Šï¼Œé­”é¬¼å•Šã€‚ã€‚ã€‚ï¼ˆå›å£°ï¼‰é‚£åˆ°åº•æ˜¯å˜›åŸå› å‘¢ï¼Ÿå’±æ¥ç€å¾€ä¸‹è¯´ã€‚</p>]]>
    
    </summary>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å…³äºã€ŠJavaScript Web Applicationã€‹ä¸­çš„bindæ–¹æ³•]]></title>
    <link href="http://heroicyang.com/2013/06/24/bind-function-in-javascript-web-application-book/"/>
    <id>http://heroicyang.com/2013/06/24/bind-function-in-javascript-web-application-book/</id>
    <published>2013-06-24T13:04:39.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>å»å¹´åº•å°±è‰è‰äº†äº†çš„ç¿»è¿‡<a href="http://book.douban.com/subject/10733304/" target="_blank">ã€ŠJavaScript Web Applicationã€‹</a>è¿™æœ¬ä¹¦ï¼Œå½“æ—¶å°±é‡åˆ°å¥½å‡ ä¸ªåœ°æ–¹æ²¡æ€ä¹ˆçœ‹æ˜ç™½ï¼Œå½“æ—¶ä¹Ÿæ²¡æœ‰å»æ·±ç©¶ï¼Œå°±åªæ˜¯ç®€å•çš„è¿‡ä¸€éè¿™æœ¬ä¹¦ã€‚ç”±äºæ­¤å‰JavaScriptæ–¹é¢çš„çŸ¥è¯†åŒ®ä¹ï¼Œæ‰€ä»¥æŠŠè¿™æœ¬ä¹¦å°±ç¼“åœ¨é˜…è¯»é˜Ÿåˆ—é‡Œäº†ï¼Œæœ€è¿‘æ‰è½®åˆ°ã€‚å…¶é—´è¯»äº†å¥½å‡ æœ¬åŸºç¡€å’Œè¿›é˜¶çš„ä¹¦ï¼Œæ‰€ä»¥è¿™æ¬¡è¯»è¿™æœ¬ä¹¦ï¼Œå¾ˆå¤šä¹‹å‰ä¸æ˜ç™½çš„åœ°æ–¹å°±è±ç„¶æ˜äº†äº†ã€‚ä¸è¿‡å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œæ²¡å‡†ä¸‹æ¬¡å¿˜è®°äº†å‘¢ã€‚  </p>
<p>è®°å¾—æ­¤å‰ä¹¦ä¸­å¯¹ES5 <code>bind()</code>æ–¹æ³•çš„å®ç°å°±æ˜¯ä¸€ä¸ªè®©æˆ‘æ„Ÿåˆ°è¿·ç³Šçš„åœ°æ–¹ï¼ˆä¸­æ–‡ç‰ˆP16ï¼‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="built_in">Function</span>.prototype.bind) &#123;</span><br><span class="line">  <span class="built_in">Function</span>.prototype.bind = <span class="function"><span class="keyword">function</span> <span class="params">(context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> slice = [].slice</span><br><span class="line">      , args = slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>)</span><br><span class="line">      , self = <span class="keyword">this</span></span><br><span class="line">      , nop = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;&#125;  <span class="comment">// â‘  `nop`ï¼ˆå‡½æ•°ï¼‰çš„ä½œç”¨ï¼Ÿ</span></span><br><span class="line">      , bound = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="comment">// â‘¡ ä¸ºä»€ä¹ˆè¦åš`instanceof`åˆ¤æ–­ï¼Ÿ</span></span><br><span class="line">          <span class="keyword">return</span> self.apply(<span class="keyword">this</span> <span class="keyword">instanceof</span> nop ? <span class="keyword">this</span> : (context || &#123;&#125;),</span><br><span class="line">                              args.concat(slice.call(<span class="built_in">arguments</span>)));</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// â‘¢ ä¸ºä»€ä¹ˆè¦è®¾ç½®å®ƒä¿©çš„åŸå‹ï¼Ÿ</span></span><br><span class="line">    nop.prototype = self.prototype;</span><br><span class="line">    bound.prototype = <span class="keyword">new</span> nop();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bound;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>bind()</code>ï¼šç”¨æ¥åŠ¨æ€æ”¹å˜å‡½æ•°è°ƒç”¨æ—¶å…¶å†…éƒ¨<code>this</code>å¯¹è±¡çš„å¼•ç”¨ï¼Œä½¿ç›®æ ‡å‡½æ•°åŸºäºæ­£ç¡®çš„ä¸Šä¸‹æ–‡è¿›è¡Œè°ƒç”¨ã€‚jQueryä¸­å®ç°ä¸º<code>$.proxy()</code>æ–¹æ³•ï¼ŒES5åˆ™è‡ªå¸¦äº†ã€‚</p>
</blockquote>
<p>ä¸Šé¢ä»£ç ä¸­â‘  â‘¡ â‘¢éƒ½æ˜¯æˆ‘æ­¤å‰ä¸æ˜ç™½çš„åœ°æ–¹ï¼Œä¸è¿‡åœ¨è¿™æ¬¡é˜…è¯»çš„è¿‡ç¨‹ä¸­ï¼Œå°±è±ç„¶å¼€æœ—äº†ã€‚</p>
<a id="more"></a>
<p>è®©æˆ‘æ¥å®ç°è¿™ä¸ªæ–¹æ³•çš„è¯ï¼Œæˆ–è®¸åº”è¯¥æ˜¯è¿™æ ·å­çš„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å–åä¸º`bind1`å¥½äº†ï¼Œæ–¹ä¾¿åé¢å¯¹æ¯”</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.bind1 = <span class="function"><span class="keyword">function</span> <span class="params">(context)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> slice = [].slice</span><br><span class="line">    , args = slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>)</span><br><span class="line">    , self = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> self.apply(context || &#123;&#125;, args.concat(slice.call(<span class="built_in">arguments</span>)));</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯ä¸ä¼šå¼•å…¥<code>nop</code>è¿™ä¸ªç©ºå‡½æ•°ï¼Œä¸ä¼šåš<code>intanceof</code>åˆ¤æ–­ï¼Œä¸ä¼šæœ‰åŸå‹è®¾ç½®ã€‚å½“ç„¶ï¼Œè¿™ä¸ªå®ç°æ˜¯æ²¡æœ‰å•¥å¤§é—®é¢˜çš„ï¼Œä¸å°±æ˜¯æ”¹å˜å‡½æ•°è°ƒç”¨æ—¶çš„ä¸Šä¸‹æ–‡ç¯å¢ƒä¹ˆï¼Œè²Œä¼¼å¦¥å¦¥çš„å‘¢ã€‚  </p>
<p>ä½†æ˜¯ç°åœ¨ä»”ç»†æƒ³æƒ³ï¼Œè¿™ä¸ªå®ç°æ˜¯æ²¡é”™ï¼Œä½†ä¸å®Œå–„ã€‚å› ä¸ºJavaScriptä¸­ä¸€ä¸ªå‡½æ•°é™¤äº†å¯ä»¥åšæ™®é€šçš„å‡½æ•°è°ƒç”¨ä»¥å¤–ï¼Œè¿˜å……å½“äº†æ„é€ å‡½æ•°çš„ä½œç”¨ï¼Œæ‰€ä»¥å°±å¯èƒ½ä¼šæœ‰ä¸‹é¢è¿™æ ·çš„ä»£ç ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'test'</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log([].slice.call(<span class="built_in">arguments</span>), <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> fun = func.bind(obj, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">  , fun1 = func.bind1(obj, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">fun(<span class="number">4</span>);  <span class="comment">// [ 1, 2, 3, 4 ] &#123; name: 'test' &#125;</span></span><br><span class="line"><span class="keyword">var</span> newFun = <span class="keyword">new</span> fun(<span class="number">4</span>);  <span class="comment">// [ 1, 2, 3, 4 ] &#123;&#125;</span></span><br><span class="line"></span><br><span class="line">fun1(<span class="number">4</span>);  <span class="comment">// [ 1, 2, 3, 4 ] &#123; name: 'test' &#125;</span></span><br><span class="line"><span class="keyword">var</span> newFun1 = <span class="keyword">new</span> fun1(<span class="number">4</span>);  <span class="comment">// [ 1, 2, 3, 4 ] &#123; name: 'test' &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(newFun <span class="keyword">instanceof</span> fun);  <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(newFun <span class="keyword">instanceof</span> func);  <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(newFun1 <span class="keyword">instanceof</span> fun1);  <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(newFun1 <span class="keyword">instanceof</span> func);  <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æ­¤å¯è§ï¼Œåœ¨å®ç°<code>bind()</code>æ–¹æ³•çš„æ—¶å€™ï¼Œé™¤äº†è€ƒè™‘ä¸€èˆ¬çš„å‡½æ•°è°ƒç”¨ä»¥å¤–ï¼Œè¿˜å¾—è€ƒè™‘å…¶ç»“åˆ<code>new</code>å…³é”®å­—ä½¿ç”¨æ—¶çš„æ„é€ å‡½æ•°çš„ç‰¹æ€§ã€‚å› æ­¤ä»¥æˆ‘åœ¨ç¬¬ä¸€æ¬¡çœ‹è¿™æœ¬ä¹¦æ—¶çš„è®¤çŸ¥ï¼Œçœ‹ä¸æ˜ç™½ä¹Ÿå°±ä¸å¥‡æ€ªäº†ï¼Œåš¯åš¯ã€‚ã€‚  </p>
<p>é‚£å°±æ¥ç»§ç»­è§£æœ€å¼€å§‹çš„é‚£ä¸‰ä¸ªåœˆä½çš„è¿·æƒ‘ï¼š</p>
<ul>
<li>â‘  <code>var nop = function () {}</code> ï¼šè¿™å¹¶æ˜¯ä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼ŒæŠŠå®ƒç”¨ä½œè¿”å›çš„<code>bound</code>å‡½æ•°çš„åŸå‹ï¼Œä»¥ä¾¿äºä»£ç ä¸­åš<code>instanceof</code>åˆ¤æ–­ã€‚</li>
<li>â‘¡ é‰´äºå‰é¢çš„è§£é‡Šï¼Œè¿™é‡Œåš<code>instanceof</code>åˆ¤æ–­å°±æ— å¯åšéäº†ã€‚</li>
<li>â‘¢ å…ˆè®¾ç½®ä¸´æ—¶æ„é€ å‡½æ•°çš„åŸå‹ä¸ºè°ƒç”¨<code>bind()</code>æ–¹æ³•æ—¶çš„ä¸Šä¸‹æ–‡å¯¹è±¡çš„åŸå‹ï¼Œå³ç›®æ ‡å‡½æ•°çš„åŸå‹ã€‚ç„¶åå°†ä¸´æ—¶æ„é€ å‡½æ•°çš„ä¸€ä¸ªå®ä¾‹è®¾ç½®ä¸º<code>bound</code>å‡½æ•°çš„åŸå‹ï¼ŒåŸå‹å°±é“¾èµ·æ¥äº†ã€‚è¿™æ ·ï¼Œåœ¨å¯¹bindåçš„å‡½æ•°è¿›è¡Œ<code>new</code>å…³é”®å­—æ“ä½œçš„æ—¶å€™ï¼Œå°±å¯ä»¥è·å¾—åŸç›®æ ‡å‡½æ•°çš„ç‰¹æ€§äº†ã€‚</li>
</ul>
<blockquote>
<p>å…³äºç»§æ‰¿å’ŒåŸå‹ï¼Œå¯ä»¥å‚è§æˆ‘çš„å‰å‡ ç¯‡<a href="http://heroicyang.com/2013/06/07/javascript-class-inherit-optimized/" target="_blank" rel="external">æ–‡ç« </a>ã€‚</p>
</blockquote>
<p>æœ€åï¼Œå†è¡¥ä¸€ä¸ªä¾‹å­å§ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Person = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;;</span><br><span class="line">Person.prototype.printName = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> obj = &#123; name: <span class="string">'test'</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> PersonA = Person.bind(obj, <span class="string">'heroic'</span>)</span><br><span class="line">  , PersonB = Person.bind1(obj, <span class="string">'heroic'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> PersonA()</span><br><span class="line">  , p2 = <span class="keyword">new</span> PersonB();</span><br><span class="line"></span><br><span class="line">p1.printName();  <span class="comment">// 'heroic'</span></span><br><span class="line">p2.printName();  <span class="comment">// TypeError: Object [object Object] has no method 'printName'</span></span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>å»å¹´åº•å°±è‰è‰äº†äº†çš„ç¿»è¿‡<a href="http://book.douban.com/subject/10733304/" target="_blank">ã€ŠJavaScript Web Applicationã€‹</a>è¿™æœ¬ä¹¦ï¼Œå½“æ—¶å°±é‡åˆ°å¥½å‡ ä¸ªåœ°æ–¹æ²¡æ€ä¹ˆçœ‹æ˜ç™½ï¼Œå½“æ—¶ä¹Ÿæ²¡æœ‰å»æ·±ç©¶ï¼Œå°±åªæ˜¯ç®€å•çš„è¿‡ä¸€éè¿™æœ¬ä¹¦ã€‚ç”±äºæ­¤å‰JavaScriptæ–¹é¢çš„çŸ¥è¯†åŒ®ä¹ï¼Œæ‰€ä»¥æŠŠè¿™æœ¬ä¹¦å°±ç¼“åœ¨é˜…è¯»é˜Ÿåˆ—é‡Œäº†ï¼Œæœ€è¿‘æ‰è½®åˆ°ã€‚å…¶é—´è¯»äº†å¥½å‡ æœ¬åŸºç¡€å’Œè¿›é˜¶çš„ä¹¦ï¼Œæ‰€ä»¥è¿™æ¬¡è¯»è¿™æœ¬ä¹¦ï¼Œå¾ˆå¤šä¹‹å‰ä¸æ˜ç™½çš„åœ°æ–¹å°±è±ç„¶æ˜äº†äº†ã€‚ä¸è¿‡å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œæ²¡å‡†ä¸‹æ¬¡å¿˜è®°äº†å‘¢ã€‚  </p>
<p>è®°å¾—æ­¤å‰ä¹¦ä¸­å¯¹ES5 <code>bind()</code>æ–¹æ³•çš„å®ç°å°±æ˜¯ä¸€ä¸ªè®©æˆ‘æ„Ÿåˆ°è¿·ç³Šçš„åœ°æ–¹ï¼ˆä¸­æ–‡ç‰ˆP16ï¼‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="built_in">Function</span>.prototype.bind) &#123;</span><br><span class="line">  <span class="built_in">Function</span>.prototype.bind = <span class="function"><span class="keyword">function</span> <span class="params">(context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> slice = [].slice</span><br><span class="line">      , args = slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>)</span><br><span class="line">      , self = <span class="keyword">this</span></span><br><span class="line">      , nop = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;&#125;  <span class="comment">// â‘  `nop`ï¼ˆå‡½æ•°ï¼‰çš„ä½œç”¨ï¼Ÿ</span></span><br><span class="line">      , bound = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="comment">// â‘¡ ä¸ºä»€ä¹ˆè¦åš`instanceof`åˆ¤æ–­ï¼Ÿ</span></span><br><span class="line">          <span class="keyword">return</span> self.apply(<span class="keyword">this</span> <span class="keyword">instanceof</span> nop ? <span class="keyword">this</span> : (context || &#123;&#125;),</span><br><span class="line">                              args.concat(slice.call(<span class="built_in">arguments</span>)));</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// â‘¢ ä¸ºä»€ä¹ˆè¦è®¾ç½®å®ƒä¿©çš„åŸå‹ï¼Ÿ</span></span><br><span class="line">    nop.prototype = self.prototype;</span><br><span class="line">    bound.prototype = <span class="keyword">new</span> nop();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bound;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>bind()</code>ï¼šç”¨æ¥åŠ¨æ€æ”¹å˜å‡½æ•°è°ƒç”¨æ—¶å…¶å†…éƒ¨<code>this</code>å¯¹è±¡çš„å¼•ç”¨ï¼Œä½¿ç›®æ ‡å‡½æ•°åŸºäºæ­£ç¡®çš„ä¸Šä¸‹æ–‡è¿›è¡Œè°ƒç”¨ã€‚jQueryä¸­å®ç°ä¸º<code>$.proxy()</code>æ–¹æ³•ï¼ŒES5åˆ™è‡ªå¸¦äº†ã€‚</p>
</blockquote>
<p>ä¸Šé¢ä»£ç ä¸­â‘  â‘¡ â‘¢éƒ½æ˜¯æˆ‘æ­¤å‰ä¸æ˜ç™½çš„åœ°æ–¹ï¼Œä¸è¿‡åœ¨è¿™æ¬¡é˜…è¯»çš„è¿‡ç¨‹ä¸­ï¼Œå°±è±ç„¶å¼€æœ—äº†ã€‚</p>]]>
    
    </summary>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Mongodbä¸­éšæœºçš„æŸ¥è¯¢æ–‡æ¡£è®°å½•]]></title>
    <link href="http://heroicyang.com/2013/06/20/random-record-in-mongodb/"/>
    <id>http://heroicyang.com/2013/06/20/random-record-in-mongodb/</id>
    <published>2013-06-20T13:59:46.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>åœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­ï¼Œå‡ ä¹éƒ½ä¼šæœ‰éšæœºè·å–æ•°æ®è®°å½•çš„éœ€æ±‚ã€‚è€Œè¿™ä¸ªéœ€æ±‚åœ¨Mongodbå´ä¸æ˜¯å¾ˆå¥½å®ç°ï¼Œå°±ç›®å‰è€Œè¨€ï¼Œå¤§è‡´ä¸Šæœ‰ä¸‰ç§è§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li>å…ˆè®¡ç®—å‡ºä¸€ä¸ªä»<code>0</code>åˆ°è®°å½•æ€»æ•°ä¹‹é—´çš„éšæœºæ•°ï¼Œç„¶åé‡‡ç”¨<code>skip(yourRandomNumber)</code>æ–¹æ³•ã€‚</li>
<li>ä¸ºæ¯ä¸€æ¡è®°å½•å¢è®¾<code>random</code>å­—æ®µï¼Œæ’å…¥æ•°æ®æ—¶èµ‹å€¼ä¸º<code>Math.random()</code>ï¼ŒæŸ¥è¯¢æ—¶é‡‡ç”¨<code>$gte</code>å’Œ<code>$lte</code>ã€‚</li>
<li>å€ŸåŠ©Mongodbå¯¹åœ°ç†ç©ºé—´ç´¢å¼•ï¼ˆ<code>geospatial indexes</code>ï¼‰çš„æ”¯æŒï¼Œä»è€Œå¯ä»¥åœ¨ç¬¬äºŒç§æ–¹æ³•çš„åŸºç¡€ä¸Šæ¥å®ç°éšæœºè®°å½•çš„è·å–ã€‚</li>
</ol>
<p>å› ä¸ºMongodbæ˜¯ä¸å»ºè®®ä½¿ç”¨<code>skip</code>æ–¹æ³•çš„ï¼Œæ‰€ä»¥è¿™é‡Œå°±ç•¥å»ç¬¬ä¸€ç§æ–¹æ³•å§ã€‚</p>
<h3 id="æ–¹æ³•äºŒ">æ–¹æ³•äºŒ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.twitter.save(&#123; username: <span class="string">'heroic'</span>, random: <span class="built_in">Math</span>.random(), content: <span class="string">'balabala0...'</span> &#125;)</span><br><span class="line">&gt; db.twitter.save(&#123; username: <span class="string">'heroic'</span>, random: <span class="built_in">Math</span>.random(), content: <span class="string">'balabala1...'</span> &#125;)</span><br><span class="line">&gt; db.twitter.save(&#123; username: <span class="string">'heroic'</span>, random: <span class="built_in">Math</span>.random(), content: <span class="string">'balabala2...'</span> &#125;)</span><br><span class="line">&gt; db.twitter.save(&#123; username: <span class="string">'heroic'</span>, random: <span class="built_in">Math</span>.random(), content: <span class="string">'balabala3...'</span> &#125;)</span><br><span class="line">&gt; db.twitter.save(&#123; username: <span class="string">'heroic'</span>, random: <span class="built_in">Math</span>.random(), content: <span class="string">'balabala4...'</span> &#125;)</span><br><span class="line"><span class="comment">/* more records... */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* create index */</span></span><br><span class="line">&gt; db.twitter.ensureIndex(&#123; username: <span class="number">1</span>, random: <span class="number">1</span> &#125;)</span><br><span class="line"></span><br><span class="line">&gt; rand = <span class="built_in">Math</span>.random()</span><br><span class="line">&gt; result = db.twitter.findOne(&#123; username: <span class="string">'heroic'</span>, random: &#123; $gte: rand &#125; &#125;)</span><br><span class="line">&gt; <span class="keyword">if</span> (result == <span class="literal">null</span>) &#123;</span><br><span class="line">&gt;   result = db.twitter.findOne(&#123; username: <span class="string">'heroic'</span>, random: &#123; $lte: rand &#125; &#125;)</span><br><span class="line">&gt; &#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ–¹æ³•ä¸‰">æ–¹æ³•ä¸‰</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.twitter.save(&#123; username: <span class="string">'heroic'</span>, random: [<span class="built_in">Math</span>.random(), <span class="number">0</span>], content: <span class="string">'balabala0...'</span> &#125;)</span><br><span class="line">&gt; db.twitter.save(&#123; username: <span class="string">'heroic'</span>, random: [<span class="built_in">Math</span>.random(), <span class="number">0</span>], content: <span class="string">'balabala1...'</span> &#125;)</span><br><span class="line">&gt; db.twitter.save(&#123; username: <span class="string">'heroic'</span>, random: [<span class="built_in">Math</span>.random(), <span class="number">0</span>], content: <span class="string">'balabala2...'</span> &#125;)</span><br><span class="line">&gt; db.twitter.save(&#123; username: <span class="string">'heroic'</span>, random: [<span class="built_in">Math</span>.random(), <span class="number">0</span>], content: <span class="string">'balabala3...'</span> &#125;)</span><br><span class="line">&gt; db.twitter.save(&#123; username: <span class="string">'heroic'</span>, random: [<span class="built_in">Math</span>.random(), <span class="number">0</span>], content: <span class="string">'balabala4...'</span> &#125;)</span><br><span class="line"><span class="comment">/* more records... */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* create index */</span></span><br><span class="line">&gt; db.twitter.ensureIndex(&#123; username: <span class="number">1</span>, random: <span class="string">'2d'</span> &#125;)</span><br><span class="line"></span><br><span class="line">&gt; result = db.twitter.findOne(&#123; username: <span class="string">'heroic'</span>, random: &#123; $near: [<span class="built_in">Math</span>.random(), <span class="number">0</span>] &#125; &#125;)</span><br></pre></td></tr></table></figure>
<p>æ›´å¤šå…³äºMongodbåœ°ç†ç©ºé—´ç´¢å¼•èµ„æ–™ï¼Œè¯·å‚è§<a href="http://docs.mongodb.org/manual/core/2d/" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<p>ç›®å‰è¿™å‡ ç§æ–¹æ¡ˆä¼¼ä¹éƒ½ä¸æ˜¯å¾ˆç†æƒ³ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰å…¶ä»–åŠæ³•äº†ï¼Œæ‰€ä»¥å¹¿å¤§ç¨‹åºå‘˜ä»¬å°±ç›¸çº¦åˆ°Mongodbçš„å®˜æ–¹jiraæäº†ç›¸åº”çš„éœ€æ±‚ï¼Œä½†æ˜¯ç›®å‰ä»ç„¶æ²¡æœ‰ä»»ä½•çš„å“åº”ã€‚å¯ä»¥å‚è§<a href="https://jira.mongodb.org/browse/SERVER-533" target="_blank" rel="external">è¿™é‡Œ</a>ï¼Œå›´è§‚ä¸€ä¸‹ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>åœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­ï¼Œå‡ ä¹éƒ½ä¼šæœ‰éšæœºè·å–æ•°æ®è®°å½•çš„éœ€æ±‚ã€‚è€Œè¿™ä¸ªéœ€æ±‚åœ¨Mongodbå´ä¸æ˜¯å¾ˆå¥½å®ç°ï¼Œå°±ç›®å‰è€Œè¨€ï¼Œå¤§è‡´ä¸Šæœ‰ä¸‰ç§è§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li>å…ˆè®¡ç®—å‡ºä¸€ä¸ªä»<code>0</code>åˆ°è®°å½•æ€»æ•°ä¹‹é—´çš„éšæœºæ•°ï¼Œç„¶åé‡‡ç”¨<code>skip(yourRandomN]]>
    </summary>
    
      <category term="mongodb" scheme="http://heroicyang.com/tags/mongodb/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å…³äºJavaScriptä¸­çš„ç»§æ‰¿ï¼ˆä¸‰ï¼‰ï¼šå†è°ˆç±»å¼ç»§æ‰¿]]></title>
    <link href="http://heroicyang.com/2013/06/07/javascript-class-inherit-optimized/"/>
    <id>http://heroicyang.com/2013/06/07/javascript-class-inherit-optimized/</id>
    <published>2013-06-07T14:23:30.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>åœ¨<a href="/2013/05/30/learn-javascript-inherit-class/">ã€Šå…³äºJavaScriptä¸­çš„ç»§æ‰¿ï¼ˆä¸€ï¼‰ï¼šç±»å¼ç»§æ‰¿ã€‹</a>ä¸­å·²ç»åŸºæœ¬ä¸Šå®ç°äº†ç±»å¼ç»§æ‰¿ï¼Œä½†ä»ç„¶è¿˜å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæ¥ä¸‹æ¥å¯¹ä¹‹å‰çš„å®ç°è¿›ä¸€æ­¥è¿›è¡Œå®Œå–„ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Parent = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name || <span class="string">'heroic'</span>;</span><br><span class="line">&#125;;</span><br><span class="line">Parent.prototype.print = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'name: '</span>, <span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> parent = <span class="keyword">new</span> Parent();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Child = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;</span><br><span class="line">  Parent.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;;</span><br><span class="line">Child.prototype = parent;</span><br><span class="line">Child.prototype.setChildAge = <span class="function"><span class="keyword">function</span> <span class="params">(age)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">parent.setChildAge(<span class="number">10</span>);</span><br><span class="line"><span class="built_in">console</span>.log(parent.age);  <span class="comment">// 10</span></span><br></pre></td></tr></table></figure>
<p>æ­£å¦‚ä»£ç æ‰€è§ï¼Œåœ¨ä¸ºå­å¯¹è±¡åŸå‹æ·»åŠ è‡ªå·±ç‹¬æœ‰æ–¹æ³•çš„æ—¶å€™ï¼Œçˆ¶å¯¹è±¡ä¹Ÿå—åˆ°äº†å½±å“ï¼Œè¿™å¯ä¸æ˜¯æœŸæœ›çš„ç»“æœã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> Child(<span class="string">'child'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(child.name);  <span class="comment">// 'child'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> child.name;</span><br><span class="line"><span class="built_in">console</span>.log(child.name);  <span class="comment">// 'heroic'</span></span><br></pre></td></tr></table></figure>
<p>åŒæ ·å¦‚ä»£ç æ‰€ç¤ºï¼Œ<code>child</code>å¯¹è±¡æŒæœ‰äº†ä¸¤ä¸ª<code>name</code>å±æ€§ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡æ„é€ å‡½æ•°æ‹·è´çš„ï¼Œå¦ä¸€ä¸ªæ˜¯åŸå‹é“¾ä¸Šçš„ï¼Œå½“åˆ é™¤æ‰æœ¬èº«çš„<code>name</code>å±æ€§åï¼Œä¾¿è®¿é—®åˆ°äº†åŸå‹é“¾ä¸Šçš„äº†ã€‚å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆå¾ˆç®€å•ç›´æ¥ï¼š  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ... */</span></span><br><span class="line">Child.prototype = Parent.prototype;  <span class="comment">// åªç»§æ‰¿çˆ¶å¯¹è±¡åŸå‹é“¾ä¸Šçš„å±æ€§</span></span><br><span class="line"><span class="comment">/* ... */</span></span><br><span class="line"><span class="keyword">delete</span> child.name;</span><br><span class="line"><span class="built_in">console</span>.log(child.name);  <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™ç§æ–¹æ³•ä¹Ÿå¹¶æ²¡æœ‰è§£å†³æœ€å¼€å§‹çš„é‚£ä¸ªé—®é¢˜ï¼Œå³æ·»åŠ æˆ–åˆ é™¤å­å¯¹è±¡åŸå‹ä¸Šçš„å±æ€§æ—¶ï¼Œä¼šä¸€å¹¶åæ˜ åˆ°çˆ¶å¯¹è±¡ä¸­ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°<a href="/2013/06/02/learn-javascript-inherit-proto/">ã€Šå…³äºJavaScriptä¸­çš„ç»§æ‰¿ï¼ˆäºŒï¼‰ï¼šåŸå‹å¼ç»§æ‰¿ã€‹</a>ä¸­ç”¨åˆ°çš„ä¸´æ—¶æ„é€ å‡½æ•°äº†ã€‚  </p>
<a id="more"></a>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> inherit = <span class="function"><span class="keyword">function</span> <span class="params">(subClass, superClass)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">  F.prototype = superClass.prototype;</span><br><span class="line">  subClass.prototype = <span class="keyword">new</span> F;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç„¶åå°† `Child.prototype = Parent.prototype` è°ƒæ•´ä¸º</span></span><br><span class="line">inherit(Child, Parent);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¢åŠ `Child`è‡ªå·±çš„æ–¹æ³•ä¹‹å</span></span><br><span class="line">Child.prototype.setChildAge = <span class="function"><span class="keyword">function</span> <span class="params">(age)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">parent.setChildAge(<span class="number">10</span>);  <span class="comment">// TypeError: Object [object Object] has no method 'setChildAge'</span></span><br></pre></td></tr></table></figure>
<p>ä¸å†å½±å“çˆ¶å¯¹è±¡çš„è¡Œä¸ºäº†ï¼Œè€Œä¸”è¿˜å¯ä»¥ä¸º<code>inherit</code>æ–¹æ³•å¢åŠ å­å¯¹è±¡è®¿é—®çˆ¶å¯¹è±¡è¡Œä¸ºçš„ç‰¹æ€§ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> inherit = <span class="function"><span class="keyword">function</span> <span class="params">(subClass, superClass)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">  F.prototype = superClass.prototype;</span><br><span class="line">  subClass.prototype = <span class="keyword">new</span> F;</span><br><span class="line">  subClass.prototype._super = superClass.prototype;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç„¶åé‡å†™äº†å­å¯¹è±¡çš„`print()`æ–¹æ³•ï¼Œä½†ä¾ç„¶è¿˜æ˜¯æƒ³é‡ç”¨çˆ¶å¯¹è±¡çš„</span></span><br><span class="line">Child.prototype.print = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'before print...balabala...'</span>);</span><br><span class="line">  <span class="keyword">this</span>._super.print.call(<span class="keyword">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> Child(<span class="string">'child'</span>);</span><br><span class="line">child.print();  <span class="comment">// 'before print...balabala...'</span></span><br><span class="line">                <span class="comment">// 'name:  child'</span></span><br></pre></td></tr></table></figure>
<p>æœ€åï¼Œå¦‚æœè¯´è¿™ä¸ªç±»å¼ç»§æ‰¿æ¨¡å¼è¿˜æœ‰å“ªç‚¹ä¸å¤Ÿå®Œç¾çš„è¯ï¼Œé‚£å°±æ˜¯åœ¨å­å¯¹è±¡ç»§æ‰¿çˆ¶å¯¹è±¡ä¹‹åï¼Œå­å¯¹è±¡çš„æ„é€ å‡½æ•°æŒ‡å‘è¢«æ”¹å†™äº†ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(child.constructor === Parent);  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>æ²¡åŠæ³•ï¼Œåªæœ‰åœ¨ç»§æ‰¿çš„æœ€åï¼ŒæŠŠ<code>constructor</code>ä¿®æ­£å›æ¥å°±æ˜¯ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> inherit = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(subClass, superClass)</span> </span>&#123;</span><br><span class="line">    F.prototype = superClass.prototype;</span><br><span class="line">    subClass.prototype = <span class="keyword">new</span> F;</span><br><span class="line">    subClass.prototype._super = superClass.prototype;</span><br><span class="line">    subClass.prototype.constructor = subClass;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ... */</span></span><br><span class="line"><span class="built_in">console</span>.log(child.constructor === Child);  <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(child.constructor === Parent);  <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>åŒæ—¶ï¼Œä¹Ÿå¦‚<a href="/2013/06/02/learn-javascript-inherit-proto/">ã€Šå…³äºJavaScriptä¸­çš„ç»§æ‰¿ï¼ˆäºŒï¼‰ï¼šåŸå‹å¼ç»§æ‰¿ã€‹</a>ä¸­æåˆ°çš„é‚£æ ·ï¼Œåˆ©ç”¨é—­åŒ…æ¥å‡å°‘æ¯æ¬¡è°ƒç”¨<code>inherit()</code>éƒ½ä¼šç”Ÿæˆä¸€ä¸ªä¸´æ—¶æ„é€ å‡½æ•°çš„å¼€é”€ã€‚  </p>
<p>å†™åœ¨æœ€åï¼Œç±»å¼ç»§æ‰¿ä¸ºæˆ‘ä»¬å¸¦æ¥äº†JavaScriptä¸­ä¸å­˜åœ¨çš„å®Œæ•´çš„ç±»çš„æ¦‚å¿µï¼Œè¿™å¯¹äºä»é¢å‘å¯¹è±¡è¯­è¨€è½¬è¿‡æ¥çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œå¯èƒ½æ˜¯å¾ˆå¥½çš„æ–¹å¼ã€‚ä½†æ˜¯å®ƒä¹Ÿæœ‰å¯èƒ½è®©æˆ‘ä»¬å¿½ç•¥äº†JavaScriptçœŸæ­£çš„åŸå‹å¼ç»§æ‰¿ã€‚ä¸è¿‡è¿™äº›æ¨¡å¼éƒ½æ²¡æœ‰å¥½ä¸åä¹‹åˆ†ï¼Œåº”è¯¥åœ¨é€‚åˆçš„åœºæ™¯ä½¿ç”¨åˆé€‚çš„æ–¹æ³•æ‰æ˜¯ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>åœ¨<a href="/2013/05/30/learn-javascript-inherit-class/">ã€Šå…³äºJavaScriptä¸­çš„ç»§æ‰¿ï¼ˆä¸€ï¼‰ï¼šç±»å¼ç»§æ‰¿ã€‹</a>ä¸­å·²ç»åŸºæœ¬ä¸Šå®ç°äº†ç±»å¼ç»§æ‰¿ï¼Œä½†ä»ç„¶è¿˜å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæ¥ä¸‹æ¥å¯¹ä¹‹å‰çš„å®ç°è¿›ä¸€æ­¥è¿›è¡Œå®Œå–„ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Parent = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name || <span class="string">'heroic'</span>;</span><br><span class="line">&#125;;</span><br><span class="line">Parent.prototype.print = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'name: '</span>, <span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> parent = <span class="keyword">new</span> Parent();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Child = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;</span><br><span class="line">  Parent.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;;</span><br><span class="line">Child.prototype = parent;</span><br><span class="line">Child.prototype.setChildAge = <span class="function"><span class="keyword">function</span> <span class="params">(age)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">parent.setChildAge(<span class="number">10</span>);</span><br><span class="line"><span class="built_in">console</span>.log(parent.age);  <span class="comment">// 10</span></span><br></pre></td></tr></table></figure>
<p>æ­£å¦‚ä»£ç æ‰€è§ï¼Œåœ¨ä¸ºå­å¯¹è±¡åŸå‹æ·»åŠ è‡ªå·±ç‹¬æœ‰æ–¹æ³•çš„æ—¶å€™ï¼Œçˆ¶å¯¹è±¡ä¹Ÿå—åˆ°äº†å½±å“ï¼Œè¿™å¯ä¸æ˜¯æœŸæœ›çš„ç»“æœã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> Child(<span class="string">'child'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(child.name);  <span class="comment">// 'child'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> child.name;</span><br><span class="line"><span class="built_in">console</span>.log(child.name);  <span class="comment">// 'heroic'</span></span><br></pre></td></tr></table></figure>
<p>åŒæ ·å¦‚ä»£ç æ‰€ç¤ºï¼Œ<code>child</code>å¯¹è±¡æŒæœ‰äº†ä¸¤ä¸ª<code>name</code>å±æ€§ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡æ„é€ å‡½æ•°æ‹·è´çš„ï¼Œå¦ä¸€ä¸ªæ˜¯åŸå‹é“¾ä¸Šçš„ï¼Œå½“åˆ é™¤æ‰æœ¬èº«çš„<code>name</code>å±æ€§åï¼Œä¾¿è®¿é—®åˆ°äº†åŸå‹é“¾ä¸Šçš„äº†ã€‚å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆå¾ˆç®€å•ç›´æ¥ï¼š  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ... */</span></span><br><span class="line">Child.prototype = Parent.prototype;  <span class="comment">// åªç»§æ‰¿çˆ¶å¯¹è±¡åŸå‹é“¾ä¸Šçš„å±æ€§</span></span><br><span class="line"><span class="comment">/* ... */</span></span><br><span class="line"><span class="keyword">delete</span> child.name;</span><br><span class="line"><span class="built_in">console</span>.log(child.name);  <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™ç§æ–¹æ³•ä¹Ÿå¹¶æ²¡æœ‰è§£å†³æœ€å¼€å§‹çš„é‚£ä¸ªé—®é¢˜ï¼Œå³æ·»åŠ æˆ–åˆ é™¤å­å¯¹è±¡åŸå‹ä¸Šçš„å±æ€§æ—¶ï¼Œä¼šä¸€å¹¶åæ˜ åˆ°çˆ¶å¯¹è±¡ä¸­ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°<a href="/2013/06/02/learn-javascript-inherit-proto/">ã€Šå…³äºJavaScriptä¸­çš„ç»§æ‰¿ï¼ˆäºŒï¼‰ï¼šåŸå‹å¼ç»§æ‰¿ã€‹</a>ä¸­ç”¨åˆ°çš„ä¸´æ—¶æ„é€ å‡½æ•°äº†ã€‚  </p>]]>
    
    </summary>
    
      <category term="inherit" scheme="http://heroicyang.com/tags/inherit/"/>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å…³äºJavaScriptä¸­çš„ç»§æ‰¿ï¼ˆäºŒï¼‰ï¼šåŸå‹å¼ç»§æ‰¿]]></title>
    <link href="http://heroicyang.com/2013/06/02/learn-javascript-inherit-proto/"/>
    <id>http://heroicyang.com/2013/06/02/learn-javascript-inherit-proto/</id>
    <published>2013-06-02T14:52:19.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>JavaScriptä¸­æœ¬æ²¡æœ‰ç±»ï¼Œæ‰€ä»¥å‡¡äº‹ä¹Ÿä¸è¦å¼ºæ±‚ï¼Œå¼ºæ‰­çš„ç“œæ€»æ˜¯ä¸å¡«çš„å˜›ã€‚ç»§æ‰¿ä¹Ÿæ— éå°±æ˜¯ä¸€ä¸ªå¯¹è±¡æ‹¥æœ‰å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„ç‰¹æ€§ï¼Œæ‰€ä»¥å®Œå…¨ä¸éœ€è¦å¤æ‚çš„å»æ¨¡æ‹Ÿé¢å‘å¯¹è±¡ä¸­çš„ç±»å¼ç»§æ‰¿ï¼Œè€Œå€ŸåŠ©JavaScriptç‹¬ç‰¹çš„åŸå‹æœºåˆ¶å°±å¯ä»¥å®ç°äº†ã€‚åŒæ ·ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ä¹Ÿä¸å†é‡‡ç”¨æ¨¡æ‹Ÿ<strong>ç±»-å¯¹è±¡</strong>çš„æ–¹å¼ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨JavaScriptçš„å¯¹è±¡å­—é¢é‡å°±å¥½äº†ã€‚å› ä¸ºå¯¹äºå¯¹è±¡æ¥è¯´æˆ‘ä»¬å…³ç³»çš„æ— éä¹Ÿå°±æ˜¯å®ƒå…·å¤‡å“ªäº›å±æ€§ã€æœ‰å“ªäº›è¡Œä¸ºè€Œå·²ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> parent = &#123;</span><br><span class="line">  printName: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name || <span class="string">'parent'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child = &#123;&#125;;  <span class="comment">// æš‚æ—¶è¿™æ ·</span></span><br><span class="line">child.name = <span class="string">'child'</span>;  <span class="comment">// åœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬å¹¶ä¸å¸Œæœ›ç»§æ‰¿åŸå¯¹è±¡è‡ªå·±çš„å±æ€§ï¼Œè€Œæ˜¯åœ¨æˆ‘ä»¬éœ€è¦æ—¶ï¼Œç›´æ¥æ·»åŠ å°±å¥½</span></span><br><span class="line">child.printName();  <span class="comment">// é‡ç‚¹çš„æ˜¯æˆ‘ä»¬å¸Œæœ›childå…·å¤‡æ‰“å°è‡ªå·±åå­—çš„è¡Œä¸º</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ç›®å‰è¿˜ä¸èƒ½å·¥ä½œï¼Œ<a href="http://heroicyang.com/2013/05/30/learn-javascript-inherit-class/" target="_blank" rel="external">ä¸Šä¸€ç¯‡æ–‡ç« </a>ä¸­è°ˆåˆ°è¿‡JavaScriptä¸­å¯¹è±¡å±æ€§æŸ¥æ‰¾æœºåˆ¶ï¼Œå¦‚æœ<code>child</code>å¯¹è±¡æœ¬èº«æ²¡æœ‰<code>printName()</code>è¿™ä¸ªæ–¹æ³•ï¼Œé‚£æˆ‘ä»¬ä¿è¯å…¶åŸå‹ä¸Šæœ‰è¿™ä¸ªæ–¹æ³•ï¼Œå®ƒå°±èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* var parent... */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> object = <span class="function"><span class="keyword">function</span> <span class="params">(obj)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">  F.prototype = obj;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> F;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ”¹å˜childå¯¹è±¡çš„åˆ›å»ºæ–¹å¼ï¼Œä¸ç›´æ¥é‡‡ç”¨å­—é¢é‡äº†ï¼Œè€Œæ˜¯ç”¨`object`æ–¹æ³•æ¥åˆ›å»º</span></span><br><span class="line"><span class="keyword">var</span> child = object(parent);</span><br><span class="line">child.name = <span class="string">'child'</span>;</span><br><span class="line">child.printName();  <span class="comment">// 'child'</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ä¸€ä¸ª<code>object()</code>å‡½æ•°ï¼Œæˆ‘ä»¬å°±å®Œå…¨å¯ä»¥å®ç°ä¸€ä¸ªå¯¹è±¡ä»å¦ä¸€ä¸ªå¯¹è±¡ç»§æ‰¿äº†ã€‚å…¶åŸç†å¾ˆç®€å•ï¼Œå³åœ¨<code>object()</code>å‡½æ•°å†…éƒ¨åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„æ„é€ å‡½æ•°ï¼Œç„¶åä¿®æ”¹è¿™ä¸ªæ„é€ å‡½æ•°çš„åŸå‹ï¼Œæœ€åå†è¿”å›è¿™ä¸ªæ„é€ å‡½æ•°çš„ä¸€ä¸ªå®ä¾‹ã€‚</p>
<a id="more"></a>
<p>å½“ç„¶ï¼Œ<code>parent</code>å¯¹è±¡ä¹Ÿå¹¶ä¸ä¸€å®šè¦ä½¿ç”¨å¯¹è±¡å­—é¢é‡ï¼Œä½ å¯ä»¥é€‰æ‹©ä»»ä½•ä½ èƒ½æƒ³åˆ°çš„åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ï¼Œå¦‚æ„é€ å‡½æ•°ç­‰ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = <span class="string">'parent'</span>;</span><br><span class="line">&#125;;</span><br><span class="line">Parent.prototype.printName = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> parent = <span class="keyword">new</span> Parent();</span><br><span class="line"><span class="keyword">var</span> child = object(parent);</span><br><span class="line">child.printName();  <span class="comment">// 'parent'</span></span><br></pre></td></tr></table></figure>
<p>æ­£å¦‚å‰é¢æ‰€è¿°ï¼Œæˆ‘ä»¬å¯èƒ½å¹¶ä¸æƒ³ç»§æ‰¿åŸå¯¹è±¡è‡ªå·±çš„å±æ€§ï¼Œå¦‚ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬ä¹Ÿå¹¶ä¸å¸Œæœ›å®ƒæ‰“å°å‡º<code>parent</code>ã€‚  </p>
<p>åŸå‹å¼ç»§æ‰¿çš„è§„åˆ™å°±æ˜¯ï¼šå¯¹è±¡ä»å¯¹è±¡ç»§æ‰¿ï¼Œä¸ç®¡çˆ¶å¯¹è±¡æ˜¯å¦‚ä½•è€Œæ¥ã€‚è€Œ<code>Parent.prototype</code>ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> child = object(Parent.prototype);</span><br><span class="line">child.printName();  <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<p>æ”¹å†™ä¹‹åï¼Œæ‰“å°<code>child</code>è‡ªå·±çš„åå­—æ—¶å¾—åˆ°çš„æ˜¯<code>undefined</code>ï¼Œå› ä¸ºåˆ›å»º<code>child</code>å¯¹è±¡åï¼Œè¿˜æ²¡æœ‰ç»™å®ƒèµ‹äºˆä»»ä½•çš„å±æ€§ï¼Œæ‰€ä»¥è¿™æ°æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚  </p>
<p>è€Œåœ¨<code>ECMAScript 5</code>ä¸­ï¼ŒåŸå‹å¼ç»§æ‰¿å·²ç»æˆä¸ºäº†è¯­è¨€ç‰¹æ€§ï¼Œä¸ºæˆ‘ä»¬å¢åŠ äº†<code>Object.create()</code>æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ä¸ç”¨è‡ªå·±å®ç°ä¸Šé¢çš„<code>object</code>æ–¹æ³•äº†ã€‚è€Œä¸”<code>Object.create()</code>æ–¹æ³•æ›´åŠ å¼ºåŠ²ã€é€‚ç”¨ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> parent = &#123;</span><br><span class="line">  name: <span class="string">'parent'</span>,</span><br><span class="line">  printName: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒä¸ªå‚æ•°æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œè¯¥å¯¹è±¡çš„å±æ€§å°†ä½œä¸º`child`å¯¹è±¡çš„å±æ€§</span></span><br><span class="line"><span class="keyword">var</span> child = <span class="built_in">Object</span>.create(parent, &#123;</span><br><span class="line">  name: &#123; value: <span class="string">'child'</span> &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">child.printName();  <span class="comment">// 'child'</span></span><br></pre></td></tr></table></figure>
<p>æœ€åï¼Œå†è°ˆè°ˆæœ€å¼€å§‹å®ç°çš„<code>object()</code>æ–¹æ³•å§ï¼Œå…¶å®è¿˜å¯ä»¥åšä¸€ç‚¹ç‚¹ç®€å•çš„ä¼˜åŒ–ã€‚é‚£å°±æ˜¯æ¯æ¬¡è°ƒç”¨<code>object()</code>æ–¹æ³•æ—¶éƒ½è¦åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„ä»£ç†æ„é€ å‡½æ•°<code>F</code>ï¼Œè€Œäº‹å®ä¸Šä»…éœ€è¦åˆ›å»ºä¸€æ¬¡å°±è¶³å¤Ÿäº†ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> object = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(obj)</span> </span>&#123;</span><br><span class="line">    F.prototype = obj;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> F;  </span><br><span class="line">  &#125;;</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æŠŠä»£ç†æ„é€ å‡½æ•°æ”¾åˆ°ä¸€ä¸ªç«‹å³æ‰§è¡Œçš„å‡½æ•°ä¸­åˆ›å»ºï¼Œç„¶åè¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªæ–°çš„ã€çœŸæ­£å®ç°ç»§æ‰¿é€»è¾‘çš„å‡½æ•°ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>JavaScriptä¸­æœ¬æ²¡æœ‰ç±»ï¼Œæ‰€ä»¥å‡¡äº‹ä¹Ÿä¸è¦å¼ºæ±‚ï¼Œå¼ºæ‰­çš„ç“œæ€»æ˜¯ä¸å¡«çš„å˜›ã€‚ç»§æ‰¿ä¹Ÿæ— éå°±æ˜¯ä¸€ä¸ªå¯¹è±¡æ‹¥æœ‰å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„ç‰¹æ€§ï¼Œæ‰€ä»¥å®Œå…¨ä¸éœ€è¦å¤æ‚çš„å»æ¨¡æ‹Ÿé¢å‘å¯¹è±¡ä¸­çš„ç±»å¼ç»§æ‰¿ï¼Œè€Œå€ŸåŠ©JavaScriptç‹¬ç‰¹çš„åŸå‹æœºåˆ¶å°±å¯ä»¥å®ç°äº†ã€‚åŒæ ·ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ä¹Ÿä¸å†é‡‡ç”¨æ¨¡æ‹Ÿ<strong>ç±»-å¯¹è±¡</strong>çš„æ–¹å¼ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨JavaScriptçš„å¯¹è±¡å­—é¢é‡å°±å¥½äº†ã€‚å› ä¸ºå¯¹äºå¯¹è±¡æ¥è¯´æˆ‘ä»¬å…³ç³»çš„æ— éä¹Ÿå°±æ˜¯å®ƒå…·å¤‡å“ªäº›å±æ€§ã€æœ‰å“ªäº›è¡Œä¸ºè€Œå·²ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> parent = &#123;</span><br><span class="line">  printName: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name || <span class="string">'parent'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child = &#123;&#125;;  <span class="comment">// æš‚æ—¶è¿™æ ·</span></span><br><span class="line">child.name = <span class="string">'child'</span>;  <span class="comment">// åœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬å¹¶ä¸å¸Œæœ›ç»§æ‰¿åŸå¯¹è±¡è‡ªå·±çš„å±æ€§ï¼Œè€Œæ˜¯åœ¨æˆ‘ä»¬éœ€è¦æ—¶ï¼Œç›´æ¥æ·»åŠ å°±å¥½</span></span><br><span class="line">child.printName();  <span class="comment">// é‡ç‚¹çš„æ˜¯æˆ‘ä»¬å¸Œæœ›childå…·å¤‡æ‰“å°è‡ªå·±åå­—çš„è¡Œä¸º</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ç›®å‰è¿˜ä¸èƒ½å·¥ä½œï¼Œ<a href="http://heroicyang.com/2013/05/30/learn-javascript-inherit-class/">ä¸Šä¸€ç¯‡æ–‡ç« </a>ä¸­è°ˆåˆ°è¿‡JavaScriptä¸­å¯¹è±¡å±æ€§æŸ¥æ‰¾æœºåˆ¶ï¼Œå¦‚æœ<code>child</code>å¯¹è±¡æœ¬èº«æ²¡æœ‰<code>printName()</code>è¿™ä¸ªæ–¹æ³•ï¼Œé‚£æˆ‘ä»¬ä¿è¯å…¶åŸå‹ä¸Šæœ‰è¿™ä¸ªæ–¹æ³•ï¼Œå®ƒå°±èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* var parent... */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> object = <span class="function"><span class="keyword">function</span> <span class="params">(obj)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">  F.prototype = obj;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> F;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ”¹å˜childå¯¹è±¡çš„åˆ›å»ºæ–¹å¼ï¼Œä¸ç›´æ¥é‡‡ç”¨å­—é¢é‡äº†ï¼Œè€Œæ˜¯ç”¨`object`æ–¹æ³•æ¥åˆ›å»º</span></span><br><span class="line"><span class="keyword">var</span> child = object(parent);</span><br><span class="line">child.name = <span class="string">'child'</span>;</span><br><span class="line">child.printName();  <span class="comment">// 'child'</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ä¸€ä¸ª<code>object()</code>å‡½æ•°ï¼Œæˆ‘ä»¬å°±å®Œå…¨å¯ä»¥å®ç°ä¸€ä¸ªå¯¹è±¡ä»å¦ä¸€ä¸ªå¯¹è±¡ç»§æ‰¿äº†ã€‚å…¶åŸç†å¾ˆç®€å•ï¼Œå³åœ¨<code>object()</code>å‡½æ•°å†…éƒ¨åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„æ„é€ å‡½æ•°ï¼Œç„¶åä¿®æ”¹è¿™ä¸ªæ„é€ å‡½æ•°çš„åŸå‹ï¼Œæœ€åå†è¿”å›è¿™ä¸ªæ„é€ å‡½æ•°çš„ä¸€ä¸ªå®ä¾‹ã€‚</p>]]>
    
    </summary>
    
      <category term="inherit" scheme="http://heroicyang.com/tags/inherit/"/>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å…³äºJavaScriptä¸­çš„ç»§æ‰¿ï¼ˆä¸€ï¼‰ï¼šç±»å¼ç»§æ‰¿]]></title>
    <link href="http://heroicyang.com/2013/05/30/learn-javascript-inherit-class/"/>
    <id>http://heroicyang.com/2013/05/30/learn-javascript-inherit-class/</id>
    <published>2013-05-30T14:19:21.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>â€œç»§æ‰¿â€æ˜¯é¢å‘å¯¹è±¡ä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œè¯´å¼€å»æ— éå°±æ˜¯ä»£ç é‡ç”¨çš„ä¸€ç§æ–¹å¼ç½¢äº†ã€‚  </p>
<p>è™½ç„¶JavaScriptå¹¶ä¸æ˜¯ä¸€é—¨çœŸæ­£çš„é¢å‘å¯¹è±¡è¯­è¨€ï¼Œç”šè‡³è¿ç±»çš„æ¦‚å¿µéƒ½æ²¡æœ‰ã€‚ä½†å¾—ç›Šäºæ„é€ å™¨çš„å­˜åœ¨ï¼Œåœ¨JavaScriptä¸­æ˜¯å¯ä»¥å®Œå…¨æ¨¡æ‹Ÿå‡º <strong>ç±»-å¯¹è±¡</strong> è¡Œä¸ºçš„ã€‚å¦‚ï¼š  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person();</span><br></pre></td></tr></table></figure>
<p>çœ‹ä¸Šå»é™¤äº†å˜é‡å£°æ˜æ—¶ä¸æ˜¯å¼ºç±»å‹ä¹‹å¤–ï¼Œå®Œå…¨ä¸é¢å‘å¯¹è±¡å¦‚å‡ºä¸€è¾™ã€‚æ‰€ä»¥è°ˆåŠç»§æ‰¿æ—¶ï¼Œå¤§å®¶é¦–æ¨çš„ä¹Ÿæ˜¯ä¸€ç§å«â€œç±»å¼ç»§æ‰¿â€çš„æ‰‹æ³•äº†ã€‚  </p>
<h3 id="ç±»å¼ç»§æ‰¿ä¹‹åŸºäºåŸå‹é“¾">ç±»å¼ç»§æ‰¿ä¹‹åŸºäºåŸå‹é“¾</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Parent = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name || <span class="string">'heroic'</span>;</span><br><span class="line">&#125;;</span><br><span class="line">Parent.prototype.printName = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> Child = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">inherit(Child, Parent);</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line">Child.inherit(Parent);</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>ä¸Šé¢çš„ä¼ªä»£ç æ˜¯ç±»å¼ç»§æ‰¿çš„ç†æƒ³çŠ¶æ€ï¼Œä½†<code>inherit</code>æ–¹æ³•å¹¶ä¸å­˜åœ¨ï¼Œéœ€è¦ç”±è‡ªå·±å®ç°ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> inherit = <span class="function"><span class="keyword">function</span> <span class="params">(subClass, superClass)</span> </span>&#123;</span><br><span class="line">  subClass.prototype = <span class="keyword">new</span> superClass();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ä¸ºäº†å®ç° Child.inherit(Parent) è¿™æ ·çš„æ•ˆæœ</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.inherit = <span class="function"><span class="keyword">function</span> <span class="params">(superClass)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.prototype = <span class="keyword">new</span> superClass();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å’Œè®¡åˆ’ä¸­çš„ä¸€æ ·ï¼Œå­å¯¹è±¡ä¸ä»…ç»§æ‰¿äº†çˆ¶å¯¹è±¡çš„å±æ€§ï¼Œä¹Ÿç»§æ‰¿äº†çˆ¶å¯¹è±¡åŸå‹ä¸Šçš„æ–¹æ³•ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> Child();</span><br><span class="line">child.name = <span class="string">'test'</span>;</span><br><span class="line">child.printName();  <span class="comment">// 'test'</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™ç§æ–¹å¼å´å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p>
<ol>
<li>å¯¹è±¡å±æ€§çš„å†™æ“ä½œæ˜¯ç›´æ¥å‘ç”Ÿçš„ï¼Œå³å¯¹è±¡å¦‚æœä¸å­˜åœ¨è¿™ä¸ªå±æ€§ï¼Œåˆ™ä¸ºè¯¥å¯¹è±¡åˆ›å»ºè¿™ä¸ªå±æ€§ï¼Œå¹¶ä¸ºå…¶èµ‹å€¼ï¼›å¦‚æœå­˜åœ¨ï¼Œåˆ™ç›´æ¥ä¸ºå…¶èµ‹æ–°å€¼ã€‚è€Œå¯¹äºå¯¹è±¡å±æ€§çš„è¯»æ“ä½œï¼Œåˆ™å®Œå…¨ä¸ä¸€æ ·äº†ï¼šé¦–å…ˆæŸ¥æ‰¾å¯¹è±¡æœ¬èº«æ˜¯å¦æœ‰è¯¥å±æ€§ï¼Œæœ‰åˆ™è¿”å›ï¼Œæ²¡æœ‰åˆ™æŸ¥æ‰¾å…¶åŸå‹é“¾ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å±æ€§ä¸ºæ­¢ï¼Œå¦‚æœåˆ°äº†åŸå‹é“¾çš„æœ€é¡¶å±‚(Object)éƒ½æ²¡æ‰¾åˆ°ï¼Œåˆ™è¿”å›<code>undefined</code>ã€‚ç”±äºå­˜åœ¨è¿™ç§è¯»å†™çš„ä¸å¯¹ç­‰æ€§ï¼Œæˆ‘ä»¬éƒ½ä¸ä¼šé‡‡å–ä»çˆ¶å¯¹è±¡ç»§æ‰¿å±æ€§ï¼Œè€Œæ˜¯ç›´æ¥ä¸ºå­å¯¹è±¡æ·»åŠ å±æ€§å³å¯ï¼Œè€Œéœ€è¦ç»§æ‰¿çš„æ–¹æ³•åˆ™æ”¾åˆ°åŸå‹ä¸Šã€‚</li>
<li>ä¸”ä¸Šé¢çš„å®ç°ä¸­ï¼Œæˆ‘ä»¬æ— æ³•å®Œæˆè¿™æ ·çš„åˆå§‹åŒ–ï¼š<code>var child = new Child(&#39;test&#39;)</code>  </li>
</ol>
<p>åˆ©ç”¨åŸå‹é“¾å®ç°çš„ç±»å¼ç»§æ‰¿å…ˆæ”¾ä¸€è¾¹ï¼Œä¸ºäº†è§£å†³åœ¨åˆå§‹åŒ–å°±èƒ½ä¼ å…¥å‚æ•°çš„é—®é¢˜ï¼Œä¾¿äº§ç”Ÿäº†ä¸€ç§å«â€œå€Ÿç”¨æ„é€ å‡½æ•°â€æ–¹å¼çš„ç»§æ‰¿ã€‚  </p>
<h3 id="ç±»å¼ç»§æ‰¿ä¹‹å€Ÿç”¨æ„é€ å‡½æ•°">ç±»å¼ç»§æ‰¿ä¹‹å€Ÿç”¨æ„é€ å‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Parent = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name || <span class="string">'heroic'</span>;</span><br><span class="line">  <span class="keyword">this</span>.printName = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Child = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;</span><br><span class="line">  Parent.call(<span class="keyword">this</span>, name);</span><br><span class="line">  <span class="comment">// æˆ–è€…åœ¨å¤šå‚æ•°çš„æƒ…å†µä¸‹</span></span><br><span class="line">  <span class="comment">// Parent.apply(this, arguments);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> Child(<span class="string">'test'</span>);</span><br><span class="line">child.printName();  <span class="comment">// 'test'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> parent = <span class="keyword">new</span> Parent();</span><br><span class="line">parent.printName();  <span class="comment">// 'heroic'</span></span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆæ¥è°ˆè°ˆè¿™ç§æœºåˆ¶ç›¸å¯¹äºç¬¬ä¸€ç§çš„ä¼˜ç‚¹ï¼ŒTalk is cheap, Show me the code.  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Parent = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.tags = [<span class="string">'.NETer'</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> parent = <span class="keyword">new</span> Parent();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ChildA = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">ChildA.prototype = parent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ChildB = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  Parent.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child_a = <span class="keyword">new</span> ChildA();</span><br><span class="line">child_a.tags.push(<span class="string">'Javaer'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child_b = <span class="keyword">new</span> ChildB();</span><br><span class="line">child_b.tags.push(<span class="string">'Pythoner'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(child_a.tags.join(<span class="string">', '</span>));  <span class="comment">//.NETer, Javaer</span></span><br><span class="line"><span class="built_in">console</span>.log(child_b.tags.join(<span class="string">', '</span>));  <span class="comment">//.NETer, Pythoner</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(parent.tags.join(<span class="string">', '</span>));  <span class="comment">//.NETer, Javaer</span></span><br><span class="line"><span class="comment">// WTF...Why is my tags contains `Javaer` ?</span></span><br></pre></td></tr></table></figure>
<p>æ˜¾è€Œæ˜“è§ï¼Œå€Ÿç”¨æ„é€ å‡½æ•°æ–¹å¼åœ¨ç»§æ‰¿æ—¶æ˜¯é‡‡å–ä¸€ä»½å•ç‹¬çš„æ‹·è´ï¼Œè€ŒåŸå‹é“¾æ–¹å¼åˆ™æ˜¯æŒ‡å‘åŒä¸€ä¸ªå¼•ç”¨ã€‚ï¼ˆä½†æ˜¯ç”±æ­¤å¯è§ï¼ŒåŸå‹é“¾ä¸Šçš„å±æ€§æˆ–æ–¹æ³•ä¸ä¼šåœ¨æ¯ä¸ªå®ä¾‹ä¸­éƒ½åˆ›å»ºä¸€æ¬¡ã€‚ï¼‰  </p>
<p>æ¥ä¸‹æ¥åˆ™æ˜¯è°ˆè°ˆç¼ºé™·äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Parent = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line">Parent.prototype.papapa = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'pa pa pa...'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Child = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  Parent.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> Child();</span><br><span class="line">child.papapa();  <span class="comment">// TypeError: Object [object Object] has no method 'papapa'</span></span><br><span class="line"><span class="comment">// Yeah, you're too young, so...</span></span><br></pre></td></tr></table></figure>
<p>å€Ÿç”¨æ„é€ å‡½æ•°å…¶å®æ˜¯åœ¨æ„é€ æ—¶ï¼Œé€šè¿‡æ”¹å†™æ–¹æ³•è°ƒç”¨ä¸Šä¸‹æ–‡æ¥å®ç°å±æ€§çš„æ‹·è´ï¼Œæ‰€ä»¥å¹¶æœªæ¶‰åŠåˆ°<code>prototype</code>ï¼Œæ‰€ä»¥å°±æ²¡æœ‰åŠæ³•ç»§æ‰¿åŸå‹äº†ã€‚  </p>
<p>ç”±äºåŸå‹é“¾ä¸Šçš„å±æ€§æˆ–æ–¹æ³•ä¸ä¼šåœ¨æ¯ä¸ªå®ä¾‹ä¸­éƒ½åˆ›å»ºä¸€æ¬¡ï¼Œæ‰€ä»¥æ˜¯æˆ‘ä»¬æ”¾ç½®éœ€è¦é‡ç”¨çš„å±æ€§å’Œæ–¹æ³•çš„ç†æƒ³åœ°æ–¹ï¼›è€Œå€Ÿç”¨æ„é€ å‡½æ•°åˆ™å¯ä»¥ä½¿å­å¯¹è±¡æ‹¥æœ‰è‡ªå·±ä¸€ä»½ç‹¬ç«‹çš„æ‹·è´ï¼Œä¸å­˜åœ¨æ„å¤–æ”¹å†™çˆ¶å¯¹è±¡å±æ€§çš„é£é™©ã€‚æ‰€ä»¥ä¸¤è€…äº’è¡¥äº§ç”Ÿäº†ç¬¬ä¸‰ç§æ¯”è¾ƒå®Œç¾çš„ç»§æ‰¿æ–¹å¼ã€‚  </p>
<h3 id="ç±»å¼ç»§æ‰¿ä¹‹ç»„åˆæ¨¡å¼">ç±»å¼ç»§æ‰¿ä¹‹ç»„åˆæ¨¡å¼</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Parent = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name || <span class="string">'heroic'</span>;</span><br><span class="line">  <span class="keyword">this</span>.tags = [<span class="string">'coder'</span>];</span><br><span class="line">&#125;;</span><br><span class="line">Parent.prototype.print = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'name: '</span>, <span class="keyword">this</span>.name, <span class="string">', tags: '</span>, <span class="keyword">this</span>.tags.join(<span class="string">', '</span>));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> parent = <span class="keyword">new</span> Parent();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Child = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;</span><br><span class="line">  Parent.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;;</span><br><span class="line">Child.prototype = parent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> Child(<span class="string">'test'</span>);</span><br><span class="line">child.tags.push(<span class="string">'player'</span>);</span><br><span class="line"></span><br><span class="line">child.print();  <span class="comment">// name:  test , tags:  coder, player</span></span><br><span class="line">parent.print();  <span class="comment">// name:  heroic , tags:  coder</span></span><br></pre></td></tr></table></figure>
<p>è¿‘ä¹å®Œç¾çš„å®ç°ï¼Œå­å¯¹è±¡ç»§æ‰¿äº†çˆ¶å¯¹è±¡çš„æˆå‘˜ï¼Œä½†æ‹¥æœ‰è‡ªå·±çš„ä¸€ä»½æ‹·è´ï¼Œä¸ä¼šæ‹…å¿ƒä¿®æ”¹è‡ªå·±è€Œå½±å“åˆ°çˆ¶å¯¹è±¡ï¼›å­å¯¹è±¡ä¹Ÿå¤ç”¨äº†çˆ¶å¯¹è±¡åŸå‹ä¸­çš„æ–¹æ³•ï¼›ä¸”å­å¯¹è±¡ä¹Ÿå¯ä»¥ä¼ é€’ä»»æ„å‚æ•°ç»™çˆ¶å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚å¯è°“æ˜¯é¢å‘å¯¹è±¡ä¸­â€œç±»å¼ç»§æ‰¿â€çš„å‡†ç¡®è¯ é‡Šã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>â€œç»§æ‰¿â€æ˜¯é¢å‘å¯¹è±¡ä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œè¯´å¼€å»æ— éå°±æ˜¯ä»£ç é‡ç”¨çš„ä¸€ç§æ–¹å¼ç½¢äº†ã€‚  </p>
<p>è™½ç„¶JavaScriptå¹¶ä¸æ˜¯ä¸€é—¨çœŸæ­£çš„é¢å‘å¯¹è±¡è¯­è¨€ï¼Œç”šè‡³è¿ç±»çš„æ¦‚å¿µéƒ½æ²¡æœ‰ã€‚ä½†å¾—ç›Šäºæ„é€ å™¨çš„å­˜åœ¨ï¼Œåœ¨JavaScriptä¸­æ˜¯å¯ä»¥å®Œå…¨æ¨¡æ‹Ÿå‡º <strong>ç±»-å¯¹è±¡</strong> è¡Œä¸ºçš„ã€‚å¦‚ï¼š  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person();</span><br></pre></td></tr></table></figure>
<p>çœ‹ä¸Šå»é™¤äº†å˜é‡å£°æ˜æ—¶ä¸æ˜¯å¼ºç±»å‹ä¹‹å¤–ï¼Œå®Œå…¨ä¸é¢å‘å¯¹è±¡å¦‚å‡ºä¸€è¾™ã€‚æ‰€ä»¥è°ˆåŠç»§æ‰¿æ—¶ï¼Œå¤§å®¶é¦–æ¨çš„ä¹Ÿæ˜¯ä¸€ç§å«â€œç±»å¼ç»§æ‰¿â€çš„æ‰‹æ³•äº†ã€‚  </p>
<h3 id="ç±»å¼ç»§æ‰¿ä¹‹åŸºäºåŸå‹é“¾">ç±»å¼ç»§æ‰¿ä¹‹åŸºäºåŸå‹é“¾</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Parent = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name || <span class="string">'heroic'</span>;</span><br><span class="line">&#125;;</span><br><span class="line">Parent.prototype.printName = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> Child = <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">inherit(Child, Parent);</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line">Child.inherit(Parent);</span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="inherit" scheme="http://heroicyang.com/tags/inherit/"/>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[æŠ˜è…¾äº†ä¸ªæ–°ä¸»é¢˜]]></title>
    <link href="http://heroicyang.com/2013/05/22/hexo-theme-modernist/"/>
    <id>http://heroicyang.com/2013/05/22/hexo-theme-modernist/</id>
    <published>2013-05-22T15:36:51.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>å‰å‡ å¤©å¶ç„¶å‘ç°äº†ä¸€ä¸ªGithub Pageä¸»é¢˜ï¼š<a href="http://orderedlist.github.io/modernist/" target="_blank" rel="external">Modernist</a>ï¼Œè§‰ç€å¾ˆèˆ’æœã€‚ä½œè€…å°†å…¶å¼€æºåœ¨Githubä¸Šçš„ï¼Œæ‰€ä»¥æˆ‘å°±forkä¸‹æ¥è‡ªå·±æŠ˜è…¾äº†ä¸ª<a href="https://github.com/tommy351/hexo" target="_blank" rel="external">Hexo</a>çš„ä¸»é¢˜ã€‚  </p>
<p>æ ¹æ®<a href="https://github.com/tommy351/hexo-theme-light" target="_blank" rel="external">light</a>ä¸»é¢˜çš„ç»“æ„ä¿®æ”¹è€Œæ¥ï¼Œä½†æ˜¯å»æ‰äº†ä¾§è¾¹æ ï¼Œæ”¹æˆä¸€æ ï¼Œæ‰€ä»¥éšä¹‹ä¹Ÿå°±æ²¡æœ‰äº†lightä¸»é¢˜çš„é‚£äº›widgetäº†ã€‚ä¸è¿‡æˆ‘å¢åŠ äº†å›½å†…çš„<a href="http://duoshuo.com/" target="_blank" rel="external">å¤šè¯´è¯„è®ºæ¡†</a>çš„é…ç½®ï¼Œä»¥åŠæ›´å¥½çš„å“åº”å¼æ”¯æŒã€‚  </p>
<p>ä¸»é¢˜å·²ç»æ”¾åˆ°<a href="https://github.com/heroicyang/hexo-theme-modernist" target="_blank" rel="external">Github</a>ä¸Šäº†ï¼Œä¹Ÿå·²å®Œå…¨é€‚ç”¨äºæœ€æ–°ç‰ˆçš„Hexoã€‚<span class="text-lt">ä¸ºäº†æ›´å¥½çš„ä½¿ç”¨è¿™ä¸ªä¸»é¢˜ï¼Œå»ºè®®cloneæˆ‘forkçš„<a href="https://github.com/heroicyang/hexo" target="_blank" rel="external">hexo</a>é¡¹ç›®åˆ°æœ¬åœ°ï¼Œä½¿ç”¨<code>/path/to/hexo/bin/hexo</code>æ¥ä»£æ›¿ä¹‹å‰å®‰è£…çš„å…¨å±€<code>hexo</code>å‘½ä»¤ï¼Œæ–¹æ³•è§ä¸‹é¢ã€‚æˆ‘ä¸»è¦ä¿®æ”¹äº†ä»£ç å—é«˜äº®ï¼ˆhighlightï¼‰ç”Ÿæˆï¼Œä»¥åŠä¿®å¤äº†å§‹ç»ˆä¼šç”ŸæˆRead moreé“¾æ¥çš„BUGï¼Œä¸è¿‡æˆ‘ä¼šå°½å¿«å‘èµ·pull requeståˆ°hexoçš„ã€‚</span>  </p>
<p>å¦å¤–ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å¤šè¯´è¯„è®ºæ¡†ï¼Œå¯ä»¥ä½¿ç”¨æˆ‘çš„è‡ªå®šä¹‰å¤šè¯´è¯„è®ºæ¡†æ ·å¼ï¼Œä¸»è¦ä¿æŒäº†å’ŒModernist themeçš„æ ·å¼ç»Ÿä¸€ã€‚è¯·çŒ›æˆ³<a href="https://gist.github.com/heroicyang/5644407" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>å‰å‡ å¤©å¶ç„¶å‘ç°äº†ä¸€ä¸ªGithub Pageä¸»é¢˜ï¼š<a href="http://orderedlist.github.io/modernist/" target="_blank" rel="external">Modernist</a>ï¼Œè§‰ç€å¾ˆèˆ’æœã€‚ä½œè€…å°†å…¶å¼€æºåœ¨Githu]]>
    </summary>
    
      <category term="hexo" scheme="http://heroicyang.com/tags/hexo/"/>
    
      <category term="modernist" scheme="http://heroicyang.com/tags/modernist/"/>
    
      <category term="theme" scheme="http://heroicyang.com/tags/theme/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ã€‹é˜…è¯»ç¬”è®°]]></title>
    <link href="http://heroicyang.com/2013/03/26/javascript-design-pattern-notes/"/>
    <id>http://heroicyang.com/2013/03/26/javascript-design-pattern-notes/</id>
    <published>2013-03-26T15:42:35.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>æœ€è¿‘æ€»ç®—æ˜¯æŠŠã€ŠJavaScriptè®¾è®¡æ¨¡å¼ã€‹è¿™æœ¬ä¹¦ç»™è®¤è®¤çœŸçœŸå•ƒå®Œäº†ï¼Œå—ç›ŠåŒªæµ…ã€‚è™½ç„¶å·²ç»æ˜¯å‡ å¹´å‰çš„å‡ºç‰ˆç‰©äº†ï¼Œè€Œä¸”ä¹Ÿæ²¡å¾—åœ°æ–¹å¯ä»¥ä¹°åˆ°ï¼Œä½†æ˜¯æˆ‘ä¸ªäººè§‰å¾—è¿™æœ¬ä¹¦æ˜¯JavaScriptç¨‹åºå‘˜å¿…è¯»ä¹¦ç±ä¹‹ä¸€ã€‚å¦‚æœæ²¡æœ‰è¯»è¿‡ï¼Œå»ºè®®ä¸€è¯»ï¼Œç»å¯¹ä¸ä¼šè®©ä½ å¤±æœ›ã€‚  </p>
<p>è€Œå¯èƒ½æœ‰ä¸€äº›åœ°æ–¹çš„ç¿»è¯‘è®©äººä¸€å¼€å§‹æœ‰ç‚¹è¿·ç³Šï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸è¯´çš„â€œå•ä¾‹æ¨¡å¼â€è¢«è¯‘ä¸ºâ€œå•ä½“æ¨¡å¼â€ï¼Œè€Œâ€œmixin classâ€è¢«è¯‘ä¸ºâ€œæºå…ƒç±»â€ã€‚ä½†æ˜¯å¯¹äºæˆ‘è¿™ç§Eæ–‡èƒ½åŠ›å¼±çš„äººæ¥è¯´ï¼Œå®Œå…¨æ²¡æœ‰æŒ‘å‰”çš„åœ°æ–¹ã€‚  </p>
<p>æˆ‘åœ¨è¯»è¿™æœ¬ä¹¦çš„æ—¶å€™ï¼Œé‡‡å–äº†ä¸€äº›é˜…è¯»æ–¹å¼æ¥åŠ æ·±ç†è§£ï¼Œä¸ªäººæ„Ÿè§‰è¿˜è¿‡å¾—å»ï¼Œå°±ç®€å•çš„åˆ†äº«ä¸‹ã€‚æˆ‘æ¯ä¸¤å¤©å®Œæˆä¸€ç« èŠ‚ï¼Œç¬¬ä¸€å¤©é˜…è¯»æ•´ä¸ªç« èŠ‚çš„å†…å®¹ï¼Œè¾¹ç†è§£è¾¹å¯¹ç…§ç€å†™å®ä¾‹ä»£ç ï¼›ä¹‹åè‹¥æ˜¯ä¸€æœ‰æ—¶é—´ï¼Œå¤§è„‘å°±æ¸©ä¹ è¿™æ¬¡çš„å†…å®¹ï¼›ç¬¬äºŒå¤©åˆ™ä¸»åŠ¨å›å¿†å‰ä¸€å¤©æ‰€é˜…è¯»çš„å†…å®¹ï¼Œæ•´ç†ç®€è¦çš„ç¬”è®°çº²è¦ï¼Œå¹¶æŒ‰ç…§ä¸ªäººçš„ç†è§£å’Œç¬”è®°çº²è¦å†å†™ä¸€æ¬¡å®ä¾‹ä»£ç ã€‚  </p>
<p>å› æ­¤è¿™æœ¬ä¹¦è¯»å®Œä¹‹åï¼Œæˆ‘çš„ç¬”è®°ä¹Ÿå°±éšå³äº§å‡ºäº†ã€‚æˆ‘æ²¡æœ‰é‡‡ç”¨å¾ˆé•¿çš„ç¯‡å¹…è®°å½•ï¼Œè€Œæ˜¯æ€ç»´å¯¼å›¾æ¥æ•´ç†æ¯ä¸€ç« çš„å†…å®¹ï¼Œè¿™æ ·ä¹Ÿæ–¹ä¾¿æ—¥åæ¸©ä¹ ã€‚  </p>
<p>å‘ƒï¼Œå¥½ä¹…ä¹Ÿæ²¡æœ‰å†™åšå®¢äº†ï¼Œæ‰€ä»¥å°†ç¬”è®°ä¹Ÿä¸€å¹¶åˆ†äº«å‡ºæ¥ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶åˆ†äº«è‡ªå·±çš„å­¦ä¹ æ–¹æ³•å’Œç¬”è®°æ–¹æ³•ã€‚<br><a id="more"></a>  </p>
<p><a href="http://cl.ly/3p383r2V1M0Z" target="_blank" rel="external">æˆ‘å°†æ€ç»´å¯¼å›¾å¯¼å‡ºæˆpdfç‰ˆæœ¬äº†ï¼Œéœ€è¦çš„è‡ªå–å§ï¼</a>  </p>
<p>é¡ºä¾¿ä¹Ÿæ”¾å¼ é¢„è§ˆå›¾ï¼Œä¸è¿‡æœ‰ç‚¹å¤§ã€‚</p>
<p><img src="http://img.heroicyang.com/JavaScript-Design-Pattern-Notes.png" alt="ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ã€‹è¯»ä¹¦ç¬”è®°"></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æœ€è¿‘æ€»ç®—æ˜¯æŠŠã€ŠJavaScriptè®¾è®¡æ¨¡å¼ã€‹è¿™æœ¬ä¹¦ç»™è®¤è®¤çœŸçœŸå•ƒå®Œäº†ï¼Œå—ç›ŠåŒªæµ…ã€‚è™½ç„¶å·²ç»æ˜¯å‡ å¹´å‰çš„å‡ºç‰ˆç‰©äº†ï¼Œè€Œä¸”ä¹Ÿæ²¡å¾—åœ°æ–¹å¯ä»¥ä¹°åˆ°ï¼Œä½†æ˜¯æˆ‘ä¸ªäººè§‰å¾—è¿™æœ¬ä¹¦æ˜¯JavaScriptç¨‹åºå‘˜å¿…è¯»ä¹¦ç±ä¹‹ä¸€ã€‚å¦‚æœæ²¡æœ‰è¯»è¿‡ï¼Œå»ºè®®ä¸€è¯»ï¼Œç»å¯¹ä¸ä¼šè®©ä½ å¤±æœ›ã€‚  </p>
<p>è€Œå¯èƒ½æœ‰ä¸€äº›åœ°æ–¹çš„ç¿»è¯‘è®©äººä¸€å¼€å§‹æœ‰ç‚¹è¿·ç³Šï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸è¯´çš„â€œå•ä¾‹æ¨¡å¼â€è¢«è¯‘ä¸ºâ€œå•ä½“æ¨¡å¼â€ï¼Œè€Œâ€œmixin classâ€è¢«è¯‘ä¸ºâ€œæºå…ƒç±»â€ã€‚ä½†æ˜¯å¯¹äºæˆ‘è¿™ç§Eæ–‡èƒ½åŠ›å¼±çš„äººæ¥è¯´ï¼Œå®Œå…¨æ²¡æœ‰æŒ‘å‰”çš„åœ°æ–¹ã€‚  </p>
<p>æˆ‘åœ¨è¯»è¿™æœ¬ä¹¦çš„æ—¶å€™ï¼Œé‡‡å–äº†ä¸€äº›é˜…è¯»æ–¹å¼æ¥åŠ æ·±ç†è§£ï¼Œä¸ªäººæ„Ÿè§‰è¿˜è¿‡å¾—å»ï¼Œå°±ç®€å•çš„åˆ†äº«ä¸‹ã€‚æˆ‘æ¯ä¸¤å¤©å®Œæˆä¸€ç« èŠ‚ï¼Œç¬¬ä¸€å¤©é˜…è¯»æ•´ä¸ªç« èŠ‚çš„å†…å®¹ï¼Œè¾¹ç†è§£è¾¹å¯¹ç…§ç€å†™å®ä¾‹ä»£ç ï¼›ä¹‹åè‹¥æ˜¯ä¸€æœ‰æ—¶é—´ï¼Œå¤§è„‘å°±æ¸©ä¹ è¿™æ¬¡çš„å†…å®¹ï¼›ç¬¬äºŒå¤©åˆ™ä¸»åŠ¨å›å¿†å‰ä¸€å¤©æ‰€é˜…è¯»çš„å†…å®¹ï¼Œæ•´ç†ç®€è¦çš„ç¬”è®°çº²è¦ï¼Œå¹¶æŒ‰ç…§ä¸ªäººçš„ç†è§£å’Œç¬”è®°çº²è¦å†å†™ä¸€æ¬¡å®ä¾‹ä»£ç ã€‚  </p>
<p>å› æ­¤è¿™æœ¬ä¹¦è¯»å®Œä¹‹åï¼Œæˆ‘çš„ç¬”è®°ä¹Ÿå°±éšå³äº§å‡ºäº†ã€‚æˆ‘æ²¡æœ‰é‡‡ç”¨å¾ˆé•¿çš„ç¯‡å¹…è®°å½•ï¼Œè€Œæ˜¯æ€ç»´å¯¼å›¾æ¥æ•´ç†æ¯ä¸€ç« çš„å†…å®¹ï¼Œè¿™æ ·ä¹Ÿæ–¹ä¾¿æ—¥åæ¸©ä¹ ã€‚  </p>
<p>å‘ƒï¼Œå¥½ä¹…ä¹Ÿæ²¡æœ‰å†™åšå®¢äº†ï¼Œæ‰€ä»¥å°†ç¬”è®°ä¹Ÿä¸€å¹¶åˆ†äº«å‡ºæ¥ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶åˆ†äº«è‡ªå·±çš„å­¦ä¹ æ–¹æ³•å’Œç¬”è®°æ–¹æ³•ã€‚<br>]]>
    
    </summary>
    
      <category term="design pattern" scheme="http://heroicyang.com/tags/design-pattern/"/>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JavaScriptå®šæ—¶å™¨ï¼ˆç»­ï¼‰]]></title>
    <link href="http://heroicyang.com/2012/10/14/javascript-timer-and-event-in-depth/"/>
    <id>http://heroicyang.com/2012/10/14/javascript-timer-and-event-in-depth/</id>
    <published>2012-10-14T14:50:00.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>å¯¹äºæµè§ˆå™¨ç«¯æ¥è¯´ï¼Œå¤§å¤šæ•°äº‹ä»¶éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œä½†æ˜¯æœ‰éƒ¨åˆ†äº‹ä»¶å´ä¸æ˜¯ï¼Œè¿™éƒ¨åˆ†äº‹ä»¶ç§°åš<strong>åŒæ­¥äº‹ä»¶</strong>ï¼Œå› æ­¤å®ƒä»¬éƒ½æ˜¯ç«‹å³æ‰§è¡Œçš„ï¼Œå®Œå…¨ä¸ç†ä¼šå‰å‡ ç¯‡æ–‡ç« ä¸­æ‰€æåˆ°çš„<strong>äº‹ä»¶é˜Ÿåˆ—</strong>ã€‚ä»¥åŠæµè§ˆå™¨çš„æ¸²æŸ“ã€é‡ç»˜ç­‰æ“ä½œï¼Œä¹Ÿä¼šæ‰“ä¹±ä¹‹å‰æˆ‘ä»¬å¥½ä¸å®¹æ˜“æ‰€å»ºç«‹èµ·æ¥çš„<strong>äº‹ä»¶é˜Ÿåˆ—</strong>çš„æ¦‚å¿µã€‚ä¸è¿‡ï¼Œæœ¬ç¯‡å°†ä¼šé™†ç»­ä¸æ–­çš„æŠŠè¿™äº›å‘ç»™å¡«ä¸Šã€‚  </p>
<h2 id="åŒæ­¥äº‹ä»¶">åŒæ­¥äº‹ä»¶</h2><h3 id="DOMæ”¹å˜äº‹ä»¶(DOM_Mutation_events)">DOMæ”¹å˜äº‹ä»¶(DOM Mutation events)</h3><p>ä¸‹é¢çš„Demoä¾¿ç”¨äºè¯´æ˜åŒæ­¥äº‹ä»¶ä¹‹ä¸€çš„<code>DOM Mutation events</code>ï¼ˆæ³¨ï¼šè¯¥äº‹ä»¶ä¸æ”¯æŒChromeæµè§ˆå™¨ï¼‰ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"http://heroicyang.com/"</span>&gt;</span></span><br><span class="line">  heroicyang.com</span><br><span class="line"><span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="pf"></span><br><span class="line">  var <span class="built_in">anchor</span> = document.getElementsByTagName('a')[<span class="number">0</span>];</span><br><span class="line">  <span class="built_in">anchor</span>.onclick = function(e) &#123;</span><br><span class="line">    alert('<span class="keyword">in</span> onclick');</span><br><span class="line">    this.<span class="built_in">set</span>Attribute('href', '<span class="comment">#');</span></span><br><span class="line">    alert('<span class="keyword">out</span> onclick');</span><br><span class="line">    return false;</span><br><span class="line">  &#125;;</span><br><span class="line">  if (<span class="built_in">anchor</span>.addEventListener) &#123;  //Firefox, Opera</span><br><span class="line">    <span class="built_in">anchor</span></span><br><span class="line">      .addEventListener('DOMAttrModified', onpropchange, false);</span><br><span class="line">  &#125; else if (<span class="built_in">anchor</span>.attachEvent) &#123;  //IE</span><br><span class="line">    <span class="built_in">anchor</span></span><br><span class="line">      .attachEvent('onpropertychange', onpropchange);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  function onpropchange() &#123;</span><br><span class="line">    alert('onpropchange');</span><br><span class="line">  &#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>å½“<code>click</code>äº‹ä»¶è§¦å‘æ—¶ï¼Œå…¶å¤„ç†çš„é¡ºåºä¾æ¬¡ä¸ºï¼š</p>
<ol>
<li>alert <code>in onclick</code>  </li>
<li>è¶…é“¾æ¥çš„å±æ€§ç«‹å³è¢«æ”¹å˜ï¼Œå¹¶alert <code>onpropchange</code>  </li>
<li>ç»§ç»­æ‰§è¡Œ<code>onclick</code>äº‹ä»¶å¤„ç†ç¨‹åºä¸­å‰©ä¸‹çš„ <code>alert(&#39;out onclick&#39;);</code>  </li>
</ol>
<p><img src="http://img.heroicyang.com/synchronous-mutation-events.png" alt=""><br>å…³äº<code>DOM Mutation events</code>ï¼Œè¯¦æƒ…è¯·å‚è§ï¼š<br><a href="https://developer.mozilla.org/en-US/docs/DOM/Mutation_events" target="_blank" rel="external">https://developer.mozilla.org/en-US/docs/DOM/Mutation_events</a><br><a href="http://www.w3.org/TR/DOM-Level-3-Events/#events-mutationevents" target="_blank" rel="external">http://www.w3.org/TR/DOM-Level-3-Events/#events-mutationevents</a>  </p>
<h3 id="åµŒå¥—çš„DOMäº‹ä»¶">åµŒå¥—çš„DOMäº‹ä»¶</h3><p>åœ¨æµè§ˆå™¨ç«¯ï¼Œæœ‰ä¸€äº›æ–¹æ³•ä¼šç«‹å³è§¦å‘æŸç±»äº‹ä»¶ï¼Œè€Œè¿™ç±»äº‹ä»¶ä¹Ÿæ˜¯åŒæ­¥çš„ã€‚æ¯”å¦‚<code>element.focus()</code>ï¼Œä¸‹é¢æ˜¯æ¼”ç¤ºä»£ç ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"button"</span> value=<span class="string">"click me"</span>&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><br><span class="line">  <span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'input'</span>)[<span class="number">0</span>]</span><br><span class="line">    , text = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'input'</span>)[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  btn.onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'in onclick'</span>);</span><br><span class="line">    text.focus();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'out onclick'</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  text.onfocus = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'onfocus'</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="http://img.heroicyang.com/synchronous-focus-event.png" alt="">  </p>
<p>å¸¸è§„æƒ…å†µä¸‹ï¼Œäº‹ä»¶å¤„ç†éƒ½æ˜¯ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œçš„ï¼Œè€Œæˆ‘ä»¬ä¹Ÿå°±å‡å®šä¸€ä¸ªäº‹ä»¶å¼€å§‹æ—¶ï¼Œå‰ä¸€ä¸ªäº‹ä»¶æ˜¯æ‰§è¡Œå®Œæ¯•äº†çš„ã€‚è€Œä»¥ä¸Šè¿™äº›åŒæ­¥äº‹ä»¶ä¸ä»…æ‰“ç ´äº†æˆ‘ä»¬çš„å¸¸è§„è®¤è¯†ï¼Œè¿˜ä¼šç»™æˆ‘ä»¬å¸¦æ¥ä¸€äº›è´Ÿé¢æ•ˆåº”ã€‚ä¸è¿‡æˆ‘ä»¬ä¾æ—§å¯ä»¥ä½¿ç”¨<a href="http://heroicyang.com/2012/09/22/javascript-timer-in-depth" target="_blank" rel="external">ä¸Šä¸€ç¯‡</a>ä¸­æ‰€ä½¿ç”¨çš„<code>setTimeout(func, 0)</code>æ¥è§£å†³ã€‚  </p>
<h2 id="JavaScriptæ‰§è¡Œä¸é¡µé¢æ¸²æŸ“">JavaScriptæ‰§è¡Œä¸é¡µé¢æ¸²æŸ“</h2><p>å¤§å¤šæ•°æµè§ˆå™¨ä¸­ï¼ŒJavaScriptçš„æ‰§è¡Œå’Œé¡µé¢æ¸²æŸ“æ˜¯äº’æ–¥çš„ï¼Œäºæ˜¯JavaScriptæ‰§è¡Œæ—¶ï¼Œæµè§ˆå™¨å°±ä¸ä¼šåšä»»ä½•çš„é¡µé¢æ¸²æŸ“ã€‚æ¯”å¦‚ä¸‹é¢çš„Demoâ€¦<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE HTML&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en-US"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">title</span>&gt;</span>JavaScriptæ‰§è¡Œä¸é¡µé¢æ¸²æŸ“<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">style</span> <span class="attribute">type</span>=<span class="value">"text/css"</span>&gt;</span><span class="css"></span><br><span class="line">    <span class="id">#container</span> <span class="rules">&#123;</span><br><span class="line">      <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">200px</span></span></span>; </span><br><span class="line">      <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">100px</span></span></span>; </span><br><span class="line">      <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#A00000</span></span></span>; </span><br><span class="line">      <span class="rule"><span class="attribute">margin-bottom</span>:<span class="value"> <span class="number">10px</span></span></span>;</span><br><span class="line">    &#125;</span></span><br><span class="line">  </span><span class="tag">&lt;/<span class="title">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"container"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"button"</span> <span class="attribute">value</span>=<span class="value">"run"</span> <span class="attribute">id</span>=<span class="value">"run"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><br><span class="line">    <span class="keyword">var</span> runBtn = <span class="built_in">document</span>.getElementById(<span class="string">'run'</span>)</span><br><span class="line">      , container = <span class="built_in">document</span>.getElementById(<span class="string">'container'</span>);</span><br><span class="line">    </span><br><span class="line">    runBtn.onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0xA00000</span>; i &lt; <span class="number">0xFFFFFF</span>; i++) &#123;</span><br><span class="line">        container.style.backgroundColor = <span class="string">'#'</span> + i.toString(<span class="number">16</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<iframe src="http://sample.heroicyang.com/repaint.html" style="border: 1px solid #DDD; border-radius: 3px; background: #F8F8F8; width: 90%; height:150px; padding: 1px;"></iframe>

<p>è¿è¡Œä¸Šé¢çš„Demoåï¼Œå¤§å¤šæ•°æµè§ˆå™¨éƒ½ä¼šå‡æ­»äº†ï¼Œç›´åˆ°<code>container</code>çš„èƒŒæ™¯é¢œè‰²å˜æ›´ä¸º<code>#FFFFFF</code>åæ‰æ¢å¤ã€‚è€Œæœ‰çš„æµè§ˆå™¨(å¦‚Firefox)è¿˜ä¼šå¼¹å‡ºè­¦å‘Šï¼Œå‘ŠçŸ¥JavaScriptæ²¡æœ‰å“åº”ï¼Œæ˜¯ç»ˆæ­¢è¿˜æ˜¯ç­‰å¾…ã€‚ä½†æ˜¯Operaå´èƒ½æ­£å¸¸è¿è¡Œï¼Œå¹¶ä¸æ–­æ›´æ”¹èƒŒæ™¯é¢œè‰²ã€‚å› æ­¤ä¸åŒæµè§ˆå™¨å¯¹é¡µé¢æ¸²æŸ“å’ŒJavaScriptæ‰§è¡Œçš„å®ç°æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ã€‚  </p>
<p>å…³äºè¿™æ–¹é¢æœ‰å¾ˆå¤§çš„å­¦é—®ï¼Œè¿˜éœ€è¦ç»§ç»­å­¦ä¹ ï¼Œæ…¢æ…¢æ‘¸ç´¢ã€‚Soâ€¦è¿™ä¸ªå°±ç‚¹åˆ°ä¸ºæ­¢äº†ã€‚</p>
<h3 id="æ¨¡å¼å¯¹è¯æ¡†çš„åŒæ­¥è°ƒç”¨">æ¨¡å¼å¯¹è¯æ¡†çš„åŒæ­¥è°ƒç”¨</h3><p>æµè§ˆå™¨æä¾›çš„å¦‚<code>alert</code>ç­‰çš„æ¨¡å¼å¯¹è¯æ¡†æ˜¯åŒæ­¥è°ƒç”¨çš„ï¼Œæ‰€ä»¥å½“è¿™ç±»å¯¹è¯æ¡†å·¥ä½œæ—¶ï¼Œä¼šåœæ­¢<code>JavaScriptçº¿ç¨‹</code>ï¼Œå½“ç„¶å¦‚é¡µé¢æ¸²æŸ“ç­‰æ´»åŠ¨ä¹Ÿå°†è¢«å†»ç»“ã€‚ç»§ç»­ä¸‹é¢çš„Demoâ€¦å½“è¿è¡Œä»£ç ä¸‹é¢çš„<code>iframe</code>ä¸­çš„è¿›åº¦æ¡åï¼Œæ— è®ºæ˜¯ç‚¹å‡»<code>ä¸»çª—ä½“ä¸­çš„alert</code>æŒ‰é’®ï¼Œè¿˜æ˜¯ç‚¹å‡»<code>iframeä¸­çš„alert</code>æŒ‰é’®ï¼Œéƒ½ä¼šå¯¼è‡´è¿›åº¦æ¡æŒ‚èµ·ã€‚  </p>
<p><input type="button" value="ä¸»çª—ä½“ä¸­çš„alert" onclick="alert('ä¸»çª—ä½“å¯¹è¯æ¡†');"><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"container"</span> style=<span class="string">"width: 0px; height: 20px; background-color: #A00000;"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"button"</span> <span class="attribute">value</span>=<span class="value">"run"</span> <span class="attribute">id</span>=<span class="value">"run"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"button"</span> <span class="attribute">value</span>=<span class="value">"stop"</span> <span class="attribute">id</span>=<span class="value">"stop"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"button"</span> <span class="attribute">value</span>=<span class="value">"iframeä¸­çš„alert"</span> <span class="attribute">onclick</span>=<span class="value">"alert('iframeä¸­çš„å¯¹è¯æ¡†');"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><br><span class="line">  <span class="keyword">var</span> runBtn = <span class="built_in">document</span>.getElementById(<span class="string">'run'</span>)</span><br><span class="line">    , stopBtn = <span class="built_in">document</span>.getElementById(<span class="string">'stop'</span>)</span><br><span class="line">    , container = <span class="built_in">document</span>.getElementById(<span class="string">'container'</span>);</span><br><span class="line">  <span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  runBtn.onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">    timer = setInterval(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> style = container.style;</span><br><span class="line">      style.width = (<span class="built_in">parseInt</span>(style.width) + <span class="number">2</span>) % <span class="number">400</span> + <span class="string">'px'</span>;</span><br><span class="line">    &#125;, <span class="number">50</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  stopBtn.onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">    clearInterval(timer);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<iframe src="http://sample.heroicyang.com/modal-sync.html" style="border: 1px solid #DDD; border-radius: 3px; background: #F8F8F8; width: 90%; height:70px; padding: 1px;"></iframe>  

<p>å› æ­¤ï¼Œæµè§ˆå™¨æ‰€æä¾›çš„<code>alert</code>ã€<code>confirm</code>ã€<code>prompt</code>è¿™ä¸‰ç±»æ¨¡å¼å¯¹è¯æ¡†ï¼Œéƒ½ä¼šé˜»å¡<code>JavaScriptçº¿ç¨‹</code>å’Œ<code>UIçº¿ç¨‹</code>ã€‚  </p>
<p><strong>ä¾æ—§ï¼ŒOperaæœ‰ä¸€ç‚¹ç‚¹çš„ä¾‹å¤–ã€‚ã€‚ã€‚</strong>  </p>
<p>åœ¨Operaä¸­ï¼Œç‚¹å‡»<code>ä¸»çª—ä½“ä¸­çš„alert</code>æŒ‰é’®ä¸ä¼šé˜»å¡<code>iframe</code>ä¸­çš„è¿›åº¦æ¡ã€‚ã€‚ã€‚åˆæ‰“ç ´æˆ‘ä»¬çš„å¸¸è§„è®¤è¯†å•Šï¼šåŒä¸€ä¸ªé¡µé¢ä¸Šï¼Œ<code>iframe</code>æ˜¯å’Œä¸»çª—ä½“åŒä¸€ä¸ªçº¿ç¨‹çš„ã€‚ä½†Operaçš„è®¾è®¡å¹¶éå¦‚æ­¤ã€‚ã€‚ã€‚  </p>
<h2 id="å½“è„šæœ¬éœ€è¦èŠ±å¾ˆé•¿çš„æ—¶é—´å¹²å¤æ‚çš„å·¥ä½œæ—¶">å½“è„šæœ¬éœ€è¦èŠ±å¾ˆé•¿çš„æ—¶é—´å¹²å¤æ‚çš„å·¥ä½œæ—¶</h2><p>ç±»ä¼¼çš„å°±æ˜¯å‰é¢é‚£ä¸ªé˜»å¡æˆ‘ä»¬æµè§ˆå™¨çš„ï¼Œé¢‘ç¹æ›´æ”¹<code>container</code>èƒŒæ™¯é¢œè‰²çš„ä¾‹å­ã€‚æœ€åï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨<a href="http://heroicyang.com/2012/09/22/javascript-timer-in-depth" target="_blank" rel="external">ä¸Šä¸€ç¯‡æ–‡ç« ä¸­</a>çš„<code>setTimeout(func, 0)</code>æ¥è§£å†³å®ƒå§ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"container"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"button"</span> <span class="attribute">value</span>=<span class="value">"run"</span> <span class="attribute">id</span>=<span class="value">"run"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"button"</span> <span class="attribute">value</span>=<span class="value">"stop"</span> <span class="attribute">id</span>=<span class="value">"stop"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><br><span class="line">  <span class="keyword">var</span> runBtn = <span class="built_in">document</span>.getElementById(<span class="string">'run'</span>)</span><br><span class="line">    , stopBtn = <span class="built_in">document</span>.getElementById(<span class="string">'stop'</span>)</span><br><span class="line">    , container = <span class="built_in">document</span>.getElementById(<span class="string">'container'</span>);</span><br><span class="line">  <span class="keyword">var</span> i = <span class="number">0xA00000</span>, timer = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  runBtn.onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      timer = setTimeout(run, <span class="number">0</span>);</span><br><span class="line">      container.style.backgroundColor = <span class="string">'#'</span> + i.toString(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (i++ == <span class="number">0xFFFFFF</span>) stop();</span><br><span class="line">    &#125;</span><br><span class="line">    timer = setTimeout(run, <span class="number">0</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  stopBtn.onclick = stop;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    clearTimeout(timer);</span><br><span class="line">  &#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<iframe src="http://sample.heroicyang.com/heavy-jobs.html" style="border: 1px solid #DDD; border-radius: 3px; background: #F8F8F8; width: 90%; height:150px; padding: 1px;"></iframe>  

<p>æœ€åï¼Œæ€»ç»“ä¸€ä¸‹<code>setTimeout(func, 0)</code>çš„ä½¿ç”¨åœºæ™¯å§ï¼š</p>
<ol>
<li>è®©æµè§ˆå™¨æ¸²æŸ“å½“å‰çš„å˜åŒ–  </li>
<li>é¿å…é•¿æ—¶é—´è¿è¡Œçš„è„šæœ¬  </li>
<li>æµç¨‹æ§åˆ¶  </li>
<li>ç­‰ç­‰ç­‰ç­‰ã€‚ã€‚ã€‚</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<p>å¯¹äºæµè§ˆå™¨ç«¯æ¥è¯´ï¼Œå¤§å¤šæ•°äº‹ä»¶éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œä½†æ˜¯æœ‰éƒ¨åˆ†äº‹ä»¶å´ä¸æ˜¯ï¼Œè¿™éƒ¨åˆ†äº‹ä»¶ç§°åš<strong>åŒæ­¥äº‹ä»¶</strong>ï¼Œå› æ­¤å®ƒä»¬éƒ½æ˜¯ç«‹å³æ‰§è¡Œçš„ï¼Œå®Œå…¨ä¸ç†ä¼šå‰å‡ ç¯‡æ–‡ç« ä¸­æ‰€æåˆ°çš„<strong>äº‹ä»¶é˜Ÿåˆ—</strong>ã€‚ä»¥åŠæµè§ˆå™¨çš„æ¸²æŸ“ã€é‡ç»˜ç­‰æ“ä½œï¼Œä¹Ÿä¼šæ‰“ä¹±ä¹‹å‰æˆ‘ä»¬å¥½ä¸å®¹æ˜“æ‰€å»ºç«‹èµ·æ¥çš„<strong>äº‹ä»¶é˜Ÿåˆ—</strong>çš„æ¦‚å¿µã€‚ä¸è¿‡ï¼Œæœ¬ç¯‡å°†ä¼šé™†ç»­ä¸æ–­çš„æŠŠè¿™äº›å‘ç»™å¡«ä¸Šã€‚  </p>
<h2 id="åŒæ­¥äº‹ä»¶">åŒæ­¥äº‹ä»¶</h2><h3 id="DOMæ”¹å˜äº‹ä»¶(DOM_Mutation_events)">DOMæ”¹å˜äº‹ä»¶(DOM Mutation events)</h3><p>ä¸‹é¢çš„Demoä¾¿ç”¨äºè¯´æ˜åŒæ­¥äº‹ä»¶ä¹‹ä¸€çš„<code>DOM Mutation events</code>ï¼ˆæ³¨ï¼šè¯¥äº‹ä»¶ä¸æ”¯æŒChromeæµè§ˆå™¨ï¼‰ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"http://heroicyang.com/"</span>&gt;</span></span><br><span class="line">  heroicyang.com</span><br><span class="line"><span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="pf"></span><br><span class="line">  var <span class="built_in">anchor</span> = document.getElementsByTagName('a')[<span class="number">0</span>];</span><br><span class="line">  <span class="built_in">anchor</span>.onclick = function(e) &#123;</span><br><span class="line">    alert('<span class="keyword">in</span> onclick');</span><br><span class="line">    this.<span class="built_in">set</span>Attribute('href', '<span class="comment">#');</span></span><br><span class="line">    alert('<span class="keyword">out</span> onclick');</span><br><span class="line">    return false;</span><br><span class="line">  &#125;;</span><br><span class="line">  if (<span class="built_in">anchor</span>.addEventListener) &#123;  //Firefox, Opera</span><br><span class="line">    <span class="built_in">anchor</span></span><br><span class="line">      .addEventListener('DOMAttrModified', onpropchange, false);</span><br><span class="line">  &#125; else if (<span class="built_in">anchor</span>.attachEvent) &#123;  //IE</span><br><span class="line">    <span class="built_in">anchor</span></span><br><span class="line">      .attachEvent('onpropertychange', onpropchange);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  function onpropchange() &#123;</span><br><span class="line">    alert('onpropchange');</span><br><span class="line">  &#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
      <category term="javascript timer" scheme="http://heroicyang.com/tags/javascript-timer/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JavaScriptå®šæ—¶å™¨]]></title>
    <link href="http://heroicyang.com/2012/09/22/javascript-timer-in-depth/"/>
    <id>http://heroicyang.com/2012/09/22/javascript-timer-in-depth/</id>
    <published>2012-09-22T10:57:00.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>å¯¹äºæµè§ˆå™¨å†…éƒ¨ï¼Œå¤§éƒ¨åˆ†æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ç”Ÿæˆäº‹ä»¶å¹¶æ·»åŠ åˆ°<code>JavaScriptå¼•æ“çº¿ç¨‹</code>çš„é˜Ÿåˆ—ä¸­ï¼Œç„¶åç”±<code>JavaScriptå¼•æ“çº¿ç¨‹</code>è¿›è¡Œè°ƒåº¦æ‰§è¡Œã€‚å› æ­¤æµè§ˆå™¨çš„å¾ˆå¤šäº‹ä»¶éƒ½æ˜¯å’Œ<code>JavaScript</code>ç›¸ç»“åˆçš„ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›å†…éƒ¨çš„é™åˆ¶ã€‚  </p>
<p>é¦–å…ˆæˆ‘ä»¬éå¸¸ç¡®å®š<code>JavaScript</code>æ˜¯å•çº¿ç¨‹çš„ï¼Œå¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œä¸€ä¸ªçª—ä½“ä¸­åªæœ‰ä¸€ä¸ª<code>JavaScriptå¼•æ“çº¿ç¨‹</code>ã€‚è€Œå…¶ä»–çš„è¡Œä¸ºï¼Œå¦‚ï¼šæ¸²æŸ“ã€ä¸‹è½½ç­‰æ˜¯ç”±å•ç‹¬çš„çº¿ç¨‹è¿›è¡Œç®¡ç†çš„ï¼Œä¸”å…·æœ‰ä¸åŒçš„ä¼˜å…ˆçº§ã€‚  </p>
<h2 id="å¼‚æ­¥äº‹ä»¶">å¼‚æ­¥äº‹ä»¶</h2><p>å‰é¢æåˆ°å¤§å¤šæ•°äº‹ä»¶éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œè§¦å‘çš„æ—¶å€™å°±å°†å›è°ƒå‡½æ•°æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ã€‚æµè§ˆå™¨æä¾›äº†ä¸€ä¸ªå†…éƒ¨çš„å›è·¯ï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰æ‰€è°ˆåˆ°çš„<code>Event Loop</code>ï¼Œç”±å®ƒæ¥è´Ÿè´£æ£€æŸ¥é˜Ÿåˆ—å’Œå¤„ç†äº‹ä»¶ã€æ‰§è¡Œå‡½æ•°ç­‰ã€‚è¯¦ç»†å¯å‚è€ƒæˆ‘çš„<a href="http://heroicyang.com/2012/08/28/javascript-event-loop" target="_blank" rel="external">å‰ä¸€ç¯‡åšæ–‡</a>ã€‚è€Œ<code>setTimeout</code>å’Œ<code>setInterval</code>ä¹Ÿæ˜¯å°†å…¶éœ€è¦æ‰§è¡Œçš„å‡½æ•°æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ã€‚  </p>
<p><strong>äº‹å®ä¸Šï¼Œå¤§å¤šæ•°äº¤äº’å’Œæ´»åŠ¨éƒ½å¾—é€šè¿‡äº‹ä»¶å¾ªç¯ã€‚</strong><br><a id="more"></a>  </p>
<h2 id="äº‹ä»¶é‡å ">äº‹ä»¶é‡å </h2><p>ä¸€äº›æƒ…å†µä¸‹ï¼Œä¼šæœ‰å¤šä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶é—´é™„åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—é‡Œã€‚  </p>
<p>æ¯”å¦‚ï¼Œ<code>click</code>äº‹ä»¶å°±ä¼šäº§ç”Ÿä¸¤ä¸ªé¢å¤–çš„äº‹ä»¶ï¼š<code>mousedown</code>å’Œ<code>mouseup</code>ã€‚å…¶ä¸­ï¼Œ<code>mouseup</code>å’Œ<code>click</code>äº‹ä»¶ä¼šåŒæ—¶è¢«æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ï¼›è€Œ<code>mousedown</code>äº‹ä»¶åˆ™å¾ˆæœ‰å¯èƒ½ä¼šå’Œå¦å¤–ä¸€ä¸ªäº‹ä»¶é‡å ï¼š<code>focus</code>ã€‚  </p>
<h2 id="setTimeout(func,_0)å¥‡å·§æ·«æŠ€">setTimeout(func, 0)å¥‡å·§æ·«æŠ€</h2><p>å†ä¸€æ¬¡è§£é‡Šå…³äº<code>0ms</code>çš„è¯¯è§£ï¼šå¦‚æœå½“å‰æ—¶é’Ÿå‘¨æœŸå†…æ‰§è¡Œé˜Ÿåˆ—ç©ºé—²ï¼Œåˆ™ç«‹å³æ‰§è¡Œè¯¥å®šæ—¶å™¨ï¼Œå°†å›è°ƒå‡½æ•°åŠ å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—ï¼›ç„¶åç­‰å¾…ä¸‹ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œå†æ‰§è¡Œè¯¥å›è°ƒå‡½æ•°ã€‚ä¸å¦¨æ¥çœ‹çœ‹ä¸‹é¢çš„æµ‹è¯•ã€‚</p>
<p>è¿™æ®µä»£ç åœ¨æˆ‘çš„æµè§ˆå™¨ä¸­æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="http://img.heroicyang.com/setTimeout-Measure.png" alt=""></p>
<p>åœ¨æˆ‘æœ¬åœ°çš„<code>Nodejs</code>ç¯å¢ƒä¸­æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š  </p>
<p><img src="http://img.heroicyang.com/setTimeout-Measure-Nodejs.png" alt="">  </p>
<p>ä¸Šé¢çš„è¿™ä¸ªæµ‹è¯•åªæ˜¯æƒ³è¯´æ˜<code>setTimeout(func, 0)</code>å®šæ—¶ä»»åŠ¡çš„å›è°ƒå‡½æ•°æ‰§è¡Œæ—¶é—´æ˜¯æœ‰å»¶è¿Ÿçš„ï¼Œè€Œå¹¶ä¸æ˜¯æ‰€è°“çš„ç«‹å³æ‰§è¡Œã€‚  </p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>setTimeout(func, 0)</code>æ¥è§£å†³äº‹ä»¶é‡å æ‰€äº§ç”Ÿçš„è´Ÿé¢æ•ˆæœï¼Œä¿®æ­£æ‰§è¡Œé¡ºåºã€‚ </p>
<h3 id="å¥‡å·§æ·«æŠ€ä¹‹ä¸€ï¼šæ¨¡æ‹Ÿæµè§ˆå™¨çš„äº‹ä»¶æ•è·">å¥‡å·§æ·«æŠ€ä¹‹ä¸€ï¼šæ¨¡æ‹Ÿæµè§ˆå™¨çš„äº‹ä»¶æ•è·</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œæµè§ˆå™¨çš„DOMäº‹ä»¶éƒ½æ˜¯é‡‡ç”¨å†’æ³¡çš„æ–¹å¼ï¼Œåªæœ‰ä¸ªåˆ«æµè§ˆå™¨æ˜¯æ”¯æŒäº‹ä»¶æ•è·çš„ã€‚è€Œåœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­å¯èƒ½å­˜åœ¨éœ€è¦äº‹ä»¶æ•è·çš„éœ€æ±‚ï¼Œè¦æ±‚å­å…ƒç´ çš„äº‹ä»¶åœ¨çˆ¶å…ƒç´ è§¦å‘ä¹‹åæ‰èƒ½è§¦å‘ã€‚ä¸ºäº†å…¼å®¹å„ä¸ªæµè§ˆå™¨ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨äº‹ä»¶æ•è·ï¼Œè€Œ<code>setTimeout(func, 0)</code>åœ¨è¿™ä¸ªæ—¶å€™å°±å¾ˆä¹æ„å¸®å¿™äº†ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"button"</span> value=<span class="string">"click"</span> id=<span class="string">"cbtn"</span>&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"result"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="nimrod"></span><br><span class="line">  <span class="keyword">var</span> cbtn = document.getElementById('cbtn')</span><br><span class="line">    , <span class="literal">result</span> = document.getElementById('<span class="literal">result</span>');</span><br><span class="line"></span><br><span class="line">  cbtn.onclick = function(e) &#123;</span><br><span class="line">    setTimeout(function() &#123;</span><br><span class="line">      <span class="literal">result</span>.innerHTML += 'input click, ';</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  document.body.onclick = function(e) &#123;</span><br><span class="line">    <span class="literal">result</span>.innerHTML += 'body click -&gt; ';</span><br><span class="line">  &#125;;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>ç‚¹å‡»æŸ¥çœ‹è¿è¡Œæ•ˆæœï¼š  </p>
<iframe src="http://sample.heroicyang.com/setTimeout01.html" style="border: 1px solid #DDD; border-radius: 3px; background: #F8F8F8; width: 90%; height:80px; padding: 1px;"></iframe>

<h3 id="å¥‡å·§æ·«æŠ€ä¹‹äºŒï¼šè®©æµè§ˆå™¨æ›´å¥½çš„å·¥ä½œ">å¥‡å·§æ·«æŠ€ä¹‹äºŒï¼šè®©æµè§ˆå™¨æ›´å¥½çš„å·¥ä½œ</h3><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æµè§ˆå™¨çš„é»˜è®¤è¡Œä¸ºä¹‹å‰å¯¹äº‹ä»¶è¿›è¡Œå¤„ç†ï¼Œä½†æ˜¯æœ‰æ—¶æˆ‘ä»¬æŒ‰ç…§å¸¸è§„çš„æ€è·¯å»åšçš„æ—¶å€™ï¼Œå¾€å¾€äº‹ä¸æ„¿è¿ã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"text"</span> id=<span class="string">"wordInput"</span>&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><br><span class="line">  <span class="keyword">var</span> wordInput = <span class="built_in">document</span>.getElementById(<span class="string">'wordInput'</span>);</span><br><span class="line">  wordInput.onkeypress = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.value = <span class="keyword">this</span>.value.toUpperCase();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>çœ‹ä¼¼ä¸€ä¸ªå¾ˆç®€å•çš„éœ€æ±‚ï¼šæ¯è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œå°±å°†å…¶è½¬æ¢ä¸ºå¤§å†™ã€‚ä½†æ˜¯ä¸Šé¢çš„ä»£ç å®Œå…¨æ²¡æœ‰æŒ‰ç…§æŒ‡ç¤ºå»åšï¼Œä¸ä¿¡ä½ è¯•è¯•çœ‹ï¼š  </p>
<iframe src="http://sample.heroicyang.com/setTimeout-toUpper-01.html" style="border: 1px solid #DDD; border-radius: 3px; background: #F8F8F8; height:45px; padding: 1px;"></iframe>  

<p>å¦‚æœæ²¡æœ‰ä¸‹ä¸€æ¬¡è¾“å…¥ï¼Œæ–‡æœ¬æ¡†ä¸­çš„å°å†™å­—æ¯æ°¸è¿œéƒ½ä¸ä¼šè½¬æ¢ä¸ºå¤§å†™ã€‚Why? å› ä¸ºæµè§ˆå™¨åœ¨<code>keypress</code>äº‹ä»¶å¤„ç†çš„æ—¶å€™ï¼Œè¿˜æ²¡æœ‰å°†æˆ‘ä»¬è¾“å…¥çš„å€¼æ·»åŠ åˆ°æ–‡æœ¬æ¡†ã€‚äºæ˜¯ä¹æ¢ä¸€ä¸ªäº‹ä»¶æ¥handleç„¶åå†å¤„ç†å§ï¼Œæ—¢ç„¶é”®æŒ‰ä¸‹çš„æ—¶å€™è¿˜æœ¨æœ‰å€¼ï¼Œé‚£å°±ç­‰é”®å¼¹èµ·æ¥ä¹‹åå†å¤„ç†ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"text"</span> id=<span class="string">"wordInput"</span>&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><br><span class="line">  <span class="keyword">var</span> wordInput = <span class="built_in">document</span>.getElementById(<span class="string">'wordInput'</span>);</span><br><span class="line">  wordInput.onkeyup = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.value = <span class="keyword">this</span>.value.toUpperCase();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>è¿è¡Œè¯•è¯•å§ã€‚</p>
<iframe src="http://sample.heroicyang.com/setTimeout-toUpper-02.html" style="border: 1px solid #DDD; border-radius: 3px; background: #F8F8F8; height:45px; padding: 1px;"></iframe>  

<p>å¤§æ¦‚ä¼¼ä¹æ˜¯å¯è¡Œäº†ï¼Œå¯æ˜¯ä»”ç»†è§‚å¯Ÿå°±çœ‹å‡ºé—®é¢˜äº†ã€‚<code>keyup</code>äº‹ä»¶è§¦å‘æ—¶ï¼Œæ–‡æœ¬æ¡†å·²ç»å…·å¤‡å®Œæ•´çš„å€¼äº†ï¼Œä½†å…ˆæ˜¯ä¸€ä¸ªå°å†™çš„å€¼ï¼Œé”®å®Œå…¨é‡Šæ”¾ä¹‹åè½¬å˜ä¸ºå¤§å†™ã€‚è¿™ä¸ç§‘å­¦â€¦è¿™å¤ªä¸‘é™‹â€¦  </p>
<p>æ˜¯æ—¶å€™å…³é—¨æ”¾å‡º<code>setTimeout(func, 0)</code>äº†ã€‚ã€‚ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"text"</span> id=<span class="string">"wordInput"</span>&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="php"></span><br><span class="line">  <span class="keyword">var</span> wordInput = document.getElementById(<span class="string">'wordInput'</span>);</span><br><span class="line">  wordInput.onkeypress = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">self</span> = this;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">self</span>.value = <span class="keyword">self</span>.value.toUpperCase();</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>  </p>
<iframe src="http://sample.heroicyang.com/setTimeout-toUpper-03.html" style="border: 1px solid #DDD; border-radius: 3px; background: #F8F8F8; height:45px; padding: 1px;"></iframe>  

<p>å·²ç»å®Œç¾äº†ã€‚<code>keypress</code>äº‹ä»¶è§¦å‘æ—¶ï¼Œå°†è½¬æ¢å¤§å†™çš„æ“ä½œæ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ï¼Œç´§æ¥ç€æµè§ˆå™¨æ·»åŠ æˆ‘ä»¬è¾“å…¥çš„å€¼ï¼Œç„¶åè¿‘ä¹0å»¶è¿Ÿçš„æ‰§è¡Œæˆ‘ä»¬çš„è½¬æ¢å¤§å†™æ“ä½œå‡½æ•°ã€‚  </p>
<p>ä¸Šé¢ä¸¤ä¸ªå°æ¡ˆä¾‹åªæ˜¯å†°å±±ä¸€è§’ï¼Œsoâ€¦åˆç†åˆ©ç”¨<code>setTimeout(func, 0)</code>ï¼Œæ˜å¤©æ›´ç¾å¥½ï¼</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>å¯¹äºæµè§ˆå™¨å†…éƒ¨ï¼Œå¤§éƒ¨åˆ†æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ç”Ÿæˆäº‹ä»¶å¹¶æ·»åŠ åˆ°<code>JavaScriptå¼•æ“çº¿ç¨‹</code>çš„é˜Ÿåˆ—ä¸­ï¼Œç„¶åç”±<code>JavaScriptå¼•æ“çº¿ç¨‹</code>è¿›è¡Œè°ƒåº¦æ‰§è¡Œã€‚å› æ­¤æµè§ˆå™¨çš„å¾ˆå¤šäº‹ä»¶éƒ½æ˜¯å’Œ<code>JavaScript</code>ç›¸ç»“åˆçš„ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›å†…éƒ¨çš„é™åˆ¶ã€‚  </p>
<p>é¦–å…ˆæˆ‘ä»¬éå¸¸ç¡®å®š<code>JavaScript</code>æ˜¯å•çº¿ç¨‹çš„ï¼Œå¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œä¸€ä¸ªçª—ä½“ä¸­åªæœ‰ä¸€ä¸ª<code>JavaScriptå¼•æ“çº¿ç¨‹</code>ã€‚è€Œå…¶ä»–çš„è¡Œä¸ºï¼Œå¦‚ï¼šæ¸²æŸ“ã€ä¸‹è½½ç­‰æ˜¯ç”±å•ç‹¬çš„çº¿ç¨‹è¿›è¡Œç®¡ç†çš„ï¼Œä¸”å…·æœ‰ä¸åŒçš„ä¼˜å…ˆçº§ã€‚  </p>
<h2 id="å¼‚æ­¥äº‹ä»¶">å¼‚æ­¥äº‹ä»¶</h2><p>å‰é¢æåˆ°å¤§å¤šæ•°äº‹ä»¶éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œè§¦å‘çš„æ—¶å€™å°±å°†å›è°ƒå‡½æ•°æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ã€‚æµè§ˆå™¨æä¾›äº†ä¸€ä¸ªå†…éƒ¨çš„å›è·¯ï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰æ‰€è°ˆåˆ°çš„<code>Event Loop</code>ï¼Œç”±å®ƒæ¥è´Ÿè´£æ£€æŸ¥é˜Ÿåˆ—å’Œå¤„ç†äº‹ä»¶ã€æ‰§è¡Œå‡½æ•°ç­‰ã€‚è¯¦ç»†å¯å‚è€ƒæˆ‘çš„<a href="http://heroicyang.com/2012/08/28/javascript-event-loop">å‰ä¸€ç¯‡åšæ–‡</a>ã€‚è€Œ<code>setTimeout</code>å’Œ<code>setInterval</code>ä¹Ÿæ˜¯å°†å…¶éœ€è¦æ‰§è¡Œçš„å‡½æ•°æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ã€‚  </p>
<p><strong>äº‹å®ä¸Šï¼Œå¤§å¤šæ•°äº¤äº’å’Œæ´»åŠ¨éƒ½å¾—é€šè¿‡äº‹ä»¶å¾ªç¯ã€‚</strong><br>]]>
    
    </summary>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
      <category term="javascript timer" scheme="http://heroicyang.com/tags/javascript-timer/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ç†è§£JavaScriptå®šæ—¶å™¨ï¼šsetTimeoutå’ŒsetInterval]]></title>
    <link href="http://heroicyang.com/2012/09/06/javascript-timers/"/>
    <id>http://heroicyang.com/2012/09/06/javascript-timers/</id>
    <published>2012-09-06T14:56:00.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p><strong>å®šæ—¶å™¨å…¶å®å¹¶ä¸æ˜¯<code>JavaScript</code>æä¾›çš„ï¼Œè€Œæ˜¯ç”±æµè§ˆå™¨ï¼ˆå¯¹äºå‰ç«¯æ¥è¯´ï¼‰æä¾›çš„ã€‚</strong>æ‰€ä»¥<code>setTimeout()</code>å’Œ<code>setInterval()</code>è¿™ä¸¤ä¸ªæ–¹æ³•å‡æ˜¯é€šè¿‡æµè§ˆå™¨çš„é¡¶å±‚å¯¹è±¡<code>window</code>è¿›è¡Œè°ƒç”¨ï¼Œå¯èƒ½å¹³æ—¶å¤§å®¶åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šçœå»<code>window</code>è€Œç›´æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚  </p>
<p>è¿™ä¸¤ä¸ªæ–¹æ³•æ‰€æ¥æ”¶çš„å‚æ•°éƒ½ä¸€æ ·ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(func|code, delay);</span><br><span class="line">setInterval(func|code, delay);</span><br></pre></td></tr></table></figure><br>è¿™ä¸¤ä¸ªæ–¹æ³•æ€»æ˜¯è¢«ç®€å•çš„è®¤ä¸ºï¼šåœ¨å¤šå°‘æ¯«ç§’ä¹‹åå°±æ‰§è¡Œé‡Œé¢çš„å‡½æ•°æˆ–è€…æ¯é—´éš”å¤šå°‘æ¯«ç§’å°±æ‰§è¡Œé‡Œé¢çš„å‡½æ•°ï¼ŒåŸºäºè¿™ç§ç†è§£çš„è¯ä¼šé‡åˆ°å¾ˆå¤šåŒªå¤·æ‰€æ€çš„å‘ã€‚è€Œç»“åˆ<a href="http://heroicyang.com/2012/08/28/javascript-event-loop" target="_blank" rel="external">ä¸Šç¯‡æ–‡ç« </a>ä¸­æ‰€æåˆ°çš„æ‰§è¡Œé˜Ÿåˆ—æ¥è§£é‡Šçš„è¯ï¼Œå¾ˆå¤šç–‘é—®éƒ½å¯ä»¥è¿åˆƒè€Œè§£ã€‚</p>
<p>å‰è€…ï¼šåœ¨æŒ‡å®šçš„æ¯«ç§’æ•°åï¼Œå°†å®šæ—¶ä»»åŠ¡å¤„ç†å‡½æ•°ï¼ˆ<code>func|code</code>ï¼‰æ·»åŠ åˆ°æ‰§è¡Œé˜Ÿåˆ—çš„é˜Ÿå°¾ã€‚  </p>
<p>åè€…ï¼šæŒ‰ç…§æŒ‡å®šçš„å‘¨æœŸï¼ˆä»¥æ¯«ç§’è®¡ï¼‰ï¼Œå°†å®šæ—¶ä»»åŠ¡å¤„ç†å‡½æ•°ï¼ˆ<code>func|code</code>ï¼‰æ·»åŠ åˆ°æ‰§è¡Œé˜Ÿåˆ—çš„é˜Ÿå°¾ã€‚<br><a id="more"></a><br>ä¸‹é¢åˆ†åˆ«ä½¿ç”¨äº†<code>setInterval</code>å’Œ<code>setTimeout</code>æ¥å®ç°åŒä¸€ä¸ªåŠŸèƒ½ï¼Œå¯è¿è¡ŒæŸ¥çœ‹æ•ˆæœã€‚ </p>
<iframe src="http://sample.heroicyang.com/timer.html" style="border: 1px solid #DDD; border-radius: 3px; background: #F8F8F8; height:80px;"></iframe>

<p>è¿™æ˜¯ç›¸åº”çš„æºä»£ç ï¼š<a href="http://code.heroicyang.com/timer.html" target="_blank">ä¼ é€é—¨</a>  </p>
<p><strong>æ¥ä¸‹æ¥ç»§ç»­å¡«<code>setInterval</code>çš„å‘ã€‚</strong>  </p>
<p>å‡è®¾å®šæ—¶å™¨çš„ä¸Šä¸€ä¸ªå›è°ƒæ‰§è¡Œå®Œåˆ°ä¸‹ä¸€ä¸ªå›è°ƒå¼€å§‹çš„è¿™æ®µæ—¶é—´ä¸ºæ—¶é—´é—´éš”ï¼Œé‚£ä¹ˆå¯¹äº<code>setTimeout</code>æ¥è¯´ï¼Œè¿™ä¸ªæ—¶é—´é—´éš”ç†è®ºä¸Šæ˜¯åº”è¯¥<code>&gt;=delay</code>ï¼›è€Œå¯¹äº<code>setInterval</code>æ¥è¯´ï¼Œè¿™ä¸ªæ—¶é—´é—´éš”ç†è®ºä¸Šæ˜¯åº”è¯¥<code>&lt;=delay</code>çš„ã€‚</p>
<p>ä½†äº‹å®æ€»ä¼šæœ‰å‡ºäººæ„æ–™çš„åœ°æ–¹ï¼Œ<code>setInterval</code>å°±æ˜¯é‚£ä¸ªåˆ¶é€ æ„å¤–çš„ä¸œè¥¿ã€‚   </p>
<p>ä»¥ä¸‹æ˜¯å¸¸è§„çš„ä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> endTime = <span class="literal">null</span>;</span><br><span class="line">setInterval(count, <span class="number">200</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">count</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> elapsedTime = endTime ? (<span class="keyword">new</span> <span class="built_in">Date</span>() - endTime) : <span class="number">200</span>;</span><br><span class="line">  i++;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'current count: '</span> + i + <span class="string">'.'</span> + <span class="string">'elapsed time: '</span> + elapsedTime + <span class="string">'ms'</span>);</span><br><span class="line">  endTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å…¶æ‰§è¡Œç»“æœä¹Ÿæ¯”è¾ƒç¬¦åˆç†è®ºæ—¶é—´ï¼Œè§ä¸‹å›¾ã€‚</p>
<p><img src="http://img.heroicyang.com/setInterval1.png" alt="">   </p>
<p>æ¥ä¸‹æ¥ä¿®æ”¹ä»£ç ï¼Œè®©<code>count()</code>æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´å˜é•¿ä¸€ç‚¹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">count</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> elapsedTime = endTime ? (<span class="keyword">new</span> <span class="built_in">Date</span>() - endTime) : <span class="number">200</span>;</span><br><span class="line">  i++;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'current count: '</span> + i + <span class="string">'.'</span> + <span class="string">'elapsed time: '</span> + elapsedTime + <span class="string">'ms'</span>);</span><br><span class="line">  sleep(<span class="number">100</span>); <span class="comment">//sleep 100ms</span></span><br><span class="line">  endTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="http://img.heroicyang.com/setInterval2.png" alt=""></p>
<p>ç»“åˆæ‰§è¡Œé˜Ÿåˆ—ï¼Œå¯ä»¥ç”¨ä¸‹å›¾å¯¹ä¸Šé¢ä¸¤ç§æƒ…å†µè¿›è¡Œç›´è§‚çš„è§£é‡Šï¼š</p>
<p><img src="http://img.heroicyang.com/setInterval1-explain.png" alt="">   </p>
<p>æ¥ä¸‹æ¥å†æ¬¡ä¿®æ”¹ä»£ç ï¼Œè®©<code>count()</code>æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´æ›´é•¿ï¼Œè®¾å®šä¸º<code>setInterval</code>ä¸­<code>delay</code>çš„<code>2</code>å€ï¼Œå³<code>400ms</code>ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">count</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> elapsedTime = endTime ? (<span class="keyword">new</span> <span class="built_in">Date</span>() - endTime) : <span class="number">200</span>;</span><br><span class="line">  i++;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'current count: '</span> + i + <span class="string">'.'</span> + <span class="string">'elapsed time: '</span> + elapsedTime + <span class="string">'ms'</span>);</span><br><span class="line">  sleep(<span class="number">400</span>); <span class="comment">//sleep 400ms</span></span><br><span class="line">  endTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å…¶æ‰§è¡Œæ•ˆæœå˜ä¸ºå¦‚ä¸‹ï¼š</p>
<p><img src="http://img.heroicyang.com/setInterval3.png" alt="">  </p>
<p>æ„å¤–å‘ç”Ÿäº†ï¼Œæ¯ä¸ªå›è°ƒä¹‹é—´çš„æ—¶é—´é—´éš”ç«Ÿç„¶æ²¡æœ‰äº†ï¼Œæˆ–è€…è¯´ç¼©çŸ­åˆ°éå¸¸å°çš„é—´éš”ã€‚äº‹æƒ…å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼šå¦‚æœ<code>setInterval</code>çš„å®šæ—¶æ—¶é—´åˆ°äº†ï¼Œè€Œå‰ä¸€ä¸ªå›è°ƒè¿˜æ²¡æœ‰æ‰§è¡Œå®Œæ—¶ï¼Œå°±ä¼šæŠŠè¿™æ¬¡çš„å›è°ƒæ”¾åœ¨æ‰§è¡Œé˜Ÿåˆ—çš„é˜Ÿå°¾ï¼›å¦‚æœ<code>setInterval</code>çš„å®šæ—¶æ—¶é—´å·²ç»å¤šæ¬¡è§¦å‘ï¼Œè€Œæ­¤æ—¶æœ€å‰ä¸€ä¸ªå›è°ƒä»ç„¶è¿˜åœ¨æ‰§è¡Œï¼Œé‚£ä¹ˆå°±ä¼šä¸¢å¼ƒæ‰æœ¬æ¬¡çš„å›è°ƒã€‚è¿˜æ˜¯ç”¨å›¾æ¥ç›´è§‚è¯´æ˜å§ã€‚  </p>
<p>è¿™æ˜¯å›è°ƒå¤„ç†æ—¶é—´æ¯”å®šæ—¶æ—¶é—´ç¨å¾®é•¿ä¸€ç‚¹ç‚¹çš„æƒ…å†µï¼š</p>
<p><img src="http://img.heroicyang.com/setInterval2-explain.png" alt="">  </p>
<p>è¿™æ˜¯å›è°ƒå¤„ç†æ—¶é—´æ¯”å®šæ—¶æ—¶é—´é•¿å¾ˆå¤šçš„æƒ…å†µï¼š</p>
<p><img src="http://img.heroicyang.com/setInterval3-explain.png" alt="">  </p>
<p><strong>æ‰€ä»¥ï¼Œå¦‚æœä½¿ç”¨<code>setInterval</code>çš„è¯ï¼Œå…¶æ—¶é—´é—´éš”æ€»æ˜¯è®©äººæ‰æ‘¸ä¸å®šã€‚è€Œä½¿ç”¨<code>setTimeout</code>åµŒå¥—ï¼Œåˆ™å®Œå…¨å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿˜æˆ‘ä»¬ä¸€ä¸ªå›ºå®šçš„æ—¶é—´é—´éš”ã€‚</strong></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><strong>å®šæ—¶å™¨å…¶å®å¹¶ä¸æ˜¯<code>JavaScript</code>æä¾›çš„ï¼Œè€Œæ˜¯ç”±æµè§ˆå™¨ï¼ˆå¯¹äºå‰ç«¯æ¥è¯´ï¼‰æä¾›çš„ã€‚</strong>æ‰€ä»¥<code>setTimeout()</code>å’Œ<code>setInterval()</code>è¿™ä¸¤ä¸ªæ–¹æ³•å‡æ˜¯é€šè¿‡æµè§ˆå™¨çš„é¡¶å±‚å¯¹è±¡<code>window</code>è¿›è¡Œè°ƒç”¨ï¼Œå¯èƒ½å¹³æ—¶å¤§å®¶åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šçœå»<code>window</code>è€Œç›´æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚  </p>
<p>è¿™ä¸¤ä¸ªæ–¹æ³•æ‰€æ¥æ”¶çš„å‚æ•°éƒ½ä¸€æ ·ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(func|code, delay);</span><br><span class="line">setInterval(func|code, delay);</span><br></pre></td></tr></table></figure><br>è¿™ä¸¤ä¸ªæ–¹æ³•æ€»æ˜¯è¢«ç®€å•çš„è®¤ä¸ºï¼šåœ¨å¤šå°‘æ¯«ç§’ä¹‹åå°±æ‰§è¡Œé‡Œé¢çš„å‡½æ•°æˆ–è€…æ¯é—´éš”å¤šå°‘æ¯«ç§’å°±æ‰§è¡Œé‡Œé¢çš„å‡½æ•°ï¼ŒåŸºäºè¿™ç§ç†è§£çš„è¯ä¼šé‡åˆ°å¾ˆå¤šåŒªå¤·æ‰€æ€çš„å‘ã€‚è€Œç»“åˆ<a href="http://heroicyang.com/2012/08/28/javascript-event-loop">ä¸Šç¯‡æ–‡ç« </a>ä¸­æ‰€æåˆ°çš„æ‰§è¡Œé˜Ÿåˆ—æ¥è§£é‡Šçš„è¯ï¼Œå¾ˆå¤šç–‘é—®éƒ½å¯ä»¥è¿åˆƒè€Œè§£ã€‚</p>
<p>å‰è€…ï¼šåœ¨æŒ‡å®šçš„æ¯«ç§’æ•°åï¼Œå°†å®šæ—¶ä»»åŠ¡å¤„ç†å‡½æ•°ï¼ˆ<code>func|code</code>ï¼‰æ·»åŠ åˆ°æ‰§è¡Œé˜Ÿåˆ—çš„é˜Ÿå°¾ã€‚  </p>
<p>åè€…ï¼šæŒ‰ç…§æŒ‡å®šçš„å‘¨æœŸï¼ˆä»¥æ¯«ç§’è®¡ï¼‰ï¼Œå°†å®šæ—¶ä»»åŠ¡å¤„ç†å‡½æ•°ï¼ˆ<code>func|code</code>ï¼‰æ·»åŠ åˆ°æ‰§è¡Œé˜Ÿåˆ—çš„é˜Ÿå°¾ã€‚<br>]]>
    
    </summary>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
      <category term="javascript timer" scheme="http://heroicyang.com/tags/javascript-timer/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[JavaScript Event Loop æµ…æ]]></title>
    <link href="http://heroicyang.com/2012/08/28/javascript-event-loop/"/>
    <id>http://heroicyang.com/2012/08/28/javascript-event-loop/</id>
    <published>2012-08-28T14:52:00.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å­¦ä¹ <code>Nodejs</code>çš„è¿‡ç¨‹ä¸­æ·±å…¥çš„äº†è§£äº†<code>å¼‚æ­¥ç¼–ç¨‹</code>è¿™ä¸ªæ¦‚å¿µï¼Œä¸ºäº†æ›´å¥½çš„ä½¿ç”¨<code>Nodejs</code>ï¼Œè¿™äº›æ¦‚å¿µä¸å¯ä¸çŸ¥ã€‚åœ¨ä»¥å‰ä½œä¸ºä¸€ä¸ª<code>JavaScript</code>ç”¨æˆ·çš„æ—¶å€™ï¼Œå®Œå…¨æ˜¯ä¸çŸ¥é“å®ƒæ˜¯æ€ä¹ˆè¿è¡Œçš„ï¼Œå¯¹å¥½äº›æ¦‚å¿µä¹Ÿæ˜¯â€œçŸ¥å…¶ç„¶ä¸çŸ¥å…¶æ‰€ä»¥ç„¶â€ã€‚  </p>
<p>å¯¹äºå®¢æˆ·ç«¯çš„<code>JavaScript</code>å’Œ<code>Nodejs</code>æ¥è¯´å…¶å®å·®è·ä¸æ˜¯å¾ˆå¤§ï¼Œè¿™å›å°±ä»å®¢æˆ·ç«¯æ–¹é¢æ¥è¯´è¯´<code>Event Loop</code>è¿™ä¸ªæ¦‚å¿µå§ï¼Œç®—æ˜¯<code>å¼‚æ­¥ç¼–ç¨‹</code>çš„ä¸€ä¸ªåˆ‡å…¥ç‚¹å§ã€‚å…¶å®<code>jQuery</code>çš„ä½œè€…John Resigåœ¨å‡ å¹´å‰å°±å†™äº†ä¸€ç¯‡å¥½æ–‡ç« <a href="http://ejohn.org/blog/how-javascript-timers-work/" target="_blank" rel="external">How JavaScript Timers Work</a>ï¼Œæ¥è®²è¿°<code>timer</code>å’Œ<code>äº‹ä»¶</code>åœ¨æµè§ˆå™¨ä¸­æ˜¯æ€æ ·å·¥ä½œçš„ï¼Œæˆ‘ä¹Ÿæ˜¯é€šè¿‡è¿™ç¯‡æ–‡ç« æ‰â€œçŸ¥å…¶æ‰€ä»¥ç„¶â€ã€‚  </p>
<h3 id="é—®é¢˜åœºæ™¯">é—®é¢˜åœºæ™¯</h3><p>å…ˆæ¥çœ‹çœ‹ä¸€æ®µä»£ç ï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#"</span> <span class="attribute">id</span>=<span class="value">"doBtn"</span>&gt;</span>do something<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"status"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><br><span class="line">  <span class="keyword">void</span> <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> doBtn = <span class="built_in">document</span>.getElementById(<span class="string">'doBtn'</span>)</span><br><span class="line">      , status = <span class="built_in">document</span>.getElementById(<span class="string">'status'</span>);</span><br><span class="line"></span><br><span class="line">    doBtn.onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">      e.preventDefault();</span><br><span class="line"></span><br><span class="line">      status.innerText = <span class="string">'doing...please wait...'</span>;  <span class="comment">//å¼€å§‹å•¦</span></span><br><span class="line">      sleep(<span class="number">10000</span>);  <span class="comment">//æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶è¾ƒé•¿çš„è®¡ç®—è¿‡ç¨‹ï¼Œ10s</span></span><br><span class="line">      status.innerText = <span class="string">'done'</span>;  <span class="comment">//å®Œæˆå•¦</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">sleep</span><span class="params">(ms)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> start = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">new</span> <span class="built_in">Date</span>() - start &lt;= ms) &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢ä»£ç ä¸»è¦æƒ³å®Œæˆä¸€ä¸ªåŠŸèƒ½ï¼šæŒ‰é’®è¢«ç‚¹å‡»æ—¶â€”â€”â€”&gt;æ˜¾ç¤ºä¸€ä¸ªçŠ¶æ€å‘ŠçŸ¥ç”¨æˆ·æ­£åœ¨å¹²ä¸€äº›äº‹æƒ…â€”â€”â€”&gt;å¼€å§‹å¹²â€”â€”â€”&gt;äº‹æƒ…å¹²å®ŒåçŠ¶æ€å˜æ›´ä¸ºå·²å®Œæˆã€‚<br><a id="more"></a></p>
<p>çœ‹ä¸Šå»æ²¡é—®é¢˜ï¼Œåº”è¯¥æ˜¯å¯ä»¥å·¥ä½œçš„ï¼Œäºæ˜¯åœ¨æµè§ˆå™¨è¿è¡Œè¿™ä¸ªé¡µé¢ã€‚å¯æ˜¯ç°å®æ€»æ˜¯æ®‹å¿çš„ï¼Œæ²¡æœ‰ç¬¦åˆé¢„æœŸæ•ˆæœã€‚å½“ç‚¹å‡»æŒ‰é’®ä¹‹åï¼Œæµè§ˆå™¨å°±å†»ç»“äº†ï¼Œç”¨äºæ˜¾ç¤ºçŠ¶æ€çš„<code>div</code>å¹¶æ²¡æœ‰æ˜¾ç¤ºï¼Œç•Œé¢ä¸Šä¹Ÿæ²¡æœ‰â€œdoingâ€¦â€è¿™ä¸ªæç¤ºï¼›ç»è¿‡<code>10s</code>ä¹‹åï¼Œæµè§ˆå™¨å›è¿‡ç¥äº†ï¼Œä»£è¡¨è€—æ—¶è¾ƒé•¿çš„è®¡ç®—å·²ç»ç»“æŸï¼Œæ­¤æ—¶ç”¨äºæ˜¾ç¤ºçŠ¶æ€çš„<code>div</code>æ˜¾ç¤ºâ€œdoneâ€ã€‚  </p>
<p>ç©¶å…¶åŸå› ï¼šJavaScriptå¼•æ“æ˜¯å•çº¿ç¨‹çš„ã€‚è€Œæ­¤æ—¶è¿˜æœ‰å¿…è¦å†äº†è§£ä¸‹æµè§ˆå™¨å†…æ ¸éƒ½æœ‰å“ªäº›ä¸»è¦çš„å¸¸é©»çº¿ç¨‹ï¼Œæ‰èƒ½è§£ä¸Šé¢çš„ç–‘æƒ‘ã€‚æµè§ˆå™¨å†…æ ¸å¸¸é©»çº¿ç¨‹å¤§è‡´åŒ…å«ä»¥ä¸‹ï¼š  </p>
<ol>
<li>æµè§ˆå™¨GUIæ¸²æŸ“çº¿ç¨‹</li>
<li>JavaScriptå¼•æ“çº¿ç¨‹</li>
<li>æµè§ˆå™¨å®šæ—¶è§¦å‘å™¨çº¿ç¨‹</li>
<li>æµè§ˆå™¨äº‹ä»¶è§¦å‘çº¿ç¨‹</li>
<li>æµè§ˆå™¨httpå¼‚æ­¥è¯·æ±‚çº¿ç¨‹</li>
</ol>
<p>è€ŒGUIæ¸²æŸ“çº¿ç¨‹å’ŒJavaScriptå¼•æ“çº¿ç¨‹æ˜¯äº’æ–¥çš„ï¼ŒJavaScriptæ‰§è¡Œæ—¶GUIæ¸²æŸ“çº¿ç¨‹æ˜¯æŒ‚èµ·çš„ï¼Œé¡µé¢å°†åœæ­¢ä¸€åˆ‡çš„è§£æå’Œæ¸²æŸ“è¡Œä¸ºã€‚ä¸Šé¢çš„3ã€4ã€5ç±»çº¿ç¨‹ä¹Ÿä¼šäº§ç”Ÿä¸åŒçš„å¼‚æ­¥äº‹ä»¶ã€‚çœ‹ä¸‹é¢è¿™å¼ å›¾å°±åº”è¯¥æ¯”è¾ƒç›´è§‚äº†ã€‚</p>
<p><img src="http://img.heroicyang.com/js-event-loop.png" alt="JavaScript-Event-Loop"></p>
<p>å› ä¸ºJavaScriptå¼•æ“æ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥ä»£ç éƒ½æ˜¯å…ˆå‹åˆ°é˜Ÿåˆ—ï¼Œç„¶åç”±å¼•æ“é‡‡ç”¨å…ˆè¿›å…ˆå‡ºçš„æ–¹å¼è¿è¡Œã€‚äº‹ä»¶å¤„ç†å‡½æ•°ã€timeræ‰§è¡Œå‡½æ•°ä¹Ÿä¼šæ’åˆ°è¿™ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç„¶ååˆ©ç”¨ä¸€ä¸ªæ— ç©·å›åœˆï¼Œä¸æ–­ä»é˜Ÿå¤´å–å‡ºå‡½æ•°æ‰§è¡Œï¼Œè¿™ä¸ªå°±æ˜¯<code>Event Loop</code>ã€‚  </p>
<p>æ¥ä¸‹æ¥è¿˜æ˜¯ç»§ç»­ç”¨å›¾æ¥è¯´æ˜ä¸Šé¢çš„ä»£ç ä¸ºä»€ä¹ˆæ²¡æœ‰è¾¾åˆ°é¢„æœŸæ•ˆæœã€‚</p>
<p><img src="http://img.heroicyang.com/js-event-loop-1.png" alt=""></p>
<p>äºæ˜¯ç»“æœå°±åªçœ‹åˆ°äº†â€doneâ€ã€‚  </p>
<h3 id="æ€æ ·è§£å†³ï¼Ÿ">æ€æ ·è§£å†³ï¼Ÿ</h3><p>ä½¿ç”¨<code>setTimeout()</code>ï¼Œä¸‹é¢æ˜¯ä¿®æ”¹åçš„<code>onclick</code>äº‹ä»¶å¤„ç†å‡½æ•°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">doBtn.onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line"></span><br><span class="line">  status.innerText = <span class="string">'doing...please wait...'</span>;  <span class="comment">//å¼€å§‹å•¦</span></span><br><span class="line">  </span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    sleep(<span class="number">10000</span>);  <span class="comment">//æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶è¾ƒé•¿çš„è®¡ç®—è¿‡ç¨‹ï¼Œ10s</span></span><br><span class="line">    status.innerText = <span class="string">'done'</span>;  <span class="comment">//å®Œæˆå•¦</span></span><br><span class="line">  &#125;, <span class="number">0</span>);  <span class="comment">// 0ms delay</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆè¿™æ ·å°±è§£å†³äº†å‘¢ï¼Ÿè¿˜æ˜¯ç”¨ä¸Šé¢çš„é˜Ÿåˆ—çš„å›¾æ¥è§£é‡Šã€‚</p>
<p><img src="http://img.heroicyang.com/js-event-loop-2.png" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æœ€è¿‘åœ¨å­¦ä¹ <code>Nodejs</code>çš„è¿‡ç¨‹ä¸­æ·±å…¥çš„äº†è§£äº†<code>å¼‚æ­¥ç¼–ç¨‹</code>è¿™ä¸ªæ¦‚å¿µï¼Œä¸ºäº†æ›´å¥½çš„ä½¿ç”¨<code>Nodejs</code>ï¼Œè¿™äº›æ¦‚å¿µä¸å¯ä¸çŸ¥ã€‚åœ¨ä»¥å‰ä½œä¸ºä¸€ä¸ª<code>JavaScript</code>ç”¨æˆ·çš„æ—¶å€™ï¼Œå®Œå…¨æ˜¯ä¸çŸ¥é“å®ƒæ˜¯æ€ä¹ˆè¿è¡Œçš„ï¼Œå¯¹å¥½äº›æ¦‚å¿µä¹Ÿæ˜¯â€œçŸ¥å…¶ç„¶ä¸çŸ¥å…¶æ‰€ä»¥ç„¶â€ã€‚  </p>
<p>å¯¹äºå®¢æˆ·ç«¯çš„<code>JavaScript</code>å’Œ<code>Nodejs</code>æ¥è¯´å…¶å®å·®è·ä¸æ˜¯å¾ˆå¤§ï¼Œè¿™å›å°±ä»å®¢æˆ·ç«¯æ–¹é¢æ¥è¯´è¯´<code>Event Loop</code>è¿™ä¸ªæ¦‚å¿µå§ï¼Œç®—æ˜¯<code>å¼‚æ­¥ç¼–ç¨‹</code>çš„ä¸€ä¸ªåˆ‡å…¥ç‚¹å§ã€‚å…¶å®<code>jQuery</code>çš„ä½œè€…John Resigåœ¨å‡ å¹´å‰å°±å†™äº†ä¸€ç¯‡å¥½æ–‡ç« <a href="http://ejohn.org/blog/how-javascript-timers-work/">How JavaScript Timers Work</a>ï¼Œæ¥è®²è¿°<code>timer</code>å’Œ<code>äº‹ä»¶</code>åœ¨æµè§ˆå™¨ä¸­æ˜¯æ€æ ·å·¥ä½œçš„ï¼Œæˆ‘ä¹Ÿæ˜¯é€šè¿‡è¿™ç¯‡æ–‡ç« æ‰â€œçŸ¥å…¶æ‰€ä»¥ç„¶â€ã€‚  </p>
<h3 id="é—®é¢˜åœºæ™¯">é—®é¢˜åœºæ™¯</h3><p>å…ˆæ¥çœ‹çœ‹ä¸€æ®µä»£ç ï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#"</span> <span class="attribute">id</span>=<span class="value">"doBtn"</span>&gt;</span>do something<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"status"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><br><span class="line">  <span class="keyword">void</span> <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> doBtn = <span class="built_in">document</span>.getElementById(<span class="string">'doBtn'</span>)</span><br><span class="line">      , status = <span class="built_in">document</span>.getElementById(<span class="string">'status'</span>);</span><br><span class="line"></span><br><span class="line">    doBtn.onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span><br><span class="line">      e.preventDefault();</span><br><span class="line"></span><br><span class="line">      status.innerText = <span class="string">'doing...please wait...'</span>;  <span class="comment">//å¼€å§‹å•¦</span></span><br><span class="line">      sleep(<span class="number">10000</span>);  <span class="comment">//æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶è¾ƒé•¿çš„è®¡ç®—è¿‡ç¨‹ï¼Œ10s</span></span><br><span class="line">      status.innerText = <span class="string">'done'</span>;  <span class="comment">//å®Œæˆå•¦</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">sleep</span><span class="params">(ms)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> start = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">new</span> <span class="built_in">Date</span>() - start &lt;= ms) &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢ä»£ç ä¸»è¦æƒ³å®Œæˆä¸€ä¸ªåŠŸèƒ½ï¼šæŒ‰é’®è¢«ç‚¹å‡»æ—¶â€”â€”â€”&gt;æ˜¾ç¤ºä¸€ä¸ªçŠ¶æ€å‘ŠçŸ¥ç”¨æˆ·æ­£åœ¨å¹²ä¸€äº›äº‹æƒ…â€”â€”â€”&gt;å¼€å§‹å¹²â€”â€”â€”&gt;äº‹æƒ…å¹²å®ŒåçŠ¶æ€å˜æ›´ä¸ºå·²å®Œæˆã€‚<br>]]>
    
    </summary>
    
      <category term="event-loop" scheme="http://heroicyang.com/tags/event-loop/"/>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
      <category term="javascript timer" scheme="http://heroicyang.com/tags/javascript-timer/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[åƒé»‘å®¢ä¸€æ ·å†™åšå®¢]]></title>
    <link href="http://heroicyang.com/2012/08/26/blogging-like-a-hacker/"/>
    <id>http://heroicyang.com/2012/08/26/blogging-like-a-hacker/</id>
    <published>2012-08-26T15:24:00.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>â€œåƒé»‘å®¢ä¸€æ ·å†™åšå®¢â€ï¼Œè¿™ä¸ªæ ‡é¢˜æ˜¯ç½‘ç»œä¸Šå¯¹<code>Octopress</code>ï¼ˆå…¶å®åº”è¯¥æ˜¯<code>Jekyll</code>ï¼‰çš„è¯„ä»·ï¼Œè€Œè¿™ä¸€è¯„ä»·æ˜¯æ¥è‡ªä¸€ç¯‡å‡ å¹´å‰çš„<a href="http://tom.preston-werner.com/2008/11/17/blogging-like-a-hacker.html" target="_blank" rel="external">æ–‡ç« </a>ã€‚å½“æˆ‘å°†è‡ªå·±çš„åšå®¢æŠ¹æ‰å¹¶é‡æ–°å¼€å§‹çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿå‡†å¤‡ä»¥è¿™ä¸ªæ ‡é¢˜æ¥ä½œä¸ºè¿™æ¬¡çš„æ–°èµ·ç‚¹ã€‚  </p>
<p>å…¶å®æ—©å°±æœ‰æ¢æ‰<code>WordPress</code>çš„æƒ³æ³•ï¼Œä¸€æ˜¯å› ä¸ºå®ƒå¤ªè‡ƒè‚¿äº†ï¼Œæˆ‘åªæ˜¯æƒ³ç®€å•çš„å†™å†™åšå®¢ï¼Œç”¨ä¸ç€é‚£ä¹ˆå¤šå¼ºå¤§çš„åŠŸèƒ½ï¼›äºŒæ˜¯å®ƒå¯¹æ’å…¥ä»£ç çš„æ”¯æŒè®©æˆ‘ç»æœ›äº†ï¼Œæ¯æ¬¡ç”¨<code>Markdown</code>å†™å¥½æ–‡ç« ï¼Œå¤åˆ¶å…¶<code>HTML</code>åˆ°<code>WordPress</code>ä¹‹åï¼Œéƒ½è¦è°ƒæ•´å¥½åŠå¤©çš„æ ·å¼ï¼›ä¸‰æ˜¯æˆ‘ä¹‹å‰çš„åšå®¢ä¸­å¤ªå¤šçš„ç¢ç¢å¿µä¹‹ç±»çš„æ°´æ–‡äº†ï¼Œå¯è°“æ‚ã€ä¹±ï¼Œå¹¶ä¸åƒä¸€ä¸ªè®°å½•æŠ€æœ¯çš„åšå®¢ã€‚ç»¼åˆè¿™äº›å€Ÿå£ï¼Œæˆ‘æ¯æ¬¡ç™»å½•åˆ°<code>WordPress</code>åå°éƒ½æ²¡æœ‰å†å†™æ–‡ç« çš„æ¿€æƒ…ã€‚<br><a id="more"></a><br>è€Œä¹‹å‰æˆ‘ä¹Ÿå’Œ<a href="http://veryb.us/" target="_blank" rel="external">fiture</a>èŠåˆ°ç”¨<a href="http://heroicyang.com/tags/nodejs/" target="_blank" rel="external">Nodejs</a>æ¥é‡æ–°å†™ä¸ªåšå®¢ï¼Œä¹Ÿå½“å­¦ä¹ ç»ƒæ‰‹ã€‚ç»è¿‡é—´æ­‡æ€§çš„èŠèŠä¹‹åï¼Œæˆ‘æè®®è¯´ä¸å¼„æ•°æ®åº“äº†ï¼Œç›´æ¥å°†æ–‡ç« ä»¥<code>Markdown</code>çš„æ ¼å¼<code>push</code>åˆ°<code>Github</code>å§ç­‰ç­‰çš„åˆæ­¥æƒ³æ³•ã€‚å½“æ—¶æˆ‘ä»¬è§‰å¾—è¿˜ä¸é”™ï¼Œå› ä¸ºä¹Ÿæ²¡äº†è§£è¿‡æœ‰æ²¡æœ‰è¿™æ ·çš„ä¸œè¥¿å­˜åœ¨ï¼Œä¹‹åæˆ‘ä¸‹æ„è¯†åœ°æœäº†ä¸‹ã€‚ç»“æœå‘ç°äº†<code>OctoPress</code>è¿™ä¸ªä¸œè¥¿ï¼Œäº†è§£ä¹‹åæ„Ÿè§‰å®Œå…¨æ­£åˆæˆ‘æ„å•Šï¼Œæ‰€ä»¥äºŒè¯ä¸è¯´å°±ç›´æ¥ç»™æ¢ä¸Šäº†ã€‚  </p>
<p>äºæ˜¯æˆ‘æ€»ç®—æ˜¯ç»ˆäºå¼ƒæ‰äº†<code>WordPress</code>ï¼Œç”¨ä¸Š<code>Octopress</code>è¿™ä¸ªé«˜çº§è´§ï¼Œå¯è°“å¾—å¿ƒåº”æ‰‹ã€‚  </p>
<p>å…¶å®æˆ‘ä¹Ÿå°±å†²ç€æˆ‘è®¤ä¸ºçš„è¿™å‡ ç‚¹ä¼˜åŠ¿ï¼š</p>
<ol>
<li>ç›´æ¥ä½¿ç”¨<code>Markdown</code>å†™æ–‡ç« </li>
<li>å…¨ç«™é™æ€åŒ–ï¼Œæ ¹æ®<code>Markdown</code>ç”Ÿæˆæ–‡ç« çš„é™æ€é¡µé¢</li>
<li>æ‰€ä»¥ç›´æ¥åœ¨<code>Terminal</code>æŠŠæ–‡ç« <code>push</code>åˆ°æˆ‘çš„<a href="https://github.com/heroicYang/heroicyang.com" target="_blank" rel="external">Github</a>ä¸Šå³å¯ï¼Œæœ‰ç‰ˆæœ¬ç®¡ç†çœŸå¥½</li>
<li>ç„¶ååŠ ä¹‹<code>Github Page</code>çš„æ”¯æŒï¼Œè™½ç„¶æœ‰ä¸€äº›äº›å°é—®é¢˜ï¼Œæ¯”å¦‚<code>ç¼“å­˜</code>ï¼Œä½†ç‘•ä¸æ©ç‘œ</li>
<li>æ•´ä¸ªå†™ä½œè¿‡ç¨‹å’Œå†™ä»£ç çš„è¿‡ç¨‹æ˜¯ä¸€è‡´çš„ï¼Œç¬¦åˆç å†œçš„è¡Œä¸ºä¹ æƒ¯ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œåƒé»‘å®¢ä¸€æ ·å†™åšå®¢â€</li>
</ol>
<p>è¿™æ ·ï¼Œå°±åªéœ€è¦ä¸€ä¸ª<code>Markdown</code>ç¼–è¾‘å™¨ï¼ˆæ¨è<a href="http://mouapp.com/" target="_blank" rel="external">Mou</a>å’Œ<a href="http://www.sublimetext.com/2" target="_blank" rel="external">Sublime Text 2</a>ï¼‰ï¼Œå†é…åˆç»ˆç«¯çš„<code>git</code>å‘½ä»¤å°±OKäº†ï¼Œå…¶ä½™çš„éƒ½ä¸ç”¨ç®¡äº†ï¼Œäº¤ç»™ç¬¬ä¸‰æ–¹å»ã€‚æ¯”å¦‚ï¼šè¯„è®ºç³»ç»Ÿæˆ‘å°±é‡‡ç”¨äº†å›½å†…çš„<a href="http://duoshuo.com/" target="_blank" rel="external">å¤šè¯´</a>ï¼›ç„¶åç”¨<a href="http://dropbox.com/" target="_blank" rel="external">Dropbox</a>æ¥ä¿å­˜æ–‡ç« ä¸­ä¼šç”¨åˆ°çš„å›¾ç‰‡ï¼Œå› ä¸º<code>Dropbox</code>è¢«<code>GFW</code>è®¤è¯ï¼Œæ‰€ä»¥å†åˆ©ç”¨<a href="http://en.wikipedia.org/wiki/Nginx" target="_blank" rel="external">Nginx</a>åšä¸ª<a href="http://en.wikipedia.org/wiki/Reverse_proxy" target="_blank" rel="external">åå‘ä»£ç†</a>ã€‚ä¸€åˆ‡éƒ½å¦¥å¦¥çš„äº†ã€‚  </p>
<p>ä»¥å‰åšå®¢çš„é‚£äº›åºŸæŸ´æ–‡ç« éƒ½ä¸è¦äº†ï¼Œä¸è¿‡è¿˜æ˜¯åšäº†ä¸ªå¤‡ä»½ï¼Œç®—æ˜¯çºªå¿µå¥½äº†ã€‚è€ŒæŠŠè¿‘æœŸå†™çš„3ç¯‡ä¸<a href="http://heroicyang.com/tags/javascript/" target="_blank" rel="external">JavaScript</a>ç›¸å…³çš„æ–‡ç« è½¬ç§»äº†è¿‡æ¥ï¼Œé‡æ–°å¼€å§‹æŠ€æœ¯åšå®¢çš„å†ç¨‹ï¼Œè§è¯æˆé•¿ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>â€œåƒé»‘å®¢ä¸€æ ·å†™åšå®¢â€ï¼Œè¿™ä¸ªæ ‡é¢˜æ˜¯ç½‘ç»œä¸Šå¯¹<code>Octopress</code>ï¼ˆå…¶å®åº”è¯¥æ˜¯<code>Jekyll</code>ï¼‰çš„è¯„ä»·ï¼Œè€Œè¿™ä¸€è¯„ä»·æ˜¯æ¥è‡ªä¸€ç¯‡å‡ å¹´å‰çš„<a href="http://tom.preston-werner.com/2008/11/17/blogging-like-a-hacker.html">æ–‡ç« </a>ã€‚å½“æˆ‘å°†è‡ªå·±çš„åšå®¢æŠ¹æ‰å¹¶é‡æ–°å¼€å§‹çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿå‡†å¤‡ä»¥è¿™ä¸ªæ ‡é¢˜æ¥ä½œä¸ºè¿™æ¬¡çš„æ–°èµ·ç‚¹ã€‚  </p>
<p>å…¶å®æ—©å°±æœ‰æ¢æ‰<code>WordPress</code>çš„æƒ³æ³•ï¼Œä¸€æ˜¯å› ä¸ºå®ƒå¤ªè‡ƒè‚¿äº†ï¼Œæˆ‘åªæ˜¯æƒ³ç®€å•çš„å†™å†™åšå®¢ï¼Œç”¨ä¸ç€é‚£ä¹ˆå¤šå¼ºå¤§çš„åŠŸèƒ½ï¼›äºŒæ˜¯å®ƒå¯¹æ’å…¥ä»£ç çš„æ”¯æŒè®©æˆ‘ç»æœ›äº†ï¼Œæ¯æ¬¡ç”¨<code>Markdown</code>å†™å¥½æ–‡ç« ï¼Œå¤åˆ¶å…¶<code>HTML</code>åˆ°<code>WordPress</code>ä¹‹åï¼Œéƒ½è¦è°ƒæ•´å¥½åŠå¤©çš„æ ·å¼ï¼›ä¸‰æ˜¯æˆ‘ä¹‹å‰çš„åšå®¢ä¸­å¤ªå¤šçš„ç¢ç¢å¿µä¹‹ç±»çš„æ°´æ–‡äº†ï¼Œå¯è°“æ‚ã€ä¹±ï¼Œå¹¶ä¸åƒä¸€ä¸ªè®°å½•æŠ€æœ¯çš„åšå®¢ã€‚ç»¼åˆè¿™äº›å€Ÿå£ï¼Œæˆ‘æ¯æ¬¡ç™»å½•åˆ°<code>WordPress</code>åå°éƒ½æ²¡æœ‰å†å†™æ–‡ç« çš„æ¿€æƒ…ã€‚<br>]]>
    
    </summary>
    
      <category term="blog" scheme="http://heroicyang.com/tags/blog/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[JavaScriptä¸­åˆ›å»ºç±»çš„æ–¹å¼]]></title>
    <link href="http://heroicyang.com/2012/08/19/create-class-in-javascript/"/>
    <id>http://heroicyang.com/2012/08/19/create-class-in-javascript/</id>
    <published>2012-08-18T17:05:00.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>ç°åœ¨<code>JavaScript</code>è¿™é—¨æŠ€æœ¯å·²ç»åˆ°äº†ä¸€ä¸ªå¼•çˆ†ç‚¹ï¼Œä¸€å¹´å‰æˆ‘å¯¹å®ƒçš„äº†è§£éƒ½åªåœç•™åœ¨è‚¤æµ…çš„ç½‘é¡µå®¢æˆ·ç«¯è„šæœ¬è¯­è¨€ï¼Œåªä¼šç®€å•çš„ç©ç©<code>jQuery</code>å’Œ<code>ExtJs</code>ï¼Œå…¶å®éƒ½ç®—ä¸ä¸Šå¼€å‘è€…ï¼Œè€Œæ˜¯ä¸€ä¸ª<code>JavaScript</code>ç”¨æˆ·ã€‚ä½†ä»Šå¹´çš„ç›®æ ‡æ˜¯åšä¸€ä¸ªåˆæ ¼çš„å‰ç«¯æ”»åŸæ¹¿ï¼Œæ‰€ä»¥æ¶è¡¥æ˜¯å¿…é¡»çš„ã€‚  </p>
<p>åœ¨<code>JavaScript</code>ä¸­æ˜¯å…¶å®ä¸å­˜åœ¨æ‰€è°“â€œç±»â€çš„æ¦‚å¿µï¼Œå› ä¸ºå®ƒå¹¶ä¸æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ã€‚åœ¨é¢å‘å¯¹è±¡ä¸­ï¼Œä¸€ä¸ªæœ€å¸¸è§çš„è¯´æ³•å°±æ˜¯ï¼šâ€œç±»â€æ˜¯â€œå¯¹è±¡â€çš„æ¨¡æ¿ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯é‡‡ç”¨è¯­è¨€å†…ç½®çš„<code>Class</code>æˆ–<code>class</code>å…³é”®å­—æ¥å®šä¹‰â€œç±»â€ã€‚è€Œ<code>JavaScript</code>ä¸å­˜åœ¨è¿™ä¸ªæ¦‚å¿µï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰æä¾›ç±»ä¼¼çš„å…³é”®å­—ï¼ˆè™½ç„¶<code>class</code>æ˜¯<code>JavaScript</code>çš„å…³é”®å­—ï¼Œä½†æ˜¯è‡³ä»Šéƒ½æ²¡æœ‰å®ç°ï¼Œåªæ˜¯è¢«ä¿ç•™è€Œå·²ï¼‰ã€‚  </p>
<p>å› æ­¤ï¼Œåœ¨<code>JavaScript</code>ä¸­åˆ›å»ºç±»å°±å”¯æœ‰ä½¿ç”¨æ¨¡æ‹Ÿçš„æ–¹å¼ï¼Œè€Œæ¨¡æ‹Ÿçš„æ‰‹æ³•å¤šç§å¤šæ ·ï¼Œä½•æ—¶é‡‡ç”¨ä½•ç§æ–¹å¼æœ€åˆé€‚ï¼Œéœ€è§†æƒ…å†µè€Œå®šã€‚ä»¥ä¸‹å°±è®°å½•ä¸‹å¸¸è§çš„å‡ ç§æ¨¡å¼ã€‚<br><a id="more"></a></p>
<h3 id="ä¸€-å·¥å‚æ¨¡å¼">ä¸€.å·¥å‚æ¨¡å¼</h3><p>å·¥å‚æ–¹æ³•æ˜¯è®¾è®¡æ¨¡å¼ä¸­éå¸¸åŸºç¡€çš„ï¼Œä¹Ÿè¢«å¹¿æ³›ç”¨äºé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ã€‚è€Œåœ¨<code>JavaScript</code>ä¸­ï¼Œé€šè¿‡å·¥å‚æ–¹æ³•å³èƒ½æ¨¡æ‹Ÿå‡ºç±»çš„è¡Œä¸ºã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPerson</span><span class="params">(name, sex, â€¦)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">  obj.name = name;</span><br><span class="line">  obj.sex = sex;</span><br><span class="line">  â€¦</span><br><span class="line">  obj.getName = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> personA = createPerson(<span class="string">'heroicYang'</span>, <span class="string">'male'</span>);</span><br><span class="line"><span class="keyword">var</span> personB = createPerosn(<span class="string">'è·¯äººç”²'</span>, <span class="string">'male'</span>);</span><br></pre></td></tr></table></figure><br>é€šè¿‡è¿™æ ·ç±»ä¼¼çš„å·¥å‚æ–¹æ³•ï¼Œå°±å¯ä»¥åˆ›å»ºå‡ºå¤šä¸ªç›¸ä¼¼çš„å¯¹è±¡äº†ï¼Œä½†æ˜¯è¿™æ ·çš„æ–¹å¼å…¶æŠ½è±¡åº¦æä½ã€‚é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œå¯¹è±¡æ˜¯å¯ä»¥æ£€æµ‹å‡ºç±»å‹çš„ï¼Œä½†æ˜¯é‡‡ç”¨ä¸Šé¢è¿™ç§æ–¹å¼ï¼Œæ˜¯æ²¡æœ‰åŠæ³•è¿›è¡Œå¯¹è±¡ç±»å‹è¯†åˆ«çš„ã€‚</p>
<h3 id="äºŒ-æ„é€ å‡½æ•°æ¨¡å¼">äºŒ.æ„é€ å‡½æ•°æ¨¡å¼</h3><p>å…¶å®ï¼Œè¿™åº”è¯¥æ˜¯å¾ˆå¸¸è§çš„æ¨¡å¼äº†ï¼Œå¾ˆå¤šä¹¦ä¸ŠåŸºæœ¬ä¸Šä¸€æ¥å°±æ˜¯è®²è¿™ä¸ªçš„ï¼Œæ›´ç‹ ç‚¹çš„å¯èƒ½å°±åªè®²è¿™ä¸ªâ€¦<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span><span class="params">(name, sex)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.sex = sex;</span><br><span class="line">  â€¦</span><br><span class="line">  <span class="keyword">this</span>.getName = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> personA = <span class="keyword">new</span> Person(<span class="string">'heroic'</span>, <span class="string">'male'</span>);</span><br><span class="line"><span class="keyword">var</span> personB = <span class="keyword">new</span> Person(<span class="string">'è·¯äººç”²'</span>, <span class="string">'male'</span>);</span><br></pre></td></tr></table></figure><br>è¿™ç§æ¨¡æ‹Ÿç±»æ–¹å¼çš„ç‰¹ç‚¹å°±æ˜¯:</p>
<ol>
<li>æ²¡æœ‰æ˜¾ç¤ºçš„åˆ›å»ºå¯¹è±¡   </li>
<li>ç›´æ¥å°†å±æ€§å’Œæ–¹æ³•èµ‹ç»™äº†<code>this</code>å¯¹è±¡    </li>
<li>æ²¡æœ‰<code>return</code>å­—å¥</li>
</ol>
<p>åœ¨ä½¿ç”¨è¿™ç§æ–¹å¼æ—¶ï¼Œåˆ›å»ºå¯¹è±¡åˆ™å¿…é¡»ä½¿ç”¨<code>new</code>å…³é”®å­—ã€‚å½“ç„¶ï¼Œå¥½å¤„å°±æ˜¯å®Œå…¨è§£å†³äº†å¯¹è±¡ç±»å‹è¯†åˆ«é—®é¢˜ã€‚</p>
<h3 id="ä¸‰-åŸå‹æ¨¡å¼">ä¸‰.åŸå‹æ¨¡å¼</h3><p>åŸå‹åº”è¯¥æ˜¯<code>JavaScript</code>ä¸­ä¸€ä¸ªå¾ˆæœ‰æ„æ€ï¼Œå½“ç„¶ä¹Ÿæ˜¯å¾ˆæœ‰ç”¨çš„ä¸€ä¸ªæ¦‚å¿µäº†ã€‚æ¥ä¸‹æ¥ç”¨åŸå‹æ¨¡å¼æ¥æ¨¡æ‹Ÿç±»ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">  name: <span class="literal">null</span>,</span><br><span class="line">  sex: <span class="literal">null</span>,</span><br><span class="line">  getName: <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> personA = <span class="keyword">new</span> Person;</span><br><span class="line">personA.name = <span class="string">'heroic'</span>;</span><br><span class="line">personA.sex = <span class="string">'male'</span>;</span><br><span class="line"><span class="keyword">var</span> personB = <span class="keyword">new</span> Person;</span><br><span class="line">personB.name = <span class="string">'è·¯äººç”²'</span>;</span><br><span class="line">personB.sex = <span class="string">'male'</span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="å››-ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°å’ŒåŸå‹æ¨¡å¼">å››.ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°å’ŒåŸå‹æ¨¡å¼</h3><p>ç”±äºåªç”¨åŸå‹æ¨¡å¼çš„è¯ï¼Œä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼Œæ‰€ä»¥å¸¸è§„æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯é‡‡ç”¨ç»„åˆæ„é€ å‡½æ•°å’ŒåŸå‹æ¨¡å¼æ¥åˆ›å»ºç±»ï¼Œè¿™ä¹Ÿæ˜¯ä½¿ç”¨ç‡æœ€é«˜çš„ä¸€ç§æ–¹å¼ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span><span class="params">(name, sex)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.sex = sex;</span><br><span class="line">  â€¦</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.getName = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">&#125;;</span><br><span class="line">â€¦</span><br><span class="line"><span class="keyword">var</span> personA = <span class="keyword">new</span> Person(<span class="string">'heroic'</span>, <span class="string">'male'</span>);</span><br><span class="line"><span class="keyword">var</span> personB = <span class="keyword">new</span> Person(<span class="string">'è·¯äººç”²'</span>, <span class="string">'male'</span>);</span><br><span class="line">personA.getName(); <span class="comment">//"heroic"</span></span><br><span class="line">personB.getName(); <span class="comment">//"è·¯äººç”²"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="äº”-å¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼">äº”.å¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼</h3><p>è¿™ç§æ¨¡å¼å’Œå·¥å‚æ¨¡å¼éå¸¸ç›¸ä¼¼ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SpecialArray</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> values = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">  values.push.apply(values, <span class="built_in">arguments</span>);</span><br><span class="line">    </span><br><span class="line">  values.toPipString = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.join(<span class="string">'|'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> values;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> test = <span class="keyword">new</span> SpecialArray(<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>);</span><br><span class="line">test.toPipString(); <span class="comment">// "1|2|3"</span></span><br></pre></td></tr></table></figure><br>è¿™ç§æ¨¡å¼ä¸»è¦ç”¨æ¥æ‰©å±•ä¸€äº›å¯¹è±¡çš„è¡Œä¸ºï¼Œè€Œåˆä¸ä¼šå¯¹è¿™ä¸ªå¯¹è±¡é€ æˆæ±¡æŸ“ã€‚å½“ç„¶ï¼Œä¸Šé¢çš„ä»£ç ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥ä¸º<code>Array.prototype</code>åŸå‹å¯¹è±¡æ·»åŠ ä¸€ä¸ª<code>toPipString()</code>æ–¹æ³•æ¥å®Œæˆçš„ï¼Œä½†æ˜¯è¿™æ ·å°±é€ æˆäº†å¯¹<code>JavaScript</code>åŸç”Ÿå¯¹è±¡çš„æ±¡æŸ“ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ç°åœ¨<code>JavaScript</code>è¿™é—¨æŠ€æœ¯å·²ç»åˆ°äº†ä¸€ä¸ªå¼•çˆ†ç‚¹ï¼Œä¸€å¹´å‰æˆ‘å¯¹å®ƒçš„äº†è§£éƒ½åªåœç•™åœ¨è‚¤æµ…çš„ç½‘é¡µå®¢æˆ·ç«¯è„šæœ¬è¯­è¨€ï¼Œåªä¼šç®€å•çš„ç©ç©<code>jQuery</code>å’Œ<code>ExtJs</code>ï¼Œå…¶å®éƒ½ç®—ä¸ä¸Šå¼€å‘è€…ï¼Œè€Œæ˜¯ä¸€ä¸ª<code>JavaScript</code>ç”¨æˆ·ã€‚ä½†ä»Šå¹´çš„ç›®æ ‡æ˜¯åšä¸€ä¸ªåˆæ ¼çš„å‰ç«¯æ”»åŸæ¹¿ï¼Œæ‰€ä»¥æ¶è¡¥æ˜¯å¿…é¡»çš„ã€‚  </p>
<p>åœ¨<code>JavaScript</code>ä¸­æ˜¯å…¶å®ä¸å­˜åœ¨æ‰€è°“â€œç±»â€çš„æ¦‚å¿µï¼Œå› ä¸ºå®ƒå¹¶ä¸æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ã€‚åœ¨é¢å‘å¯¹è±¡ä¸­ï¼Œä¸€ä¸ªæœ€å¸¸è§çš„è¯´æ³•å°±æ˜¯ï¼šâ€œç±»â€æ˜¯â€œå¯¹è±¡â€çš„æ¨¡æ¿ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯é‡‡ç”¨è¯­è¨€å†…ç½®çš„<code>Class</code>æˆ–<code>class</code>å…³é”®å­—æ¥å®šä¹‰â€œç±»â€ã€‚è€Œ<code>JavaScript</code>ä¸å­˜åœ¨è¿™ä¸ªæ¦‚å¿µï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰æä¾›ç±»ä¼¼çš„å…³é”®å­—ï¼ˆè™½ç„¶<code>class</code>æ˜¯<code>JavaScript</code>çš„å…³é”®å­—ï¼Œä½†æ˜¯è‡³ä»Šéƒ½æ²¡æœ‰å®ç°ï¼Œåªæ˜¯è¢«ä¿ç•™è€Œå·²ï¼‰ã€‚  </p>
<p>å› æ­¤ï¼Œåœ¨<code>JavaScript</code>ä¸­åˆ›å»ºç±»å°±å”¯æœ‰ä½¿ç”¨æ¨¡æ‹Ÿçš„æ–¹å¼ï¼Œè€Œæ¨¡æ‹Ÿçš„æ‰‹æ³•å¤šç§å¤šæ ·ï¼Œä½•æ—¶é‡‡ç”¨ä½•ç§æ–¹å¼æœ€åˆé€‚ï¼Œéœ€è§†æƒ…å†µè€Œå®šã€‚ä»¥ä¸‹å°±è®°å½•ä¸‹å¸¸è§çš„å‡ ç§æ¨¡å¼ã€‚<br>]]>
    
    </summary>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
      <category term="javascript class" scheme="http://heroicyang.com/tags/javascript-class/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Backboneä¹‹æ—…ï¼šå‰ç«¯MVCæ¶æ„åˆä½“éªŒï¼ˆä¸‹ï¼‰]]></title>
    <link href="http://heroicyang.com/2012/08/09/to-backbone-tutorial-2/"/>
    <id>http://heroicyang.com/2012/08/09/to-backbone-tutorial-2/</id>
    <published>2012-08-08T16:59:00.000Z</published>
    <updated>2014-04-30T13:01:25.000Z</updated>
    <content type="html"><![CDATA[<p>ç»§<a href="http://heroicyang.com/2012/08/08/to-backbone-tutorial-1" target="_blank" rel="external">ã€ŠBackboneä¹‹æ—…ï¼šå‰ç«¯MVCæ¶æ„åˆä½“éªŒï¼ˆä¸Šï¼‰ã€‹</a>ï¼Œä¸Šç¯‡ä¸­æœ€åçš„ä»£ç å·²ç»å®Œå…¨è¾¾åˆ°æœ€åˆæå‡ºçš„å‡ ç‚¹è¦æ±‚ï¼Œç°åœ¨å°±ç»“åˆ<code>Backbone</code>æä¾›çš„èƒ½åŠ›ï¼Œæ¥ç»§ç»­ç²¾ç®€ä»£ç ã€‚æœ€åçš„ç›®æ ‡å°±æ˜¯å°†ä¸Šç¯‡ä¸­çš„ä»£ç å…¨éƒ¨é‡æ„ä¸º<code>Backbone</code>çš„<code>MVC</code>æ¨¡å¼ã€‚  </p>
<p>ä¸Šç¯‡ä¸­æœ€åä¸€æ¬¡æ”¹é€ å°±å·²ç»ä½¿ç”¨åˆ°äº†<code>callback</code>çš„æ–¹å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬ç´¢æ€§å†åŠ ä¸Š<code>Event</code>æœºåˆ¶å§ï¼Œå› ä¸º<code>Backbone</code>å†…ç½®äº†è¿™ä¸ªèƒ½åŠ›ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> events = _.clone(Backbone.Events);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TodoList = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">TodoList.prototype.add = <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">  $.ajax(&#123;</span><br><span class="line">    url: <span class="string">'/add'</span>,</span><br><span class="line">    type: <span class="string">'POST'</span>,</span><br><span class="line">    dataType: <span class="string">'json'</span>,</span><br><span class="line">    data: &#123; todoContent: options.todoContent &#125;,</span><br><span class="line">    success: options.success</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> NewTodoView = <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.todoList = options.todoList;</span><br><span class="line"></span><br><span class="line">  events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.appendTodo, <span class="keyword">this</span>);</span><br><span class="line">  events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.clearTextArea, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">  $(<span class="string">'#new-todo form'</span>).submit($.proxy(<span class="keyword">this</span>.addTodo, <span class="keyword">this</span>));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">NewTodoView.prototype.addTodo = <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.todoList.add(&#123;</span><br><span class="line">    todoContent: $(<span class="string">'#new-todo'</span>).find(<span class="string">'textarea'</span>).val(),</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span><span class="params">(data)</span></span>&#123;</span><br><span class="line">      events.trigger(<span class="string">'todo:add'</span>, data.todoContent);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*åé¢ä¸å˜*/</span></span><br></pre></td></tr></table></figure><br>ç°åœ¨æ—¢ç„¶è°ƒç”¨<code>add()</code>æ—¶ä¼ å…¥çš„<code>success</code>å±æ€§å·²ç»å®Œå…¨ä¸æ¶‰åŠåˆ°<code>DOM</code>æ“ä½œäº†ï¼Œè€Œæ˜¯å•çº¯çš„äº‹ä»¶è§¦å‘ï¼Œé‚£å®Œå…¨å¯ä»¥æŠŠè¿™ä¸ªè¡Œä¸ºæ”¾ç½®åˆ°<code>TodoList</code>åŸå‹çš„<code>add()</code>æ–¹æ³•ä¸­å»äº†ï¼Œè¿™æ ·é‡ç”¨æ€§æ›´é«˜ã€‚  </p>
<a id="more"></a>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* â€¦ */</span></span><br><span class="line">TodoList.prototype.add = <span class="function"><span class="keyword">function</span><span class="params">(todoContent)</span></span>&#123;</span><br><span class="line">  $.ajax(&#123;</span><br><span class="line">    url: <span class="string">'/add'</span>,</span><br><span class="line">    type: <span class="string">'POST'</span>,</span><br><span class="line">    dataType: <span class="string">'json'</span>,</span><br><span class="line">    data: &#123; todoContent: todoContent &#125;,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span><span class="params">(data)</span></span>&#123;</span><br><span class="line">      events.trigger(<span class="string">'todo:add'</span>, data.todoContent);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/* â€¦ */</span></span><br><span class="line">NewTodoView.prototype.addTodo = <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.todoList.add($(<span class="string">'#new-todo'</span>).find(<span class="string">'textarea'</span>).val());</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/* â€¦ */</span></span><br></pre></td></tr></table></figure>  
<p>æ¥ä¸‹æ¥ï¼Œå’±çœ‹çœ‹åœ¨<code>NewTodoView</code>è¿™ä¸ªè§†å›¾ä¸­äº‹ä»¶è®¢é˜…æ‰€è§¦å‘çš„å¯¹åº”æ–¹æ³•<code>appendTodo()</code>å’Œ<code>clearTextArea()</code>ä¸­ï¼Œæ¶‰åŠåˆ°çš„æ˜¯å¤„åœ¨åŒä¸€çº§åˆ«çš„ä¸åŒçš„<code>DOM</code>å…ƒç´ èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨<code>NewTodoView</code>è¿™ä¸ªè§†å›¾ä¸­ï¼Œæˆ‘ä»¬å¤„ç†äº†ä¸¤ä¸ª<code>DOM</code>å…ƒç´ ï¼Œè¿™ä¼¼ä¹å’Œæˆ‘ä»¬ä¹‹å‰æåˆ°çš„â€œå•ä¸€èŒè´£åŸåˆ™â€ç›¸è¿èƒŒäº†ï¼Œæ‰€ä»¥è¿˜æœ‰å¾…è¿›ä¸€æ­¥çš„æ”¹è¿›ã€‚  </p>
<p>æˆ‘ä»¬åˆ†åˆ«æŠŠæ–°å¢<code>Todo</code>çš„è§†å›¾å’Œè´Ÿè´£å±•ç¤º<code>Todo Item</code>çš„è§†å›¾åˆ†å¼€å®šä¹‰ï¼Œä½¿å…¶ç¬¦åˆâ€œå•ä¸€èŒè´£åŸåˆ™â€ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å‰é¢ä¸å˜ */</span></span><br><span class="line"><span class="keyword">var</span> NewTodoView = <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.todoList = options.todoList;</span><br><span class="line"></span><br><span class="line">  events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.clearTextArea, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">  $(<span class="string">'#new-todo form'</span>).submit($.proxy(<span class="keyword">this</span>.addTodo, <span class="keyword">this</span>));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">NewTodoView.prototype.addTodo = <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.todoList.add($(<span class="string">'#new-todo'</span>).find(<span class="string">'textarea'</span>).val());</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">NewTodoView.prototype.clearTextArea = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  $(<span class="string">'#new-todo'</span>).find(<span class="string">'textarea'</span>).val(<span class="string">''</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç”¨äºå±•ç¤ºTodo Item */</span></span><br><span class="line"><span class="keyword">var</span> TodoView = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.appendTodo, <span class="keyword">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">TodoView.prototype.appendTodo = <span class="function"><span class="keyword">function</span><span class="params">(todoContent)</span></span>&#123;</span><br><span class="line">  $(<span class="string">'#todo-list ul'</span>).append(<span class="string">'&lt;li&gt;'</span> + todoContent + <span class="string">'&lt;/li&gt;'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åº”ç”¨ç¨‹åºå¯åŠ¨ */</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> todoList = <span class="keyword">new</span> TodoList();</span><br><span class="line">  <span class="keyword">new</span> NewTodoView(&#123; todoList: todoList &#125;);</span><br><span class="line">  <span class="keyword">new</span> TodoView();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>ç°åœ¨æ¯ä¸ª<code>View</code>é‡Œé¢åªä¾èµ–ä¸€ä¸ªé¡¶å±‚çš„<code>HTML Element</code>äº†ï¼Œè€Œåœ¨å„è‡ªçš„<code>View</code>é‡Œé¢å¤šæ¬¡ä½¿ç”¨åˆ°äº†<code>$(&#39;#new-todo&#39;)</code>è¿™æ ·çš„ä»£ç ï¼Œæ‰€ä»¥å¹²è„†å°†å…¶åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä½œä¸º<code>View</code>çš„ä¸€ä¸ªå±æ€§æ¥æä¾›å§ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å‰é¢ä¾æ—§ä¸å˜ */</span></span><br><span class="line"><span class="keyword">var</span> NewTodoView = <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.todoList = options.todoList;</span><br><span class="line">  <span class="keyword">this</span>.el = $(<span class="string">'#new-todo'</span>);  <span class="comment">//å®šä¹‰ä¸€ä¸ªelå±æ€§ÃŸ</span></span><br><span class="line"></span><br><span class="line">  events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.clearTextArea, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.el.find(<span class="string">'form'</span>).submit($.proxy(<span class="keyword">this</span>.addTodo, <span class="keyword">this</span>));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">NewTodoView.prototype.addTodo = <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.todoList.add(<span class="keyword">this</span>.el.find(<span class="string">'textarea'</span>).val());</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">NewTodoView.prototype.clearTextArea = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.el.find(<span class="string">'textarea'</span>).val(<span class="string">''</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TodoView = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.el = $(<span class="string">'#todo-list'</span>);</span><br><span class="line">  events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.appendTodo, <span class="keyword">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">TodoView.prototype.appendTodo = <span class="function"><span class="keyword">function</span><span class="params">(todoContent)</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.el.find(<span class="string">'ul'</span>).append(<span class="string">'&lt;li&gt;'</span> + todoContent + <span class="string">'&lt;/li&gt;'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/* åé¢ä¸å˜ */</span></span><br></pre></td></tr></table></figure><br>æ­¤æ—¶è§‚å¯Ÿå‘ç°ï¼Œä¸¤ä¸ª<code>View</code>å½“ä¸­è¿˜ä¿ç•™ç€å¯¹<code>DOM</code>èŠ‚ç‚¹çš„ä¾èµ–ï¼Œå…¶é‡ç”¨åº¦ä¾ç„¶ä¸é«˜ï¼Œäºæ˜¯å¯é‡‡ç”¨å®ä¾‹åŒ–<code>View</code>çš„æ—¶å€™ä¼ å…¥<code>el</code>å‚æ•°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å‰é¢ä¸å˜ */</span></span><br><span class="line"><span class="keyword">var</span> NewTodoView = <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.todoList = options.todoList;</span><br><span class="line">  <span class="keyword">this</span>.el = options.el;</span><br><span class="line"></span><br><span class="line">  events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.clearTextArea, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.el.find(<span class="string">'form'</span>).submit($.proxy(<span class="keyword">this</span>.addTodo, <span class="keyword">this</span>));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/* NewTodoViewçš„åŸå‹æ–¹æ³•ä¹Ÿä¸å˜ */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TodoView = <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.el = options.el;</span><br><span class="line">  events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.appendTodo, <span class="keyword">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/* TodoViewçš„åŸå‹æ–¹æ³•ä¹Ÿä¸å˜ */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆå§‹åŒ–Viewçš„æ—¶å€™ä¼ å…¥el */</span>	</span><br><span class="line">$(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> todoList = <span class="keyword">new</span> TodoList();</span><br><span class="line">  <span class="keyword">new</span> NewTodoView(&#123; el: $(<span class="string">'#new-todo'</span>), todoList: todoList &#125;);</span><br><span class="line">  <span class="keyword">new</span> TodoView(&#123; el: $(<span class="string">'#todo-list'</span>) &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br><code>View</code>ä¸­æˆ‘ä»¬é¢‘ç¹ä½¿ç”¨åˆ°äº†<code>jQuery</code>çš„<code>find()</code>æ–¹æ³•æ¥æŸ¥æ‰¾<code>View</code>æ‰€åœ¨<code>el</code>ä¸‹é¢çš„å­å…ƒç´ ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘å°†è¿™ä½œä¸º<code>View</code>çš„ç‰¹æ€§æ¥æä¾›ï¼Œäºæ˜¯æˆ‘ä»¬ä¸º<code>View</code>å®šä¹‰è¿™æ ·ä¸€ä¸ªåå«<code>$</code>æ–¹æ³•ï¼Œç„¶åæ›¿æ¢æ‰<code>this.el.find()</code>è¿™æ ·çš„å†™æ³•ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* â€¦ */</span></span><br><span class="line"><span class="keyword">var</span> NewTodoView = <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.todoList = options.todoList;</span><br><span class="line">  <span class="keyword">this</span>.el = options.el;</span><br><span class="line"></span><br><span class="line">  events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.clearTextArea, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.$(<span class="string">'form'</span>).submit($.proxy(<span class="keyword">this</span>.addTodo, <span class="keyword">this</span>));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">NewTodoView.prototype.addTodo = <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.todoList.add(<span class="keyword">this</span>.$(<span class="string">'textarea'</span>).val());</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">NewTodoView.prototype.clearTextArea = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.$(<span class="string">'textarea'</span>).val(<span class="string">''</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">NewTodoView.prototype.$ = <span class="function"><span class="keyword">function</span><span class="params">(selector)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.el.find(selector);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TodoView = <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.el = options.el;</span><br><span class="line">  events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.appendTodo, <span class="keyword">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">TodoView.prototype.appendTodo = <span class="function"><span class="keyword">function</span><span class="params">(todoContent)</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.$(<span class="string">'ul'</span>).append(<span class="string">'&lt;li&gt;'</span> + todoContent + <span class="string">'&lt;/li&gt;'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">TodoView.prototype.$ = <span class="function"><span class="keyword">function</span><span class="params">(selector)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.el.find(selector);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/* â€¦ */</span></span><br></pre></td></tr></table></figure><br>ä¸Šé¢çš„ä»£ç è¶Šæ¥è¶Šå¤šäº†ï¼Œçœ‹ä¸Šå»å¥½åƒå’±æ˜¯å¹²çš„åäº‹ï¼Œè€Œä¸æ˜¯å¾€å¥½çš„æ–¹å‘å‘å±•å•Šã€‚æ˜¯çš„ï¼Œå¦‚æœæ¯ä¸ª<code>View</code>éƒ½æœ‰å¾ˆå¤šè‡ªå·±çš„ç‰¹æ€§ï¼ˆæ–¹æ³•ï¼‰ï¼Œé‚£å‘ä¸Šé¢è¿™æ ·ç€å®å¤ªç—›è‹¦äº†ã€‚çœ‹æ ·å­æ˜¯æ—¶å€™è¯·å‡º<code>Backbone</code>æä¾›çš„<code>View</code>ç‰¹æ€§äº†ã€‚OKï¼ŒæŠŠæˆ‘ä»¬è‡ªå·±çš„<code>View</code>è½¬ç§»åˆ°<code>Backbone</code>çš„ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* â€¦ */</span></span><br><span class="line"><span class="keyword">var</span> NewTodoView = Backbone.View.extend(&#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.todoList = options.todoList;</span><br><span class="line">    <span class="keyword">this</span>.el = options.el;</span><br><span class="line"></span><br><span class="line">    events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.clearTextArea, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'form'</span>).submit($.proxy(<span class="keyword">this</span>.addTodo, <span class="keyword">this</span>));</span><br><span class="line">  &#125;,</span><br><span class="line">  addTodo: <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.todoList.add(<span class="keyword">this</span>.$(<span class="string">'textarea'</span>).val());</span><br><span class="line">  &#125;,</span><br><span class="line">  clearTextArea: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'textarea'</span>).val(<span class="string">''</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  $: <span class="function"><span class="keyword">function</span><span class="params">(selector)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.el.find(selector);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TodoView = Backbone.View.extend(&#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.el = options.el;</span><br><span class="line">    events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.appendTodo, <span class="keyword">this</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  appendTodo: <span class="function"><span class="keyword">function</span><span class="params">(todoContent)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'ul'</span>).append(<span class="string">'&lt;li&gt;'</span> + todoContent + <span class="string">'&lt;/li&gt;'</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  $: <span class="function"><span class="keyword">function</span><span class="params">(selector)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.el.find(selector);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/* â€¦ */</span></span><br></pre></td></tr></table></figure><br>ç”±äº<code>Backbone</code>çš„<code>View</code>å·²ç»æä¾›äº†æˆ‘ä»¬å®ç°çš„<code>$()</code>æ–¹æ³•çš„èƒ½åŠ›ï¼Œä¹Ÿå«<code>$</code>ï¼ˆè¿™ä¹Ÿæ˜¯ä¹‹å‰æˆ‘ä»¬è‡ªå·±å‘½åçš„åŸå› ï¼‰ï¼›åŒæ—¶<code>Backbone</code>çš„<code>View</code>ä¹Ÿæä¾›äº†<code>this.el</code>çš„èƒ½åŠ›ï¼Œæ‰€ä»¥å¯ä»¥æŠŠå®ƒä»¬ä»ä»£ç ä¸­æ˜¾ç¤ºçš„ç§»é™¤äº†ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* â€¦ */</span></span><br><span class="line"><span class="keyword">var</span> NewTodoView = Backbone.View.extend(&#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.todoList = options.todoList;</span><br><span class="line"></span><br><span class="line">    events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.clearTextArea, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'form'</span>).submit($.proxy(<span class="keyword">this</span>.addTodo, <span class="keyword">this</span>));</span><br><span class="line">  &#125;,</span><br><span class="line">  addTodo: <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.todoList.add(<span class="keyword">this</span>.$(<span class="string">'textarea'</span>).val());</span><br><span class="line">  &#125;,</span><br><span class="line">  clearTextArea: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'textarea'</span>).val(<span class="string">''</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TodoView = Backbone.View.extend(&#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">    events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.appendTodo, <span class="keyword">this</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  appendTodo: <span class="function"><span class="keyword">function</span><span class="params">(todoContent)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'ul'</span>).append(<span class="string">'&lt;li&gt;'</span> + todoContent + <span class="string">'&lt;/li&gt;'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/* å¯åŠ¨ä»£ç ä¾ç„¶ä¸å˜ */</span></span><br></pre></td></tr></table></figure><br>ç°åœ¨å¯ä»¥å›è¿‡å¤´æ¥çœ‹çœ‹<code>ajax</code>é‚£éƒ¨åˆ†äº†ï¼Œç”±äº<code>Backbone</code>æä¾›äº†<code>Model</code>çš„èƒ½åŠ›ï¼Œè¿™ä¸ªå°±æ˜¯ç”¨äºå’ŒæœåŠ¡ç«¯æ‰“äº¤é“çš„ï¼Œæ‰€ä»¥å°†é•¿é•¿çš„<code>ajax</code>ä»£ç æ”¹å†™ä¸ºè¿™ä¸€æ–¹å¼ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* â€¦ */</span></span><br><span class="line"><span class="keyword">var</span> Todo = Backbone.Model.extend(&#123;</span><br><span class="line">  url: <span class="string">'/add'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TodoList = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">TodoList.prototype.add = <span class="function"><span class="keyword">function</span><span class="params">(todoContent)</span></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> todo = <span class="keyword">new</span> Todo();</span><br><span class="line">  todo.save(&#123; todoContent: todoContent &#125;,&#123;</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span><span class="params">(model, data)</span></span>&#123;</span><br><span class="line">      events.trigger(<span class="string">'todo:add'</span>, data.todoContent);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/* â€¦ */</span></span><br></pre></td></tr></table></figure><br>åŒæ—¶ï¼Œ<code>Backbone</code>ä¸­è¿˜æä¾›äº†ä¸€ä¸ª<code>Collection</code>çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯<code>Model</code>çš„é›†åˆï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæ¯æ¬¡åˆ›å»ºå•æ¡çš„<code>Todo</code>ï¼Œç„¶åå½¢æˆ<code>Todo List</code>ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬çš„ä»»ä½•æ•°æ®éƒ½åº”è¯¥æ˜¯ä»¥å¤šæ¡è®°å½•çš„æ–¹å¼å­˜åœ¨çš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åŒæ—¶å°†ä¸Šé¢çš„<code>TodoList</code>çš„å®ç°æ”¹ä¸º<code>Collection</code>ã€‚  </p>
<p>è€Œä¸”ï¼Œ<code>Backbone</code>çš„<code>Collection</code>å·²ç»æ”¯æŒäº†<code>Event</code>æœºåˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿæ— éœ€è‡ªå®šä¹‰<code>events</code>äº†ï¼Œäºæ˜¯å¼€å¤´çš„<code>events</code>å˜é‡ä¹Ÿä¸€å¹¶ç§»é™¤äº†ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Todo = Backbone.Model.extend(&#123;</span><br><span class="line">  url: <span class="string">'/add'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TodoList = Backbone.Collection.extend(&#123;</span><br><span class="line">  add: <span class="function"><span class="keyword">function</span><span class="params">(todoContent)</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> todo = <span class="keyword">new</span> Todo(),</span><br><span class="line">        that = <span class="keyword">this</span>;</span><br><span class="line">    todo.save(&#123; todoContent: todoContent &#125;,&#123;</span><br><span class="line">      success: <span class="function"><span class="keyword">function</span><span class="params">(model, data)</span></span>&#123;</span><br><span class="line">        that.trigger(<span class="string">'add'</span>, data.todoContent);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> NewTodoView = Backbone.View.extend(&#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.todoList = options.todoList;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.todoList.on(<span class="string">'add'</span>, <span class="keyword">this</span>.clearTextArea, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'form'</span>).submit($.proxy(<span class="keyword">this</span>.addTodo, <span class="keyword">this</span>));</span><br><span class="line">  &#125;,</span><br><span class="line">  addTodo: <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.todoList.add(<span class="keyword">this</span>.$(<span class="string">'textarea'</span>).val());</span><br><span class="line">  &#125;,</span><br><span class="line">  clearTextArea: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'textarea'</span>).val(<span class="string">''</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TodoView = Backbone.View.extend(&#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.todoList = options.todoList;</span><br><span class="line">    <span class="keyword">this</span>.todoList.on(<span class="string">'add'</span>, <span class="keyword">this</span>.appendTodo, <span class="keyword">this</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  appendTodo: <span class="function"><span class="keyword">function</span><span class="params">(todoContent)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'ul'</span>).append(<span class="string">'&lt;li&gt;'</span> + todoContent + <span class="string">'&lt;/li&gt;'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> todoList = <span class="keyword">new</span> TodoList();</span><br><span class="line">  <span class="keyword">new</span> NewTodoView(&#123; el: $(<span class="string">'#new-todo'</span>), todoList: todoList &#125;);</span><br><span class="line">  <span class="keyword">new</span> TodoView(&#123; el: $(<span class="string">'#todo-list'</span>), todoList: todoList &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br><code>Collection</code>æä¾›äº†ä¸€ä¸ªåå«<code>create()</code>çš„æ–¹æ³•ï¼Œå…¶å¯ä»¥æ ¹æ®<code>Collection</code>çš„<code>Model</code>å±æ€§åˆ›å»ºä¸€ä¸ª<code>Model</code>çš„å®ä¾‹ï¼Œå¹¶æ‰§è¡Œ<code>Model</code>çš„<code>save()</code>æ–¹æ³•ã€‚æ‰€ä»¥æˆ‘ä»¬çš„<code>TodoList</code>ä¸­çš„<code>add()</code>æ–¹æ³•å·²ç»å¯ä»¥åºŸå»äº†ã€‚æˆ‘ä»¬åªéœ€ä¸º<code>TodoList</code>æä¾›<code>Model</code>å±æ€§çš„å€¼å³å¯ï¼Œç„¶ååœ¨<code>NewTodoView</code>çš„<code>addTodo()</code>æ–¹æ³•ä¸­ï¼Œæ›¿æ¢<code>this.todoList.add()</code>æ–¹æ³•ä¸º<code>this.todoList.create()</code>ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* â€¦ */</span></span><br><span class="line"><span class="keyword">var</span> TodoList = Backbone.Collection.extend(&#123;</span><br><span class="line">  model: Todo</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> NewTodoView = Backbone.View.extend(&#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.todoList = options.todoList;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.todoList.on(<span class="string">'add'</span>, <span class="keyword">this</span>.clearTextArea, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'form'</span>).submit($.proxy(<span class="keyword">this</span>.addTodo, <span class="keyword">this</span>));</span><br><span class="line">  &#125;,</span><br><span class="line">  addTodo: <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.todoList.create(&#123; todoContent: <span class="keyword">this</span>.$(<span class="string">'textarea'</span>).val() &#125;);  <span class="comment">//æ›¿æ¢ä¸ºcreateæ–¹æ³•</span></span><br><span class="line">  &#125;,</span><br><span class="line">  clearTextArea: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'textarea'</span>).val(<span class="string">''</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/* â€¦ */</span></span><br></pre></td></tr></table></figure><br>è¿™æ—¶ï¼Œæˆ‘ä»¬çš„<code>Model</code>ã€<code>Collection</code>ã€<code>View</code>éƒ½å·²ç»é½ä¸Šé˜µäº†ã€‚ç”±äº<code>Backbone</code>çš„<code>View</code>å·²ç»å†…ç½®<code>collection</code>å±æ€§ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥è®¾ç½®ã€è·å–<code>View</code>å¯¹åº”çš„<code>Collection</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨æ— éœ€æ‰‹åŠ¨åœ¨<code>View</code>çš„å†…éƒ¨æ¥å®šä¹‰ä¸€ä¸ª<code>todoList</code>çš„å˜é‡äº†ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* â€¦ */</span></span><br><span class="line"><span class="keyword">var</span> NewTodoView = Backbone.View.extend(&#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.collection.on(<span class="string">'add'</span>, <span class="keyword">this</span>.clearTextArea, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'form'</span>).submit($.proxy(<span class="keyword">this</span>.addTodo, <span class="keyword">this</span>));</span><br><span class="line">  &#125;,</span><br><span class="line">  addTodo: <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.collection.create(&#123; todoContent: <span class="keyword">this</span>.$(<span class="string">'textarea'</span>).val() &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  clearTextArea: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'textarea'</span>).val(<span class="string">''</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TodoView = Backbone.View.extend(&#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.collection.on(<span class="string">'add'</span>, <span class="keyword">this</span>.appendTodo, <span class="keyword">this</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  appendTodo: <span class="function"><span class="keyword">function</span><span class="params">(todo)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'ul'</span>).append(<span class="string">'&lt;li&gt;'</span> + todo.get(<span class="string">'todoContent'</span>) + <span class="string">'&lt;/li&gt;'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> todoList = <span class="keyword">new</span> TodoList();</span><br><span class="line">  <span class="keyword">new</span> NewTodoView(&#123; el: $(<span class="string">'#new-todo'</span>), collection: todoList &#125;);</span><br><span class="line">  <span class="keyword">new</span> TodoView(&#123; el: $(<span class="string">'#todo-list'</span>), collection: todoList &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>è‡³æ­¤ï¼Œå®Œæ•´çš„åŸºäº<code>Backbone</code>çš„<code>Model</code>ã€<code>Collection</code>ã€<code>View</code>æ¨¡å¼å°±æ„å»ºå¥½äº†ã€‚å¦‚æœè¯´è¿˜æœ‰ä»€ä¹ˆç‘•ç–µçš„è¯ï¼Œåº”è¯¥å°±æ˜¯ä¸€äº›è¡¨å±‚åŠŸå¤«äº†ï¼Œé‚£å°±æ˜¯å’±ä»¬çš„<code>HTML Element</code>çš„<code>append</code>äº†ï¼Œéœ€è¦åšä¸€äº›è¿‡æ»¤ï¼Œæ¯”å¦‚ç”¨æˆ·è¾“å…¥<code>JavaScript</code>ä»£ç é‚£å°±ç³Ÿç³•äº†ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$(<span class="string">'ul'</span>).append(<span class="string">'&lt;li&gt;'</span> + todo.get(<span class="string">'todoContent'</span>) + <span class="string">'&lt;/li&gt;'</span>);</span><br><span class="line">è°ƒæ•´ä¸º</span><br><span class="line"><span class="keyword">this</span>.$(<span class="string">'ul'</span>).append(<span class="string">'&lt;li&gt;'</span> + todo.escape(<span class="string">'todoContent'</span>) + <span class="string">'&lt;/li&gt;'</span>);</span><br></pre></td></tr></table></figure><br>è¿™æ ·å°±Perfectäº†ã€‚æ–‡ç« å¿’é•¿äº†ç‚¹ï¼Œä½†æ˜¯ä¸ºäº†ä»ä¸€ä¸ª<code>0</code>å˜æˆä¸€ä¸ª<code>1</code>ï¼Œæˆ‘æƒ³åº”è¯¥è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ç»§<a href="http://heroicyang.com/2012/08/08/to-backbone-tutorial-1">ã€ŠBackboneä¹‹æ—…ï¼šå‰ç«¯MVCæ¶æ„åˆä½“éªŒï¼ˆä¸Šï¼‰ã€‹</a>ï¼Œä¸Šç¯‡ä¸­æœ€åçš„ä»£ç å·²ç»å®Œå…¨è¾¾åˆ°æœ€åˆæå‡ºçš„å‡ ç‚¹è¦æ±‚ï¼Œç°åœ¨å°±ç»“åˆ<code>Backbone</code>æä¾›çš„èƒ½åŠ›ï¼Œæ¥ç»§ç»­ç²¾ç®€ä»£ç ã€‚æœ€åçš„ç›®æ ‡å°±æ˜¯å°†ä¸Šç¯‡ä¸­çš„ä»£ç å…¨éƒ¨é‡æ„ä¸º<code>Backbone</code>çš„<code>MVC</code>æ¨¡å¼ã€‚  </p>
<p>ä¸Šç¯‡ä¸­æœ€åä¸€æ¬¡æ”¹é€ å°±å·²ç»ä½¿ç”¨åˆ°äº†<code>callback</code>çš„æ–¹å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬ç´¢æ€§å†åŠ ä¸Š<code>Event</code>æœºåˆ¶å§ï¼Œå› ä¸º<code>Backbone</code>å†…ç½®äº†è¿™ä¸ªèƒ½åŠ›ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> events = _.clone(Backbone.Events);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TodoList = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">TodoList.prototype.add = <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">  $.ajax(&#123;</span><br><span class="line">    url: <span class="string">'/add'</span>,</span><br><span class="line">    type: <span class="string">'POST'</span>,</span><br><span class="line">    dataType: <span class="string">'json'</span>,</span><br><span class="line">    data: &#123; todoContent: options.todoContent &#125;,</span><br><span class="line">    success: options.success</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> NewTodoView = <span class="function"><span class="keyword">function</span><span class="params">(options)</span></span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.todoList = options.todoList;</span><br><span class="line"></span><br><span class="line">  events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.appendTodo, <span class="keyword">this</span>);</span><br><span class="line">  events.on(<span class="string">'todo:add'</span>, <span class="keyword">this</span>.clearTextArea, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">  $(<span class="string">'#new-todo form'</span>).submit($.proxy(<span class="keyword">this</span>.addTodo, <span class="keyword">this</span>));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">NewTodoView.prototype.addTodo = <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.todoList.add(&#123;</span><br><span class="line">    todoContent: $(<span class="string">'#new-todo'</span>).find(<span class="string">'textarea'</span>).val(),</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span><span class="params">(data)</span></span>&#123;</span><br><span class="line">      events.trigger(<span class="string">'todo:add'</span>, data.todoContent);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*åé¢ä¸å˜*/</span></span><br></pre></td></tr></table></figure><br>ç°åœ¨æ—¢ç„¶è°ƒç”¨<code>add()</code>æ—¶ä¼ å…¥çš„<code>success</code>å±æ€§å·²ç»å®Œå…¨ä¸æ¶‰åŠåˆ°<code>DOM</code>æ“ä½œäº†ï¼Œè€Œæ˜¯å•çº¯çš„äº‹ä»¶è§¦å‘ï¼Œé‚£å®Œå…¨å¯ä»¥æŠŠè¿™ä¸ªè¡Œä¸ºæ”¾ç½®åˆ°<code>TodoList</code>åŸå‹çš„<code>add()</code>æ–¹æ³•ä¸­å»äº†ï¼Œè¿™æ ·é‡ç”¨æ€§æ›´é«˜ã€‚  </p>]]>
    
    </summary>
    
      <category term="backbone" scheme="http://heroicyang.com/tags/backbone/"/>
    
      <category term="javascript" scheme="http://heroicyang.com/tags/javascript/"/>
    
      <category term="mvc" scheme="http://heroicyang.com/tags/mvc/"/>
    
  </entry>
  
</feed>